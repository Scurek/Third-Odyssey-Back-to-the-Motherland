namespace = nhs2_mainlandevents

# 1-25, 30

# # Removes the overseas penalty from Constantinople
# province_event = {
# 	id = nhs2_mainlandevents.1
# 	title = nhs2_mainlandevents.1.t
# 	desc = nhs2_mainlandevents.1.d
# 	picture = CITY_VIEW_eventPicture

#     trigger = {
# 		province_id = 151
# 		is_territory = yes
# 		NOT = { is_state = yes }
# 		owner = {
# 			nhs_condition_all_ely = { KOMANDA = tag }
# 			NOT = {
# 				OR = {
# 					capital_scope = {
# 						continent = europe
# 					}
# 					capital_scope = {
# 						continent = asia
# 					}
# 					capital_scope = {
# 						continent = africa
# 					}
# 				}
# 			}
# 		}
# 		NOT = { has_province_modifier = newnhs_no_overseas }
# 	}

# 	mean_time_to_happen = {
# 		days = 1
# 	}

# 	option = {
# 		name = "nhs2_mainlandevents.1.a"
# 		add_permanent_province_modifier = {
# 			name = "newnhs_no_overseas"
# 			duration = -1
# 		}
# 	}
# }

# # Removes the removal of overseas penalty from Constantinople
# province_event = {
# 	id = nhs2_mainlandevents.2
# 	title = nhs2_mainlandevents.2.t
# 	desc = nhs2_mainlandevents.2.d
# 	picture = CITY_VIEW_eventPicture
	
# 	hidden = yes

#     trigger = {
# 		has_province_modifier = newnhs_no_overseas
# 		OR = {
# 			owner = {
# 				OR = {
# 					NOT = { nhs_condition_all_ely = { KOMANDA = tag } }
# 					OR = {
# 						capital_scope = {
# 							continent = europe
# 						}
# 						capital_scope = {
# 							continent = asia
# 						}
# 						capital_scope = {
# 							continent = africa
# 						}
# 					}
# 				}
# 			}
# 			is_state = yes
# 		}
# 	}

# 	mean_time_to_happen = {
# 		days = 1
# 	}
	
# 	immediate = {
# 		remove_province_modifier = newnhs_no_overseas
# 	}

# 	option = {
# 		name = "nhs2_mainlandevents.2.a"
# 	}
# }

# Great Sailor

country_event = {
	id = nhs2_mainlandevents.3
	title = nhs2_mainlandevents.3.t
	desc = nhs2_mainlandevents.3.d
	picture = ELYSHIP_eventPicture

	fire_only_once = yes
	
	trigger = {
		nhs_condition_all_ely = { KOMANDA = tag }
		is_year = 1511
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = "nhs2_mainlandevents.3.a"
		set_country_flag = nhs_the_explorer_went
	}
}

# Great Sailor returns
country_event = {
	id = nhs2_mainlandevents.4
	title = nhs2_mainlandevents.4.t
	desc = nhs2_mainlandevents.4.d
	picture = ELYSHIP_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		nhs_condition_all_ely = { KOMANDA = tag }
		is_year = 1521
		OR = {
			had_country_flag = { flag = nhs_the_explorer_went days = 3650 }
			is_year = 1525
		}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		hidden_effect = {
			reverse_add_opinion = {
				who = TUR
				modifier = insulted
			}
			europe = {
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
			european_seas_lakes = {
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
			every_province = {
				limit = {
					region = maghreb_region
					NOT = { area = tafilalt_area }
					NOT = { area = north_saharan_area }
					NOT = { area = fezzan_area }
				}
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
			every_province = {
				limit = {
					region = egypt_region
					NOT = { area = lower_nubia_area }
				}
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
			palestine_area = {
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
			syria_area = {
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
			rakka_area = {
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
			discover_province = 1572
			discover_province = 1570
			discover_province = 1582
			discover_province = 1580
			discover_province = 1568
			discover_province = 1567
			discover_province = 1583
			discover_province = 1575
			discover_province = 1564
			discover_province = 1579
			discover_province = 1563
			discover_province = 1566
			discover_province = 1573
			discover_province = 1569
			discover_province = 1565
			discover_province = 1578
			discover_province = 1500
			set_global_flag = nhs_europe_discovered
			set_country_flag = nhs_europe_discovered_got
			set_country_flag = nhs_cant_think_of_a_name
		}
	}
	
	option = {
		name = "nhs2_mainlandevents.4.a"
		add_prestige = 10
		define_explorer = {
			name = "Pytheas"
			fire = 2
			shock = 2
			manuever = 6
		}
		1499 = { change_province_name = "Pythean Bay" }
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = nhs_unlock_invasion_decision_tt
		custom_tooltip = nhs_looking_east_decision_tt
	}
	
	option = {
		name = "nhs2_mainlandevents.4.b"
		add_legitimacy = 5
		define_advisor = {
			type = navigator
			name = "Pytheas"
			skill = 3
			cost_multiplier = 0.5
		}
		1499 = { change_province_name = "Pythean Bay" }
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = nhs_unlock_invasion_decision_tt
		custom_tooltip = nhs_looking_east_decision_tt
	}
	
	after = {
		every_country = {
			limit = {
				capital_scope = {
					OR = {
						continent = europe
						AND = {
							region = maghreb_region
							NOT = { area = tafilalt_area }
							NOT = { area = north_saharan_area }
							NOT = { area = fezzan_area }
						}
						AND = {
							region = egypt_region
							NOT = { area = lower_nubia_area }
						}
						area = palestine_area
						area = syria_area
						area = rakka_area
					}
				}
				NOT = { culture_group = byzantine }
				NOT = { tag = TUR }
			}
			country_event = { id = nhs2_mainlandevents.28 }
		}
		every_country = {
			limit = {
				culture_group = byzantine
				capital_scope = {
					OR = {
						continent = europe
						AND = {
							region = maghreb_region
							NOT = { area = tafilalt_area }
							NOT = { area = north_saharan_area }
							NOT = { area = fezzan_area }
						}
						AND = {
							region = egypt_region
							NOT = { area = lower_nubia_area }
						}
						area = palestine_area
						area = syria_area
						area = rakka_area
					}
				}
			}
			country_event = { id = nhs2_mainlandevents.29 }
		}
		TUR = {
			country_event = { id = nhs2_mainlandevents.31 }
		}
	}
}

#Great explorer for everybody else

country_event = {
	id = nhs2_mainlandevents.5
	title = nhs2_mainlandevents.5.t
	desc = nhs2_mainlandevents.5.d
	picture = ELYSHIP_eventPicture
	
	trigger = {
		had_global_flag = { flag = nhs_europe_discovered days = 30 }
		NOT = { has_country_flag = nhs_europe_discovered_got }
		NOT = { has_country_flag = nhs_cant_think_of_a_name }
		OR = {
			technology_group = modern_greek
			technology_group = modern_spartan
			technology_group = exiled_spartan
			technology_group = exiled_greek
			# technology_group = hellenised_american
			technology_group = viking
			technology_group = modern_vinlandic
		}
	}
	
	mean_time_to_happen = {
		months = 6
	}
	
	option = {
		name = "nhs2_mainlandevents.5.a"
		custom_tooltip = nhs_looking_east_decision_tt

		hidden_effect = {
			set_country_flag = nhs_europe_discovered_got
			europe = {
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
			european_seas_lakes = {
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
			every_province = {
				limit = {
					region = maghreb_region
					NOT = { area = tafilalt_area }
					NOT = { area = north_saharan_area }
					NOT = { area = fezzan_area }
				}
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
			every_province = {
				limit = {
					region = egypt_region
					NOT = { area = lower_nubia_area }
				}
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
			palestine_area = {
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
			syria_area = {
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
			rakka_area = {
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
			discover_province = 1572
			discover_province = 1570
			discover_province = 1582
			discover_province = 1580
			discover_province = 1568
			discover_province = 1567
			discover_province = 1583
			discover_province = 1575
			discover_province = 1564
			discover_province = 1579
			discover_province = 1563
			discover_province = 1566
			discover_province = 1573
			discover_province = 1569
			discover_province = 1565
			discover_province = 1578
			discover_province = 1500
		}
	}
}

#European reaction to Elysians
country_event = {
	id = nhs2_mainlandevents.28
	title = nhs2_mainlandevents.28.t
	desc = nhs2_mainlandevents.28.d
	picture = BYZANTINE_EAGLE_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "nhs2_mainlandevents.28.a"
	}
}

#Greek reaction to Elysians
country_event = {
	id = nhs2_mainlandevents.29
	title = nhs2_mainlandevents.29.t
	desc = nhs2_mainlandevents.29.d
	picture = BYZANTINE_EAGLE_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "nhs2_mainlandevents.29.a"
	}
}

#Turkish reaction to Elysians
country_event = {
	id = nhs2_mainlandevents.31
	title = nhs2_mainlandevents.31.t
	desc = nhs2_mainlandevents.31.d
	picture = BYZANTINE_EAGLE_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "nhs2_mainlandevents.31.a"
	}
}

# First Event

country_event = {
	id = nhs2_mainlandevents.6
	title = nhs2_mainlandevents.6.t
	desc = nhs2_mainlandevents.6.d
	picture = GOOD_WITH_MONARCH_eventPicture
	
	is_triggered_only = yes

	option = { # Supply lines
		name = "nhs2_mainlandevents.6.a"
		# trigger = {
		# 	NOT = {
		# 		any_owned_province = {
		# 			nhs_supply_lines_province = yes
		# 		}
		# 	}
		# }
		country_event = { id = nhs2_mainlandevents.7 }
	}
	
	# option = {
	# 	trigger = {
	# 		any_owned_province = {
	# 			nhs_supply_lines_province = yes
	# 		}
	# 	}
	# 	name = "nhs2_mainlandevents.6.b"
	# 	country_event = { id = nhs2_mainlandevents.9 }
	# 	set_country_flag = nhs_invasion_second_part_begins
	# 	set_country_flag = nhs_invasion_second_part
	# }
	
	option = { # Back
		name = "nhs2_mainlandevents.6.c"
		ai_chance = { factor = 0 }
		clr_country_flag = nhs_invasion_begins
		add_mil_power = 50
	}
}

# Supply lines

country_event = {
	id = nhs2_mainlandevents.7
	title = nhs2_mainlandevents.7.t
	desc = nhs2_mainlandevents.7.d
	picture = HARBOUR_eventPicture
	
	is_triggered_only = yes
	
	# trigger = {
	# 	NOT = {
	# 		any_owned_province = {
	# 			nhs_supply_lines_province = yes
	# 		}
	# 	}
	# }
	
	immediate = {
		set_country_flag = nhs_supply_lines
		hidden_effect = {
			# every_province = {
			# 	limit = {
			# 		area = cap_verde_area
			# 		has_port = yes
			# 	}
			# 	every_country = {
			# 		limit = { tag = ROOT }
			# 		discover_province = PREV
			# 	}
			# }
			# discover_province = 1472
			# discover_province = 1471
			# discover_province = 1470
			# discover_province = 1469
			# discover_province = 1468
			# discover_province = 1467
			# discover_province = 367
			# discover_province = 368
			# discover_province = 366
			# discover_province = 1096
			# discover_province = 1114
			# discover_province = 1111
			every_province = {
				limit = {
					nhs_supply_lines_province = yes
				}
				every_country = {
					limit = { tag = ROOT }
					discover_province = PREV
				}
			}
		}
	}
	
	option = {           # Western Isles
		name = "nhs2_mainlandevents.7.a"
		ai_chance = { factor = 1 }
		set_country_flag = nhs_supply_lines_western_isles
		if = {
			limit = {
				any_owned_province = {
					nhs_supply_lines_western_isles_province = yes
				}
			}
			custom_tooltip = nhs_supply_lines_already_owned_province_tt
			country_event = { id = nhs2_mainlandevents.8 }
		}
		else = {
			every_province = {
				limit = {
					nhs_supply_lines_western_isles_province = yes
				}
				add_permanent_claim = ROOT
			}
			custom_tooltip = nhs_new_line_tt
			custom_tooltip = nhs_invasion_range_modifier_tt
			custom_tooltip = nhs_new_line_tt
			custom_tooltip = nhs_enable_change_supply_lines_tt
		}
	}
	
	option = {           # Eastern Isles
		name = "nhs2_mainlandevents.7.b"
		ai_chance = { factor = 0 }
		set_country_flag = nhs_supply_lines_eastern_isles
		if = {
			limit = {
				any_owned_province = {
					nhs_supply_lines_eastern_isles_province = yes
				}
			}
			custom_tooltip = nhs_supply_lines_already_owned_province_tt
			country_event = { id = nhs2_mainlandevents.8 }
		}
		else = {
			every_province = {
				limit = {
					nhs_supply_lines_eastern_isles_province = yes
				}
				add_permanent_claim = ROOT
			}
			custom_tooltip = nhs_new_line_tt
			custom_tooltip = nhs_invasion_range_modifier_tt
			custom_tooltip = nhs_new_line_tt
			custom_tooltip = nhs_enable_change_supply_lines_tt
		}
	}

	option = {           # Gibraltar
		name = "nhs2_mainlandevents.7.f"
		ai_chance = { factor = 1 }
		set_country_flag = nhs_supply_lines_gibraltar
		
		if = {
			limit = {
				any_owned_province = {
					nhs_supply_lines_gibraltar_province = yes
				}
			}
			custom_tooltip = nhs_supply_lines_already_owned_province_tt
			country_event = { id = nhs2_mainlandevents.8 }
		}
		else = {
			every_province = {
				limit = {
					nhs_supply_lines_gibraltar_province = yes
				}
				add_permanent_claim = ROOT
			}
			custom_tooltip = nhs_new_line_tt
			custom_tooltip = nhs_invasion_range_modifier_tt
			custom_tooltip = nhs_new_line_tt
			custom_tooltip = nhs_enable_change_supply_lines_tt
		}
	}

	option = {           # Atlantic Port
		name = "nhs2_mainlandevents.7.g"
		ai_chance = { factor = 1 }
		set_country_flag = nhs_supply_lines_atlantic_port
		
		if = {
			limit = {
				any_owned_province = {
					nhs_supply_lines_atlantic_port_province = yes
				}
			}
			custom_tooltip = nhs_supply_lines_already_owned_province_tt
			country_event = { id = nhs2_mainlandevents.8 }
		}
		else = {
			every_province = {
				limit = {
					nhs_supply_lines_atlantic_port_province = yes
				}
				add_permanent_claim = ROOT
			}
			custom_tooltip = nhs_new_line_tt
			custom_tooltip = nhs_invasion_range_modifier_tt
			custom_tooltip = nhs_new_line_tt
			custom_tooltip = nhs_enable_change_supply_lines_tt
		}
	}
	
	# option = {           # North-Westren Africa
	# 	name = "nhs2_mainlandevents.7.c"
	# 	ai_chance = { factor = 3 }
	# 	set_country_flag = nhs_supply_lines_north_africa
	# 	every_province = {
	# 		limit = {
	# 			region = maghreb_region
	# 			has_port = yes
	# 		}
	# 		add_permanent_claim = ROOT
	# 	}
	# }
	
	# option = {           # West Africa and Isles
	# 	name = "nhs2_mainlandevents.7.e"
	# 	ai_chance = { factor = 2 }
	# 	set_country_flag = nhs_supply_lines_west_africa
	# 	if = {
	# 		limit = {
	# 			OR = {
	# 				1096 = {
	# 					is_empty = yes
	# 				}
	# 				1111 = {
	# 					is_empty = yes
	# 				}
	# 			}
	# 		}
	# 		custom_tooltip = nhs_supply_linest4
	# 	}
	# 	add_permanent_claim = 367
	# 	add_permanent_claim = 368
	# 	add_permanent_claim = 366
	# 	add_permanent_claim = 1096
	# 	add_permanent_claim = 1114
	# 	every_province = {
	# 		limit = {
	# 			area = cap_verde_area
	# 			has_port = yes
	# 		}
	# 		add_permanent_claim = ROOT
	# 	}
	# }
	
	option = {             # Back
		name = "nhs2_mainlandevents.7.h"
		ai_chance = { factor = 0 }
		hidden_effect = {
			country_event = { id = nhs2_mainlandevents.6 days = 1 }
		}
	}
}


# Supply lines secured

country_event = {
	id = nhs2_mainlandevents.8
	title = nhs2_mainlandevents.8.t
	desc = nhs2_mainlandevents.8.d
	picture = VICTORY_eventPicture

	fire_only_once = yes
	
	trigger = {
		nhs_condition_all_ely = { KOMANDA = tag }
		has_country_flag = nhs_supply_lines
		NOT = { has_country_flag = nhs_supply_lines_secured }
		NOT = { has_country_flag = nhs_invasion_over }
		# NOT = {
		# 	any_province = {
		# 		has_province_modifier = nhs2_supply_lines_tm
		# 	}
		# }
		any_owned_province = {
			#nhs_supply_lines_province = yes
			nhs_is_target_supply_lines_province = { FLAG_SCOPE = ROOT }
		}
	}
	
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					# nhs_supply_lines_province = yes
					nhs_is_target_supply_lines_province = { FLAG_SCOPE = ROOT }
					nhs_supply_lines_mediterranean_port_province = yes
					province_has_center_of_trade_of_level = 1
				}
				save_event_target_as = supply_lines_target
			}
			if = {
				limit = {
					NOT = { has_saved_event_target = supply_lines_target }
				}
				random_owned_province = {
					limit = {
						# nhs_supply_lines_province = yes
						nhs_is_target_supply_lines_province = { FLAG_SCOPE = ROOT }
						nhs_supply_lines_mediterranean_port_province = yes
					}
					save_event_target_as = supply_lines_target
				}
			}
			if = {
				limit = {
					NOT = { has_saved_event_target = supply_lines_target }
				}
				random_owned_province = {
					limit = {
						# nhs_supply_lines_province = yes
						nhs_is_target_supply_lines_province = { FLAG_SCOPE = ROOT }
					}
					save_event_target_as = supply_lines_target
				}
			}
		}
		clr_country_flag = nhs_supply_lines
		clr_country_flag = nhs_supply_lines_western_isles
		clr_country_flag = nhs_supply_lines_eastern_isles
		clr_country_flag = nhs_supply_lines_gibraltar
		clr_country_flag = nhs_supply_lines_atlantic_port
		set_country_flag = nhs_supply_lines_secured
	}
	
	option = {
		name = "nhs2_mainlandevents.8.a"
		goto = supply_lines_target
		event_target:supply_lines_target = {
			add_core = ROOT
		}
		event_target:supply_lines_target = {
			tooltip = {
				add_province_modifier = {
					name = nhs2_supply_lines
					duration = -1
					desc = "END_OF_INVASION"
				}
			}
			hidden_effect = {
				add_province_triggered_modifier = nhs2_supply_lines_tm
				save_global_event_target_as = nhs_supply_lines_province
			}
		}
		custom_tooltip = nhs_invasion_supply_lines_modifiers_tt
		if = {
			limit = {
				NOT = { has_country_flag = nhs_invasion_second_part }
				NOT = { has_country_flag = nhs_invasion_second_part_begins }
			}
			custom_tooltip = nhs_new_line_tt
			country_event = { id = nhs2_mainlandevents.9 }
		}
		set_country_flag = nhs_invasion_second_part_begins
		set_country_flag = nhs_invasion_second_part		
	}
}

# Actual Invasion establishing a base of operations

country_event = {
	id = nhs2_mainlandevents.9
	title = nhs2_mainlandevents.9.t
	desc = nhs2_mainlandevents.9.d
	picture = ATHENS_eventPicture
	
	is_triggered_only = yes
	
	# immediate = {
	# 	set_country_flag = nhs_bo
	# }
	
	option = {
		name = "nhs2_mainlandevents.9.a"
		goto = 146
		set_country_flag = nhs_bo_athens
		nhs_set_base_of_operations_target = { 
			PROVINCE_ID = 146
			MODIFIER = nhs2_bo_athens
		}
	}
	
	option = { 
		name = "nhs2_mainlandevents.9.b"
		goto = 148
		set_country_flag = nhs_bo_macedonia
		nhs_set_base_of_operations_target = { 
			PROVINCE_ID = 148
			MODIFIER = nhs2_bo_macedonia
		}
	}
	
	option = { 
		name = "nhs2_mainlandevents.9.c"
		goto = 145
		set_country_flag = nhs_bo_sparta
		nhs_set_base_of_operations_target = { 
			PROVINCE_ID = 145
			MODIFIER = nhs2_bo_sparta
		}
	}
	
	option = { 
		name = "nhs2_mainlandevents.9.e"
		goto = 320
		set_country_flag = nhs_bo_rhodes
		nhs_set_base_of_operations_target = { 
			PROVINCE_ID = 320
			MODIFIER = nhs2_bo_rhodes
		}
	}
	option = { 
		name = "nhs2_mainlandevents.9.f"
		trigger = {
			has_country_flag = nhs_supply_lines_secured
		}
		custom_tooltip = enables_invasion_second_part_decision_tt
		clr_country_flag = nhs_invasion_second_part_begins
		clr_country_flag = nhs_bo
	}
	
	# option = { 
	# 	name = "nhs2_mainlandevents.9.m"   # back without supply lines
	# 	trigger = {
	# 		NOT = { has_country_flag = nhs_supply_lines_secured }
	# 	}
	# 	clr_country_flag = nhs_invasion_second_part_begins
	# 	clr_country_flag = nhs_bo
	# 	clr_country_flag = nhs_invasion_begins
	# }
}

# Greeks for base of operations
country_event = {
	id = nhs2_mainlandevents.10
	title = nhs2_mainlandevents.10.t
	desc = nhs2_mainlandevents.10.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes

	trigger = {
		OR = {
			AND = {
				FROM = {
					has_country_flag = nhs_bo_athens
				}
				owns_or_subject_of = 146
			}
			AND = {
				FROM = {
					has_country_flag = nhs_bo_macedonia
				}
				owns_or_subject_of = 148
			}
			AND = {
				FROM = {
					has_country_flag = nhs_bo_sparta
				}
				owns_or_subject_of = 145
			}
			AND = {
				FROM = {
					has_country_flag = nhs_bo_rhodes
				}
				owns_or_subject_of = 320
			}
		}
	}
	
	option = {
		name = "nhs2_mainlandevents.10.a"
		if = {
			limit = {
				FROM = {
					has_country_flag = nhs_bo_athens
				}
				owns_or_subject_of = 146
			}
			146 = {
				tooltip = {
					cede_province = FROM
				}
				save_event_target_as = nhs_bo_transfered_province
			}
		}
		else_if = {
			limit = {
				FROM = {
					has_country_flag = nhs_bo_macedonia
				}
				owns_or_subject_of = 148
			}
			148 = {
				tooltip = {
					cede_province = FROM
				}
				save_event_target_as = nhs_bo_transfered_province
			}
		}
		else_if = {
			limit = {
				FROM = {
					has_country_flag = nhs_bo_sparta
				}
				owns_or_subject_of = 145
			}
			145 = {
				tooltip = {
					cede_province = FROM
				}
				save_event_target_as = nhs_bo_transfered_province
			}
		}
		else_if = {
			limit = {
				FROM = {
					has_country_flag = nhs_bo_rhodes
				}
				owns_or_subject_of = 320
			}
			320 = {
				tooltip = {
					cede_province = FROM
				}
				save_event_target_as = nhs_bo_transfered_province
			}
		}
		# every_owned_province = {
		# 	limit = {
		# 		is_core = FROM
		# 	}
		# 	cede_province = FROM
		# }
		reverse_add_opinion = {
			who = FROM
			modifier = returned_core_to_me
		}
		FROM = {
			country_event = { id = nhs2_mainlandevents.11 }
		}
		ai_chance = {
			factor = 100 
			modifier = {
				factor = 0
				NOT = {
					OR = {
						AND = {
							FROM = {
								has_country_flag = nhs_bo_athens
							}
							owns_or_subject_of = 146
						}
						AND = {
							FROM = {
								has_country_flag = nhs_bo_macedonia
							}
							owns_or_subject_of = 148
						}
						AND = {
							FROM = {
								has_country_flag = nhs_bo_sparta
							}
							owns_or_subject_of = 145
						}
						AND = {
							FROM = {
								has_country_flag = nhs_bo_rhodes
							}
							owns_or_subject_of = 320
						}
					}
				}
			}
		}
	}
	
	option = {
		name = "nhs2_mainlandevents.10.b"
		FROM = {
			country_event = { id = nhs2_mainlandevents.12 }
		}
		ai_chance = { factor = 0 }
	}
}

# Yea
country_event = {
	id = nhs2_mainlandevents.11
	title = nhs2_mainlandevents.11.t
	desc = nhs2_mainlandevents.11.d
	picture = DIPLOMACY_eventPicture

	goto = nhs_bo_transfered_province
	
	is_triggered_only = yes
	
	option = {
		name = "nhs2_mainlandevents.11.a"
		event_target:nhs_bo_transfered_province = {
			cede_province = ROOT
		}
		if = {
			limit = {
				FROM = {
					exists = yes
					num_of_cities = 2
				}
			}
			reverse_add_opinion = {
				who = FROM
				modifier = opinion_diplomatic_solution
			}
		}
	}
}

# Nope
country_event = {
	id = nhs2_mainlandevents.12
	title = nhs2_mainlandevents.12.t
	desc = nhs2_mainlandevents.12.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "nhs2_mainlandevents.12.a"
	}
}

# Base of operations secured

country_event = {
	id = nhs2_mainlandevents.13
	title = nhs2_mainlandevents.13.t
	desc = nhs2_mainlandevents.13.d
	picture = BATTLE_eventPicture

	fire_only_once = yes
	
	trigger = {
		nhs_condition_all_ely = { KOMANDA = tag }
		has_country_flag = nhs_bo
		NOT = { has_country_flag = nhs_invasion_over }
		NOT = { has_country_flag = nhs_bo_secured }
		OR = {
			AND = {
				has_country_flag = nhs_bo_athens
				OR = {
					owns_or_subject_of = 146
					146 = {
						controller = {
							OR = {
								tag = ROOT
								is_subject_of = ROOT
							}
						}
					}
				}
			}
			AND = {
				has_country_flag = nhs_bo_macedonia
				OR = {
					owns_or_subject_of = 148
					148 = {
						controller = {
							OR = {
								tag = ROOT
								is_subject_of = ROOT
							}
						}
					}
				}
			}
			AND = {
				has_country_flag = nhs_bo_sparta
				OR = {
					owns_or_subject_of = 145
					145 = {
						controller = {
							OR = {
								tag = ROOT
								is_subject_of = ROOT
							}
						}
					}
				}
			}
			AND = {
				has_country_flag = nhs_bo_rhodes
				OR = {
					owns_or_subject_of = 320
					320 = {
						controller = {
							OR = {
								tag = ROOT
								is_subject_of = ROOT
							}
						}
					}
				}
			}
		}
		# NOT = {
		# 	any_owned_province = {
		# 		has_province_modifier = nhs2_base_of_operations
		# 	}
		# }
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		clr_country_flag = nhs_bo
		set_country_flag = nhs_bo_secured
		hidden_effect = {
			if = {
				limit = {
					has_country_flag = nhs_bo_athens
				}
				146 = {
					save_event_target_as = base_of_operations_target
				}
			}
			else_if = {
				limit = {
					has_country_flag = nhs_bo_macedonia
				}
				148 = {
					save_event_target_as = base_of_operations_target
				}
			}
			else_if = {
				limit = {
					has_country_flag = nhs_bo_sparta
				}
				145 = {
					save_event_target_as = base_of_operations_target
				}
			}
			else_if = {
				limit = {
					has_country_flag = nhs_bo_rhodes
				}
				320 = {
					save_event_target_as = base_of_operations_target
				}
			}
		}
	}
	
	option = {
		name = "nhs2_mainlandevents.13.a"
		goto = base_of_operations_target
		custom_tooltip = nhs_invasion_base_of_operations_modifiers_tt
		custom_tooltip = nhs_new_line_tt
		event_target:base_of_operations_target = {
			if = {
				limit = {
					NOT = { is_core = ROOT }
				}
				add_core = ROOT
			}
			if = {
				limit = {
					NOT = {
						owner = {
							tag = ROOT
						}
					}
				}
				cede_province = ROOT
			}
			if = {
				limit = {
					country_or_subject_holds = ROOT
				}
				if = {
					limit = {
						ROOT = {
							mil_tech = 19
						}
						NOT = { has_building = fort_18th }
					}
					if = {
						limit = {
							has_building = fort_15th
						}
						remove_building = fort_15th
					}
					if = {
						limit = {
							has_building = fort_16th
						}
						remove_building = fort_16th
					}
					if = {
						limit = {
							has_building = fort_17th
						}
						remove_building = fort_17th
					}
					add_building = fort_18th
				}
				else_if = {
					limit = {
						ROOT = {
							mil_tech = 14
							NOT = { mil_tech = 19 }
						}
						NOT = { has_building = fort_17th }
					}
					if = {
						limit = {
							has_building = fort_15th
						}
						remove_building = fort_15th
					}
					if = {
						limit = {
							has_building = fort_16th
						}
						remove_building = fort_16th
					}
					add_building = fort_17th
				}
				else_if = {
					limit = {
						ROOT = {
							NOT = { mil_tech = 14 }
						}
						NOT = { has_building = fort_16th }
					}
					if = {
						limit = {
							has_building = fort_15th
						}
						remove_building = fort_15th
					}
					add_building = fort_16th
				}
			}
			tooltip = {
				add_province_modifier = {
					name = nhs2_base_of_operations
					duration = -1
					desc = "END_OF_INVASION"
				}
			}
			hidden_effect = {
				add_province_triggered_modifier = nhs2_base_of_operations_tm
				save_global_event_target_as = nhs_base_of_operations_province
			}
		}
	}
}

# Conquest of Constantinople

country_event = {
	id = nhs2_mainlandevents.14
	title = nhs2_mainlandevents.14.t
	desc = nhs2_mainlandevents.14.d
	picture = CIVIL_WAR_eventPicture
	
	major = yes
	
	trigger = {
		NOT = { has_country_modifier = nhs2_timer_constantinople }
		nhs_condition_all_ely = { KOMANDA = tag }
		151 = {
			owner = {
				NOT = { culture_group = spartakian_group }
				NOT = { culture_group = elysian_group }
				NOT = { 
					AND = {
						culture_group = byzantine
						NOT = { primary_culture = turkish }
					}
				}
			}
			NOT = { owned_by = ROOT }
			controlled_by = ROOT
		}		
	}
	
	option = {
		goto = 151
		name = "nhs2_mainlandevents.14.a"	
		every_country = {
			limit = {
				tag = TUR
				capital = 151
				owns = 151
			}
			tooltip = {
				add_prestige = -25
				add_legitimacy = -10
				add_war_exhaustion = 10
			}
			country_event = { id = nhs2_mainlandevents.15 days = 1 }
		}
		every_country = {
			limit = {
				OR = {
					NOT = { tag = TUR }
					AND = {
						tag = TUR
						NOT = { capital = 151 }
					}
				}
				owns = 151
			}
			tooltip = {
				add_prestige = -10
				add_war_exhaustion = 2
			}
			country_event = { id = nhs2_mainlandevents.16 }			
		}
		151 = {
			add_core = ROOT
			cede_province = ROOT
			change_religion = ROOT
			change_culture = greek
			add_unrest = -20
		}
		add_war_exhaustion = -5
		hidden_effect = {
			if = {
				limit = {
					has_country_modifier = nhs2_timer_constantinople
				}
				remove_country_modifier = nhs2_timer_constantinople
			}
		}
	}
	
	option = {
		name = "nhs2_mainlandevents.14.b"
		hidden_effect = {
			add_country_modifier = {
				name = nhs2_timer_constantinople
				duration =  365
				hidden = yes
			}
		}
	}
}

# Conquest of Constantinople for turks

country_event = {
	id = nhs2_mainlandevents.15
	title = nhs2_mainlandevents.15.t
	desc = nhs2_mainlandevents.15.d
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	
	immediate = {
		set_country_flag = nhs_constantinople_was_capital
	}
	
	option = {
		goto = 151
		name = "nhs2_mainlandevents.15.a"
		add_prestige = -25
		add_war_exhaustion = 10
		add_legitimacy = -10
		tooltip = {
			151 = {
				add_core = FROM
				cede_province = FROM
				change_religion = FROM
				change_culture = greek
			}
		}
	}
}

# Conquest of Constantinople for previous owner

country_event = {
	id = nhs2_mainlandevents.16
	title = nhs2_mainlandevents.16.t
	desc = nhs2_mainlandevents.16.d
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		goto = 151
		name = "nhs2_mainlandevents.16.a"
		add_prestige = -10
		add_war_exhaustion = 2
		tooltip = {
			151 = {
				add_core = FROM
				cede_province = FROM
				change_religion = FROM
				change_culture = greek
			}
		}
	}
}

# Reconquest of Constantinople for turks

country_event = {
	id = nhs2_mainlandevents.17
	title = nhs2_mainlandevents.17.t
	desc = nhs2_mainlandevents.17.d
	picture = AWESOMECITY_eventPicture
	
	trigger = {
		has_country_flag = nhs_constantinople_was_capital
		tag = TUR
		owns = 151
		151 = {
			controlled_by = ROOT
		}
		NOT = { nhs_condition_all_ely = { KOMANDA = war_with } }
	}
	
	option = {
		goto = 151
		name = "nhs2_mainlandevents.17.a"
		hidden_effect = {
			every_country = {
				limit = {
					nhs_condition_all_ely = { KOMANDA = tag }
					owns = 151
				}
				country_event = { id = nhs2_mainlandevents.18 }
			}
		}
		151 = {
			add_core = ROOT
			cede_province = ROOT
			change_religion = ROOT
			change_culture = turkish
			add_unrest = -10
			add_base_manpower = -1
		}
		set_capital = 151
		add_prestige = 15
		add_war_exhaustion = -5
		add_legitimacy = 10
	}
}

# Reconquest of Constantinople for elysians

country_event = {
	id = nhs2_mainlandevents.18
	title = nhs2_mainlandevents.18.t
	desc = nhs2_mainlandevents.18.d
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		goto = 151
		name = "nhs2_mainlandevents.18.a"
		add_prestige = -10
		add_war_exhaustion = 2
		151 = {
			tooltip = {
				add_base_manpower = -1
				add_core = FROM
				cede_province = FROM
				change_religion = FROM
				change_culture = turkish
			}
		}
	}
}

# Establish local militia/elysian-greek nation
country_event = {
	id = nhs2_mainlandevents.19
	title = nhs2_mainlandevents.19.t
	desc = nhs2_mainlandevents.19.d
	picture = ARMY_CHARGE_eventPicture

	fire_only_once = yes

	trigger = {
		nhs_condition_all_ely = { KOMANDA = tag }
		is_at_war = no
		has_country_flag = nhs_invasion_second_part_begins
		NOT = { exists = ELG }
		NOT = { has_country_flag = nhs_formed_greek }
		# NOT = { has_country_modifier = nhs2_timer_formed_greek }
		NOT = { has_country_flag = nhs_invasion_over }
		NOT = { has_country_flag = nhs_no_greek_nation }
		any_owned_province = {
			nhs_greek_areas = yes
			NOT = { has_province_modifier = nhs2_base_of_operations_tm }
			NOT = {
				nhs_is_current_base_of_operations_target = { FLAG_SCOPE = ROOT }
			}
			NOT = { province_id = 151 }
			NOT = { has_construction = missionary }
			NOT = { has_province_modifier = nhs2_supply_lines_tm }
		}
	}
	
	mean_time_to_happen = {
		months = 3
	}
	
	immediate = {
		set_country_flag = nhs_formed_greek1
	}
	
	option = { # Form
		name = "nhs2_mainlandevents.19.a"
		tooltip = {
			create_subject = {
				subject_type = elysian_subject
				subject = ELG
			}
		}
		custom_tooltip = nhs_exarchate_modifiers_desc_elg_tt
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = nhs_konstantinia_provinces_tt
		custom_tooltip = nhs_konstantinia_provinces_during_invasion_tt
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = nhs_exarchate_setting_desc_elg_tt
		set_country_flag = nhs_formed_greek
		hidden_effect = {
			every_owned_province = {
				limit = {
					nhs_greek_areas = yes
					NOT = { has_province_modifier = nhs2_base_of_operations_tm }
					NOT = { province_id = 151 }
					NOT = {
						nhs_is_current_base_of_operations_target = { FLAG_SCOPE = ROOT }
					}
					NOT = { has_construction = missionary }
					NOT = { has_province_modifier = nhs2_supply_lines_tm }
				}
				tooltip = {
					cede_province = ELG
				}
				add_core = ELG
			}
			release = ELG
			create_subject = {
				subject_type = elysian_subject
				subject = ELG
			}
			if = {
				limit = {
					religion = pantheon_worship
				}
				country_event = {
					id = nhs2_mainlandevents.21
					days = 2
					tooltip = nhs2_mainlandevents.21.t
				}
			}
			ELG = {
				nhs_change_government = { GOV = monarchy }
				nhs_add_gov_reform = { REF = autocracy_reform }
				change_technology_group = eastern
				change_unit_type = eastern
				add_manpower = 10
				change_primary_culture = greek
				change_religion = orthodox
				reverse_add_opinion = {
					who = ROOT
					modifier = nhs_formed_greeko
				}
				add_opinion = {
					who = ROOT
					modifier = nhs_formed_greeko
				}
				add_treasury = 200
				add_mil_power = 100
				add_dip_power = 100
				add_adm_power = 100
				random_owned_province = {
					infantry = ROOT
					infantry = ROOT
					infantry = ROOT
					infantry = ROOT
					infantry = ROOT
				}
				clr_country_flag = nhs_ely_march_all
				clr_country_flag = nhs_ely_march_territory
				clr_country_flag = nhs_ely_march_no
				set_country_flag = nhs_ely_march_no_core
			}
		}
	}
	
	option = { # Nope
		name = "nhs2_mainlandevents.19.b"
		custom_tooltip = nhs_enable_form_konstantinia_decision_tt
		set_country_flag = nhs_enable_form_konstantinia_decision
		# hidden_effect = {
		# 	add_country_modifier = {
		# 		name = nhs2_timer_formed_greek
		# 		duration =  1825
		# 		hidden = yes
		# 	}
		# }
	}
}

# Question about greek provinces after invasion if you formed greek militia

country_event = {
	id = nhs2_mainlandevents.20
	title = nhs2_mainlandevents.20.t
	desc = nhs2_mainlandevents.20.d
	picture = GOOD_WITH_MONARCH_eventPicture
	
	fire_only_once = yes

	trigger = {
		nhs_condition_all_ely = { KOMANDA = tag }
		NOT = { has_country_flag = nhs_invasion_second_part_begins }
		has_country_flag = nhs_invasion_over
		has_country_flag = nhs_formed_greek
		NOT = { has_country_flag = nhs_no_greek_nation }
		exists = ELG
		ELG = {
			is_subject_of = ROOT
		}
		# OR = {
		# 	AND = {
		# 		exists = ELG
		# 		ELG = {
		# 			is_subject_of = ROOT
		# 		}
		# 	}
		# 	any_owned_province = {
		# 		nhs_greek_areas = yes
		# 		NOT = { province_id = 151 }
		# 		NOT = { has_construction = missionary }
		# 	}
		# }
	}

	immediate = {
		hidden_effect = {
			clr_country_flag = nhs_enable_form_konstantinia_decision
		}
	}
	
	option = {
		name = "nhs2_mainlandevents.20.a"
		trigger = {
			exists = ELG
			ELG = {
				is_subject_of = ROOT
			}
		}
		set_country_flag = nhs_formed_greek
		every_owned_province = {
			limit = {
				nhs_greek_areas = yes
				NOT = { province_id = 151 }
				NOT = { has_construction = missionary }
			}
			cede_province = ELG
			add_core = ELG
		}
		hidden_effect = {
			if = {
				limit = {
					religion = pantheon_worship
				}
				country_event = {
					id = nhs2_mainlandevents.21
					days = 1
					tooltip = nhs2_mainlandevents.21.t
				}
			}
		}
		ELG = {
			add_manpower = 10
			reverse_add_opinion = {
				who = ROOT
				modifier = nhs_formed_greeko
			}
			add_opinion = {
				who = ROOT
				modifier = nhs_formed_greeko
			}
			# every_owned_province = {
			# 	limit = {
			# 		nhs_greek_areas = yes
			# 	}
			# 	add_core = ELG
			# }
		}
	}
	
	# option = {
	# 	name = "nhs2_mainlandevents.20.b"  # Vassal
	# 	trigger = {
	# 		NOT = { exists = ELG }
	# 	}
	# 	set_country_flag = nhs_formed_greek
	# 	every_owned_province = {
	# 		limit = {
	# 			AND = {
	# 				nhs_greek_areas = yes
	# 				NOT = { province_id = 151 }
	# 				NOT = { has_construction = missionary }
	# 			}
	# 		}
	# 		tooltip = {
	# 			cede_province = ELG
	# 		}
	# 		add_core = ELG
	# 	}
	# 	if = {
	# 		limit = {
	# 			NOT = { exists = ELG }
	# 		}
	# 		release = ELG
	# 		create_subject = {
	# 			subject_type = elysian_subject
	# 			subject = ELG
	# 		}
	# 		ELG = {
	# 			hidden_effect  = {
	# 				change_primary_culture = greek
	# 				nhs_change_government = { GOV = monarchy }
	# 				nhs_add_gov_reform = { REF = autocracy_reform }
	# 				change_technology_group = eastern
	# 				change_unit_type = eastern
	# 			}
	# 			reverse_add_opinion = {
	# 				who = ROOT
	# 				modifier = nhs_formed_greeko
	# 			}
	# 			add_opinion = {
	# 				who = ROOT
	# 				modifier = nhs_formed_greeko
	# 			}
	# 			# hidden_effect = {
	# 			# 	every_owned_province = {
	# 			# 		limit = {
	# 			# 			nhs_greek_areas = yes
	# 			# 		}
	# 			# 		add_core = ELG
	# 			# 	}
	# 			# }
	# 			clr_country_flag = nhs_ely_march_all
	# 			clr_country_flag = nhs_ely_march_territory
	# 			clr_country_flag = nhs_ely_march_no
	# 			set_country_flag = nhs_ely_march_no_core
	# 		}
	# 	}
	# 	hidden_effect = {
	# 		if = {
	# 			limit = {
	# 				religion = pantheon_worship
	# 			}
	# 			country_event = {
	# 				id = nhs2_mainlandevents.21
	# 				days = 1
	# 				tooltip = nhs2_mainlandevents.21.t
	# 			}
	# 		}
	# 		# ELG = {
	# 		# 	hidden_effect = {
	# 		# 		every_owned_province = {
	# 		# 			limit = {
	# 		# 				nhs_greek_areas = yes
	# 		# 			}
	# 		# 			add_core = ELG
	# 		# 		}
	# 		# 	}
	# 		# }
	# 	}
	# }
	
	option = { # We have no need of them anymore
		name = "nhs2_mainlandevents.20.c"
		set_country_flag = nhs_no_greek_nation
		if = {
			limit = {
				exists = ELG
				ELG = { is_subject_of = ROOT }
			}
			inherit = ELG
		}
		custom_tooltip = nhs_enable_form_konstantinia_decision_tt
		set_country_flag = nhs_enable_form_konstantinia_decision
	}
}

# Question of religion later
country_event = {
	id = nhs2_mainlandevents.25
	title = nhs2_mainlandevents.25.t
	desc = nhs2_mainlandevents.25.d
	picture = PANTHEON_eventPicture
	
	trigger = {
		tag = ELG
		religion = pantheon_worship
		any_owned_province = {
			NOT = { has_province_flag = nhs_got_question_of_religion }
			religion = orthodox
			nhs_greek_areas = yes
		}
	}
	
	option = {
		name = "nhs2_mainlandevents.25.a"
		hidden_effect = {
			every_owned_province = {
				limit = {
					religion = orthodox
					NOT = { has_province_flag = nhs_got_question_of_religion }
					nhs_greek_areas = yes
				}
				set_province_flag = nhs_got_question_of_religion
				random_list = {
					40 = {
						add_province_modifier = {
							name = "nhs2_greek_deny_religion"
							duration = 7300
						}
					}
					40 = { 
						add_province_modifier = {
							name = "nhs2_greek_accept_religion"
							duration = 7300
						}
					}
					10 = { change_religion = ROOT }
					10 = { 
						add_province_modifier = {
							name = "missionary_failure"
							duration = 7300
						}
					}
				}
			}		
		}
	}
}

# Question of religion
country_event = {
	id = nhs2_mainlandevents.21
	title = nhs2_mainlandevents.21.t
	desc = nhs2_mainlandevents.21.d
	picture = PANTHEON_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { #Convert them
		name = "nhs2_mainlandevents.21.a"
		set_country_flag = nhs_converted_greeks
		add_legitimacy = 10
		ELG = {
			change_religion = ROOT
			add_country_modifier = {
				name = religious_tolerance
				duration =  3650
			}
			capital_scope = {
				add_province_triggered_modifier = religious_center_pantheon
			}
		}
		hidden_effect = {
			ELG = {
				capital_scope = {
					change_religion = ROOT
				}
				random_owned_province = {
					limit = {
						religion = orthodox
						nhs_greek_areas = yes
					}
					change_religion = ROOT
				}
				random_owned_province = {
					limit = {
						religion = orthodox
						nhs_greek_areas = yes
					}
					change_religion = ROOT
				}
				every_owned_province = {
					limit = {
						religion = orthodox
						NOT = { has_province_flag = nhs_got_question_of_religion }
						nhs_greek_areas = yes
					}
					set_province_flag = nhs_got_question_of_religion
					random_list = {
						40 = {
							add_province_modifier = {
								name = "nhs2_greek_deny_religion"
								duration = 7300
							}
						}
						40 = { 
							add_province_modifier = {
								name = "nhs2_greek_accept_religion"
								duration = 7300
							}
						}
						10 = { change_religion = ROOT }
						10 = { 
							add_province_modifier = {
								name = "missionary_failure"
								duration = 7300
							}
						}
					}
				}
			}			
		}
	}
	
	option = { # Let them be orthodox
		name = "nhs2_mainlandevents.21.b"
		add_prestige = -5
		add_legitimacy = -5
	}
}

# Question about greek provinces before invasion or if you did not form greek militia

country_event = {
	id = nhs2_mainlandevents.22
	title = nhs2_mainlandevents.22.t
	desc = nhs2_mainlandevents.22.d
	picture = GOOD_WITH_MONARCH_eventPicture
	
	fire_only_once = yes

	trigger = {
		nhs_condition_all_ely = { KOMANDA = tag }
		NOT = { has_country_flag = nhs_invasion_second_part_begins }
		OR = {
			has_country_flag = nhs_invasion_over
			NOT = { has_country_flag = nhs_invasion_begins }
		}
		NOT = { has_country_flag = nhs_formed_greek }
		any_owned_province = {
			nhs_greek_areas = yes
			NOT = { province_id = 151 }
			NOT = { has_construction = missionary }
		}
		NOT = { has_country_flag = nhs_no_greek_nation }
	}

	immediate = {
		hidden_effect = {
			clr_country_flag = nhs_enable_form_konstantinia_decision
		}
	}
	
	option = {
		name = "nhs2_mainlandevents.22.a"  # Give it to local lord
		tooltip = {
			create_subject = {
				subject_type = elysian_subject
				subject = ELG
			}
		}
		custom_tooltip = nhs_exarchate_modifiers_desc_elg_tt
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = nhs_konstantinia_provinces_tt
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = nhs_exarchate_setting_desc_elg_tt
		set_country_flag = nhs_formed_greek
		hidden_effect = {
			every_owned_province = {
				limit = {
					nhs_greek_areas = yes
					NOT = { province_id = 151 }
					NOT = { has_construction = missionary }
				}
				# hidden_effect = {
				# 	if = {
				# 		limit = {
				# 			is_claim = ROOT
				# 		}
				# 		remove_claim = ROOT
				# 	}
				# }
				tooltip = {
					cede_province = ELG
				}
				add_core = ELG
			}
			release = ELG
			create_subject = {
				subject_type = elysian_subject
				subject = ELG
			}
			if = {
				limit = {
					religion = pantheon_worship
				}
				country_event = {
					id = nhs2_mainlandevents.21
					days = 1
					tooltip = nhs2_mainlandevents.21.t
				}
			}
			ELG = {
				change_primary_culture = greek
				nhs_change_government = { GOV = monarchy }
				nhs_add_gov_reform = { REF = autocracy_reform }
				change_technology_group = eastern
				change_unit_type = eastern
				change_religion = orthodox
				add_manpower = 10
				reverse_add_opinion = {
					who = ROOT
					modifier = nhs_formed_greeko
				}
				add_opinion = {
					who = ROOT
					modifier = nhs_formed_greeko
				}
				every_owned_province = {
					limit = {
						nhs_greek_areas = yes
					}
					add_core = ELG
				}
				add_treasury = 200
				add_mil_power = 100
				add_dip_power = 100
				add_adm_power = 100
				random_owned_province = {
					infantry = ROOT
					infantry = ROOT
					infantry = ROOT
					infantry = ROOT
					infantry = ROOT
				}
				clr_country_flag = nhs_ely_march_all
				clr_country_flag = nhs_ely_march_territory
				clr_country_flag = nhs_ely_march_no
				set_country_flag = nhs_ely_march_no_core
			}
		}
	}
	
	option = { # We will control the land ourselves
		name = "nhs2_mainlandevents.22.c"
		set_country_flag = nhs_no_greek_nation
		custom_tooltip = nhs_enable_form_konstantinia_decision_tt
		set_country_flag = nhs_enable_form_konstantinia_decision
	}
}

# Greek Elysia gets a province  give core

# province_event = {
# 	id = nhs2_mainlandevents.50
# 	title = nhs2_mainlandevents.50.t
# 	desc = nhs2_mainlandevents.50.d
# 	picture = DIPLOMACY_eventPicture

# 	trigger = {
# 		owner = {
# 			tag = ELG		
# 		}
# 		nhs_greek_areas = yes
# 		continent = europe
# 		NOT = { province_id = 151 }
# 		NOT = { is_core = ELG }
# 	}
	
# 	mean_time_to_happen = {
# 		days = 1
# 	}
	
# 	option = {
# 		name = "nhs2_mainlandevents.50.a"
# 		add_core = ELG
# 		add_unrest = -5
# 		hidden_effect = {	
# 			if = {
# 				limit = {
# 					owner = {
# 						religion = pantheon_worship
# 					}
# 					NOT = { has_province_flag = nhs_got_question_of_religion }
# 					nhs_greek_areas = yes
# 				}
# 				set_province_flag = nhs_got_question_of_religion
# 				random_list = {
# 					40 = {
# 						add_province_modifier = {
# 						name = "nhs2_greek_deny_religion"
# 							duration = 7300
# 						}
# 					}
# 					40 = { 
# 						add_province_modifier = {
# 							name = "nhs2_greek_accept_religion"
# 							duration = 7300
# 						}
# 					}
# 					10 = { change_religion = ROOT }
# 					10 = { 
# 						add_province_modifier = {
# 							name = "missionary_failure"
# 							duration = 7300
# 						}
# 					}
# 				}
# 			}
# 		}		
# 	}
# }

# INVASION IS OVER

country_event = {
	id = nhs2_mainlandevents.24
	title = nhs2_mainlandevents.24.t
	desc = nhs2_mainlandevents.24.d
	picture = VICTORY_eventPicture
	
	major = yes
	
	fire_only_once = yes
	
	trigger = {
		owns_or_vassal_of = 151
		nhs_condition_all_ely = { KOMANDA = tag }
		NOT = { has_country_flag = nhs_invasion_over }
		NOT = {
			any_province = {
				AND = {
					culture = greek
					continent = europe
					NOT = {
						owner = {
							OR = {
								nhs_condition_all_ely = { KOMANDA = tag }
								is_subject_of = ROOT
								primary_culture = greek
								primary_culture = pontic_greek
								primary_culture = goths
							}
						}			
					}
				}
			}
		}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		set_country_flag = nhs_invasion_over
		clr_country_flag = nhs_bo_sparta
		clr_country_flag = nhs_bo_rhodes
		clr_country_flag = nhs_bo_macedonia
		clr_country_flag = nhs_bo_athens
		clr_country_flag = nhs_bo
		clr_country_flag = nhs_got_bo_buff
		clr_country_flag = nhs_invasion_second_part_begins
		clr_country_flag = nhs_invasion_second_part
		clr_country_flag = nhs_supply_lines
		clr_country_flag = nhs_supply_lines_secured
		
	}
	
	option = {
		name = "nhs2_mainlandevents.24.a"  # Rejoice!
		add_prestige = 50
		add_legitimacy = 50
		add_army_tradition = 50
		add_country_modifier = {
			name = "nhs2_invasion_succeseful"
			duration = -1
		}
		if = {
			limit = {
				any_province = {
					has_province_modifier = nhs2_supply_lines_tm
				}
			}
			custom_tooltip = nhs_remove_supply_lines_tt
			random_province = {
				limit = {
					has_province_modifier = nhs2_supply_lines_tm
				}
				nhs_set_center_of_trade_2 = yes
				hidden_effect = {
					remove_province_triggered_modifier = nhs2_supply_lines_tm
				}
			}
		}
		if = {
			limit = {
				any_province = {
					has_province_modifier = nhs2_base_of_operations_tm
				}
			}
			custom_tooltip = nhs_remove_base_of_operations_tt
			hidden_effect = {
				every_province = {
					limit = {
						has_province_modifier = nhs2_base_of_operations_tm
					}
					remove_province_triggered_modifier = nhs2_base_of_operations_tm
				}
				clear_global_event_target = nhs_base_of_operations_province
			}
		}
		hidden_effect = {
			every_owned_province = {
				limit = {
					culture = greek
					continent = europe
				}
				add_unrest = -5
			}
		}
	}
}

# Regain secrets after recapturing Constantinople (triggers from mission)
country_event = {
	id = nhs2_mainlandevents.27
	title = nhs2_mainlandevents.27.t
	desc = nhs2_mainlandevents.27.d
	picture = palailogos_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "nhs2_mainlandevents.27.a"
		if = {
			limit = {
				has_country_flag = nhs_new_flight_taken_fire
				has_country_flag = nhs_new_flight_taken_books
				has_country_flag = nhs_new_flight_taken_silk
			}
			add_adm_power = 50
			add_dip_power = 50
			add_mil_power = 50
		}
		if = {
			limit = {
				NOT = { has_country_flag = nhs_new_flight_taken_fire }
			}
			set_country_flag = nhs_searching_for_naphtha
			custom_tooltip = nhs_naphtha_is_required_tt
			set_country_flag = nhs_fire_discovery_delay
			custom_tooltip = nhs_new_line_tt
		}
		if = {
			limit = {
				NOT = { has_country_flag = nhs_new_flight_taken_books }
			}
			add_country_modifier = {
				name = "nhs_secrets_books"
				duration = -1
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = nhs_new_flight_taken_silk }
			}
			custom_tooltip = nhs_silk_from_europe_tt
		}
	}
}

#Greek state chooses whether to cede Constantinople
country_event = {
	id = nhs2_mainlandevents.32
	title = nhs2_mainlandevents.32.t
	desc = nhs2_mainlandevents.32.d
	picture = ELYSIAN_HARBOUR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "nhs2_mainlandevents.32.a"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { has_country_flag = nhs_agree_to_the_deal }
			}
		}
		tooltip = {
			151 = {
				cede_province = FROM
				add_core = FROM
				remove_core = ROOT
			}
			FROM = {
				add_opinion = {
					who = ROOT
					modifier = nhs_constantinople_deal_op
				}
				add_truce_with = ROOT
			}
		}
		FROM = {
			country_event = { id = nhs2_mainlandevents.33 days = 1 }
		}
	}
	
	option = {
		name = "nhs2_mainlandevents.32.b"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				has_country_flag = nhs_agree_to_the_deal
			}
		}
		FROM = {
			tooltip = {
				add_permanent_claim = FROM
				add_opinion = {
					who = ROOT
					modifier = nhs_no_constantinople_deal_op
				}
			}
			country_event = { id = nhs2_mainlandevents.34 days = 1 }
		}
	}
	after = {
		clr_country_flag = nhs_agree_to_the_deal
	}
}

#Greek state agrees
country_event = {
	id = nhs2_mainlandevents.33
	title = nhs2_mainlandevents.33.t
	desc = nhs2_mainlandevents.33.d
	picture = ELYSIAN_HARBOUR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "nhs2_mainlandevents.33.a"
		151 = {
			cede_province = ROOT
			add_core = ROOT
			FROM = {
				remove_core = 151
			}
			if = {
				limit = {
					FROM = {
						NOT = { num_of_cities = 2 }
					}
				}
				owner = {
					add_opinion = {
						who = FROM
						modifier = nhs_constantinople_deal_op
					}
					add_truce_with = FROM
				}
			}
		}
	}
}

#Greek state disagrees
country_event = {
	id = nhs2_mainlandevents.34
	title = nhs2_mainlandevents.34.t
	desc = nhs2_mainlandevents.34.d
	picture = byz_HARBOUR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "nhs2_mainlandevents.34.a"
		151 = {
			add_permanent_claim = FROM
		}
		add_opinion = {
			who = FROM
			modifier = nhs_no_constantinople_deal_op
		}
	}
}