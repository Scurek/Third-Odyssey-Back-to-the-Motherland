namespace = to_janissary_events

# Frontier Skirmishes
country_event = {
	id = to_janissary_events.1
	title = to_janissary_events.1.t
	desc = to_janissary_events.1.d
	picture = tur_MILITARY_CAMP_eventPicture

	fire_only_once = yes
	
	trigger = {
		nhs_check_all_elysian_tags = { CONDITION = tag }
		has_country_flag = nhs_new_flight_taken_turks
		num_of_cities = 2
		any_owned_province = {
			is_colony = yes
			colonysize = 400
		}
	}

	after = {
		set_country_flag = to_had_janissary_events_1
	}

	option = {
		name = "to_janissary_events.1.a"
		define_conquistador = {
			name = "Orhan Çelebi"
			shock = 3
			fire = 3
			manuever = 2
			siege = 1
		}
		if = {
			limit = {
				OR = {
					has_dlc = "Cradle of Civilization"
					has_dlc = "Domination"
				}
			}
			add_manpower = 2
		}
		random_owned_province = {
			limit = {
				is_colony = yes
				colonysize = 400
			}
			if = {
				limit = {
					OR = {
						has_dlc = "Cradle of Civilization"
						has_dlc = "Domination"
					}
				}
				custom_tooltip = to_spawn_janissary_regiments_tt
				hidden_effect = {
					janissary_infantry = ROOT
					janissary_infantry = ROOT
				}
			}
			else = {
				infantry = ROOT
				infantry = ROOT
			}
			add_colonysize = 400
			add_base_manpower = 2
		}
		every_province = {
			limit = {
				nhs_homelands_no_capital = yes
				OR = {
					is_colony = yes
					is_empty = yes
				}
			}
			change_native_ferocity = -10
			change_native_hostileness = -10
		}
	}
	
	option = {
		name = "to_janissary_events.1.b"
		define_advisor = {
			type = commandant
			name = "Orhan Çelebi"
			skill = 2
			culture = turkish
			religion = sunni
			cost_multiplier = 0.25
			female = no
		}
		add_manpower = 2
		random_owned_province = {
			limit = {
				is_colony = yes
				colonysize = 400
			}
			add_colonysize = 400
			add_base_manpower = 2
		}
		custom_tooltip = nhs_new_line_tt
		if = {
			limit = {
				OR = {
					has_dlc = "Cradle of Civilization"
					has_dlc = "Domination"
				}
			}
			custom_tooltip = to_spawn_janissary_regiments_capital_tt
			hidden_effect = {
				capital_scope = {
					janissary_infantry = ROOT
					janissary_infantry = ROOT
				}
			}
			custom_tooltip = nhs_new_line_tt
		}
		every_province = {
			limit = {
				nhs_homelands_no_capital = yes
				OR = {
					is_colony = yes
					is_empty = yes
				}
			}
			change_native_ferocity = -10
			change_native_hostileness = -10
		}
	}
}

# Orhanns Janissaries
country_event = {
    id = to_janissary_events.2
    title = to_janissary_events.2.t
    desc = to_janissary_events.2.d
    picture = imported_PASHAS_eventPicture

    fire_only_once = yes
    
    trigger = {
		nhs_check_all_elysian_tags = { CONDITION = tag }
        is_year = 1447
        is_month = 5
        had_country_flag = {
            flag = to_had_janissary_events_1
            days = 90
        }
        OR = {
            has_dlc = "Cradle of Civilization"
            has_dlc = "Domination"
        }
    }

	immediate = {
		clr_country_flag = to_had_janissary_events_1
	}

	after = {
		clr_country_flag = to_had_janissary_events_2
	}

    option = {
        name = "to_janissary_events.2.a"
		add_legitimacy = -10
        add_country_modifier = {
            name = to_orhan_janissaries
            duration = -1
        }
		custom_tooltip = to_enable_janissary_mechanic_tt
		hidden_effect = {
			add_country_modifier = {
				name = to_janissary_child_levy
				duration = -1
				hidden = yes
			}
			to_roman_janissaries_maintenance = {}
		}
    }
    
    option = {
        name = "to_janissary_events.2.b"
        add_army_tradition = 10
        add_mil_power = 50
    }
}

# Prinkipes (Mercenaries)
country_event = {
	id = to_janissary_events.3
	title = to_janissary_events.3.t
	desc = {
		trigger = {
			has_country_flag = to_had_orhans_jannisaries_ad
		}
		desc = to_janissary_events.3.da
	}
	desc = {
		desc = to_janissary_events.3.db
	}
	picture = imported_JANISSARIES_IN_FORMATION_eventPicture

	is_triggered_only = yes

	after = {
		clr_country_flag = to_had_orhans_jannisaries_ad
	}

	option = {
		name = "to_janissary_events.3.aa"
		trigger = {
			has_country_flag = to_had_orhans_jannisaries_ad
		}
		add_legitimacy = -10
		set_country_flag = to_established_prinkipes
		custom_tooltip = to_enables_prinkipes_mercs_tt
		custom_tooltip = nhs_new_line_tt
		add_country_modifier = {
			name = to_prinkipe_recruitment
			duration = -1
		}
	}

	option = {
		name = "to_janissary_events.3.ab"
		trigger = {
			NOT = { has_country_flag = to_had_orhans_jannisaries_ad }
		}
		add_legitimacy = -10
		set_country_flag = to_established_prinkipes
		custom_tooltip = to_enables_prinkipes_mercs_tt
		custom_tooltip = nhs_new_line_tt
		add_country_modifier = {
			name = to_prinkipe_recruitment
			duration = -1
		}
	}
	
	option = {
		name = "to_janissary_events.3.b"
		add_manpower = 5
		add_mil_power = 50
	}
}

# Janissaries Recruitment Menu
country_event = {
	id = to_janissary_events.4
	title = to_janissary_events.4.t
	desc = to_janissary_events.4.d
	picture = imported_JANISSARIES_IN_FORMATION_eventPicture

	goto = to_janissary_recruitment_province

	is_triggered_only = yes

	immediate = {
		set_country_flag = to_janissary_recruitment_menu_open
		hidden_effect = {
			if = {
				limit = {
					capital_scope = {
						controlled_by = ROOT
					}
				}
				capital_scope = {
					save_event_target_as = to_janissary_recruitment_province
				}
			}
			else_if = {
				limit = {
					capital_scope = {
						area_for_scope_province = {
							controlled_by = ROOT
						}
					}
				}
				capital_scope = {
					save_event_target_as = to_janissary_recruitment_province
				}
			}
			else = {
				capital_scope = {
					save_event_target_as = to_janissary_recruitment_province
				}
			}
		}
	}

	after = {
		clr_country_flag = to_janissary_recruitment_menu_open
		country_event = { id = to_janissary_events.4 }
	}

	option = {
		name = "to_janissary_events.4.a"
		trigger = {
			capital_scope = {
				area_for_scope_province = {
					controlled_by = ROOT
				}
			}
		}
		if = {
			limit = {
				capital_scope = {
					controlled_by = ROOT
				}
			}
			capital_scope = {
				janissary_infantry = ROOT
			}
		}
		else_if = {
			limit = {
				event_target:to_janissary_recruitment_province = {
					controlled_by = ROOT
				}
			}
			capital_scope = {
				janissary_infantry = ROOT
			}
		}
		else_if = {
			limit = {
				capital_scope = {
					area_for_scope_province = {
						controlled_by = ROOT
					}
				}
			}
			random_owned_province = {
				limit = {
					controlled_by = ROOT
					area_for_scope_province = {
						is_capital_of = ROOT
					}
				}
				janissary_infantry = ROOT
			}
		}
		else = {
			capital_scope = {
				janissary_infantry = ROOT
			}
		}
	}

	option = {
		name = "to_janissary_events.3.ab"
		trigger = {
			NOT = { has_country_flag = to_had_orhans_jannisaries_ad }
		}
		
	}

	option = {
		name = "to_janissary_events.3.ab"
		trigger = {
			NOT = { has_country_flag = to_had_orhans_jannisaries_ad }
		}
		
	}
	
	option = {
		name = "to_janissary_events.3.b"
	}
}

# Janissaries Laws
country_event = {
	id = to_janissary_events.5
	title = to_janissary_events.5.t
	desc = to_janissary_events.5.d
	picture = BIG_BOOK_eventPicture

	is_triggered_only = yes

	immediate = {
		set_country_flag = to_janissary_laws_menu_open
	}

	after = {
		clr_country_flag = to_janissary_laws_menu_open
		country_event = { id = to_janissary_events.5 }
	}

	# Enact child levy
	option = {
		name = "to_janissary_events.5.aa"
		trigger = {
			NOT = { has_country_modifier = to_janissary_child_levy }
		}
		custom_tooltip = to_child_levy_flavor_tt
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = to_child_levy_enact_tt

		hidden_effect = {
			add_country_modifier = {
				name = to_janissary_child_levy
				duration = -1
				hidden = yes
			}
		}

		to_add_janissary_law_cooldown = yes
	}

	# End the child levy
	option = {
		name = "to_janissary_events.5.ab"
		trigger = {
			has_country_modifier = to_janissary_child_levy
		}
		custom_tooltip = to_child_levy_flavor_tt
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = to_child_levy_revoke_tt
		hidden_effect = {
			remove_country_modifier = to_janissary_child_levy
		}

		if = {
			limit = {
				has_country_modifier = to_janissary_from_true_faith
			}
			custom_tooltip = nhs_new_line_tt
			custom_tooltip = to_from_subjects_revoke_tt
			hidden_effect = {
				remove_country_modifier = to_janissaries_from_true_faith
			}
		}

		if = {
			limit = {
				has_country_modifier = to_janissary_from_true_faith
			}
			custom_tooltip = nhs_new_line_tt
			custom_tooltip = to_from_true_faith_revoke_tt
			hidden_effect = {
				clr_country_flag = to_janissary_from_subjects
			}
		}
		
		to_add_janissary_law_cooldown = yes
	}

	# Draft the Faithful
	option = {
		name = "to_janissary_events.5.ba"
		trigger = {
			has_country_modifier = to_janissary_child_levy
			NOT = { has_country_modifier = to_janissaries_from_true_faith }
		}
		custom_tooltip = to_from_true_faith_flavor_tt
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = to_from_true_faith_enact_tt
		hidden_effect = {
			add_country_modifier = {
				name = to_janissaries_from_true_faith
				duration = -1
				hidden = yes
			}
		}

		to_add_janissary_law_cooldown = yes
	}

	# End the Draft of the Faithful
	option = {
		name = "to_janissary_events.5.bb"
		trigger = {
			has_country_modifier = to_janissaries_from_true_faith
		}

		custom_tooltip = to_from_true_faith_flavor_tt
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = to_from_true_faith_revoke_tt
		hidden_effect = {
			remove_country_modifier = to_janissaries_from_true_faith
		}

		to_add_janissary_law_cooldown = yes
	}

	# Constript from Subjects
	option = {
		name = "to_janissary_events.5.ca"
		trigger = {
			has_country_modifier = to_janissary_child_levy
			NOT = { has_country_flag = to_janissary_from_subjects }
		}

		custom_tooltip = to_from_subjects_flavor_tt
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = to_from_subjects_enact_tt
		hidden_effect = {
			set_country_flag = to_janissary_from_subjects
		}

		to_add_janissary_law_cooldown = yes
	}

	# End Constription from Subjects
	option = {
		name = "to_janissary_events.5.cb"
		trigger = {
			has_country_flag = to_janissary_from_subjects
		}

		custom_tooltip = to_from_subjects_flavor_tt
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = to_from_subjects_revoke_tt
		hidden_effect = {
			clr_country_flag = to_janissary_from_subjects
		}
		
		to_add_janissary_law_cooldown = yes
	}

	# Open Recruitment
	option = {
		name = "to_janissary_events.5.da"
		trigger = {
			NOT = { has_country_modifier = to_janissary_open_recruitment }
		}

		custom_tooltip = to_open_recruitment_flavor_tt
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = to_open_recruitment_enact_tt
		hidden_effect = {
			add_country_modifier = {
				name = to_janissary_open_recruitment
				duration = -1
				hidden = yes
			}
		}

		to_add_janissary_law_cooldown = yes
	}

	# Restrict Recruitment
	option = {
		name = "to_janissary_events.5.db"
		trigger = {
			has_country_modifier = to_janissary_open_recruitment
		}
		custom_tooltip = to_open_recruitment_flavor_tt
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = to_open_recruitment_revoke_tt
		hidden_effect = {
			remove_country_modifier = to_janissary_open_recruitment
		}
		
		to_add_janissary_law_cooldown = yes
	}

	# Increase Compensation
	option = {
		name = "to_janissary_events.5.ea"
		trigger = {
			NOT = { has_country_modifier = to_janissary_increase_compensation }
		}

		custom_tooltip = to_increase_compensation_flavor_tt
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = to_increase_compensation_enact_tt
		hidden_effect = {
			add_country_modifier = {
				name = to_janissary_increase_compensation
				duration = -1
				hidden = yes
			}
			add_country_modifier = {
				name = to_janissary_increase_compensation_regiments
				duration = -1
				hidden = yes
			}
		}

		set_country_flag = to_janissary_increase_compensation
		to_add_janissary_law_cooldown = yes
	}

	# Reduce Compensation
	option = {
		name = "to_janissary_events.5.eb"
		trigger = {
			has_country_modifier = to_janissary_increase_compensation
		}

		custom_tooltip = to_increase_compensation_flavor_tt
		custom_tooltip = nhs_new_line_tt
		custom_tooltip = to_increase_compensation_revoke_tt
		hidden_effect = {
			remove_country_modifier = to_janissary_increase_compensation
			remove_country_modifier = to_janissary_increase_compensation_regiments
		}
		
		to_add_janissary_law_cooldown = yes
	}

	# Exit
	option = {
		name = "to_janissary_events.5.f"
	}
}