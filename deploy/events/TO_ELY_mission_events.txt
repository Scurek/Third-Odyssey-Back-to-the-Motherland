namespace = nhs_mission_events

#Nea Hagia Sophia start, choice where?
country_event = {
	id = nhs_mission_events.1
	title = nhs_mission_events.1.t
	desc = nhs_mission_events.1.d
	picture = nhs_Hagia_Sophia
	
	is_triggered_only = yes

	option = { #In the middle of the city, lowers one tax dev
		name = "nhs_mission_events.1.a"
		hidden_effect = {
			953 = {
				add_base_tax = -1
				set_province_flag = nhs_enable_nhs_hagia_theotoke_v1
				add_great_project = {
					type = nhs_hagia_theotoke_v1
					instant = yes
				}				
			}
		}
		to_monuments_later = { PROVINCE_ID = 953 }
		custom_tooltip = nhs_enable_nhs_hagia_theotoke_v1_tt
	}
	
	option = { #Outside of the city, accessible to pilgrims
		name = "nhs_mission_events.1.b"
		hidden_effect = {
			953 = {
				set_province_flag = nhs_enable_nhs_hagia_theotoke_v2
				add_great_project = {
					type = nhs_hagia_theotoke_v2
					instant = yes
				}				
			}
		}
		to_monuments_later = { PROVINCE_ID = 953 }
		custom_tooltip = nhs_enable_nhs_hagia_theotoke_v2_tt
	}
	
	option = { #In the bay, for everyone to see
		name = "nhs_mission_events.1.c"
		hidden_effect = {
			950 = {
				set_province_flag = nhs_enable_nhs_hagia_theotoke_v3
				add_great_project = {
					type = nhs_hagia_theotoke_v3
					instant = yes
				}				
			}
		}
		to_monuments_later = { PROVINCE_ID = 950 }
		custom_tooltip = nhs_enable_nhs_hagia_theotoke_v3_tt
	}

	option = { #Not right now
		name = "nhs_mission_events.1.e"
		custom_tooltip = nhs_enable_hagia_theotoke_decision_tt
		set_country_flag = nhs_enable_hagia_theotoke_decision
	}
}

#Nea Hagia Sophia event finished
country_event = {
	id = nhs_mission_events.101
	title = nhs_mission_events.101.t
	desc = nhs_mission_events.101.d
	picture = nhs_Hagia_Sophia
	
	is_triggered_only = yes

	option = { 
		name = "nhs_mission_events.101.a"
		add_prestige = 20
		add_splendor = 100
	}
}

#Parthenon, choice where?
country_event = {
	id = nhs_mission_events.2
	title = nhs_mission_events.2.t
	desc = nhs_mission_events.2.d
	picture = nhs_Akropolis

	is_triggered_only = yes

	option = { #In the middle of the city, by the Emperor's Palace
		name = "nhs_mission_events.2.a"
		hidden_effect = {
			953 = {
				add_base_tax = -1
				set_province_flag = nhs_enable_temple_of_marble_emperors_v1
				add_great_project = {
					type = nhs_temple_of_marble_emperors_v1
					instant = yes
				}				
			}
		}
		to_monuments_later = { PROVINCE_ID = 953 }
		custom_tooltip = nhs_temple_of_marble_emperors_v1_tt
	}
	
	option = { #Outside of the city, accessible to pilgrims,
		name = "nhs_mission_events.2.b"
		hidden_effect = {
			953 = {
				set_province_flag = nhs_enable_temple_of_marble_emperors_v2
				add_great_project = {
					type = nhs_temple_of_marble_emperors_v2
					instant = yes
				}
			}
		}
		to_monuments_later = { PROVINCE_ID = 953 }
		custom_tooltip = nhs_temple_of_marble_emperors_v2_tt
	}
	
	option = { #In the bay, for everyone to see
		name = "nhs_mission_events.2.c"
		hidden_effect = {
			950 = {
				set_province_flag = nhs_enable_temple_of_marble_emperors_v3
				add_great_project = {
					type = nhs_temple_of_marble_emperors_v3
					instant = yes
				}
			}
		}
		to_monuments_later = { PROVINCE_ID = 950 }
		custom_tooltip = nhs_temple_of_marble_emperors_v3_tt
	}

	option = { #Not right now
		name = "nhs_mission_events.2.e"
		custom_tooltip = nhs_enable_temple_of_marble_emperors_decision_tt
		set_country_flag = nhs_enable_temple_of_marble_emperors_decision
	}
}

#Parthenon event finished
country_event = {
	id = nhs_mission_events.201
	title = nhs_mission_events.201.t
	desc = nhs_mission_events.201.d
	picture = nhs_Akropolis
	
	is_triggered_only = yes

	option = { 
		name = nhs_mission_events.201.a
		add_prestige = 20
		add_splendor = 100
	}
}

#Spartan events
country_event = {
	id = nhs_mission_events.10
	title = nhs_mission_events.10.t
	desc = nhs_mission_events.10.d
	picture = Tenochtitlan_Expanded_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		nhs_condition_all_ely = { KOMANDA = tag }
		government = monarchy
		has_country_flag = nhs_expanding_north_completed
		NOT = { has_country_flag = nhs_gain_spartan_pu }
		OR = {
			AND = {
				exists = MSN
				MSN = {
					NOT = { is_subject_of = ROOT }
					OR = {
						dynasty = "Spartakon"
						dynasty = ROOT
					}
				}
			}
			AND = {
				exists = MS1
				MS1 = {
					NOT = { is_subject_of = ROOT }
					OR = {
						dynasty = "Spartakon"
						dynasty = ROOT
					}
				}
			}
		}
		
	}
	
	immediate = {
		set_country_flag = nhs_gain_spartan_pu
	}

	option = {
		name = nhs_mission_events.10.a
		custom_tooltip = nhs_gain_spartan_pu_tt
	}
}

#Spartan events
country_event = {
	id = nhs_mission_events.11
	title = nhs_mission_events.11.t
	desc = nhs_mission_events.11.d
	picture = Tenochtitlan_Expanded_eventPicture
	
	trigger = {
		nhs_condition_all_ely = { KOMANDA = tag }
		government = monarchy
		has_country_flag = nhs_expanding_north_completed
		NOT = { has_country_flag = nhs_gain_spartan_pu_restore_dynasty }
		OR = {
			AND = {
				exists = MSN
				MSN = {
					NOT = { is_subject_of = ROOT }
					NOT = { dynasty = "Spartakon" }
					NOT = { dynasty = ROOT }
				}
			}
			AND = {
				exists = MS1
				MS1 = {
					NOT = { is_subject_of = ROOT }
					NOT = { dynasty = "Spartakon" }
					NOT = { dynasty = ROOT }
				}
			}
		}
		
	}
	
	immediate = {
		set_country_flag = nhs_gain_spartan_pu_restore_dynasty
	}

	option = {
		name = "nhs_mission_events.11.a"
		custom_tooltip = nhs_gain_restore_family_cb_over_sparta_tt
	}
}

#Spartan events
country_event = {
	id = nhs_mission_events.12
	title = nhs_mission_events.12.t
	desc = nhs_mission_events.12.d
	picture = Tenochtitlan_Expanded_eventPicture
	
	trigger = {
		nhs_condition_all_ely = { KOMANDA = tag }
		has_country_flag = nhs_expanding_north_completed
		NOT = { has_country_flag = nhs_gain_spartan_cores }
		OR = {
			MSN = {
				is_subject_of = ROOT
			}
			MS1 = {
				is_subject_of = ROOT
			}
		}
	}
	
	immediate = {
		set_country_flag = nhs_gain_spartan_cores
	}

	option = {
		name = "nhs_mission_events.12.a"
		if = {
			limit = {
				MSN = {
					is_subject_of = ROOT
				}
			}
			mesoamerica_pgroup = {
				limit = {
					NOT = { is_core = MSN }
					NOT = { country_or_non_sovereign_subject_holds = ROOT }
				}
				add_core = MSN
			}
		}
		else_if = {
			limit = {
				MS1 = {
					is_subject_of = ROOT
				}
			}
			mesoamerica_pgroup = {
				limit = {
					NOT = { is_core = MS1 }
					NOT = { country_or_non_sovereign_subject_holds = ROOT }
				}
				add_core = MS1
			}
		}
	}
}

#Spartan events
country_event = {
	id = nhs_mission_events.13
	title = nhs_mission_events.13.t
	desc = nhs_mission_events.13.d
	picture = Tenochtitlan_Expanded_eventPicture
	
	trigger = {
		nhs_condition_all_ely = { KOMANDA = tag }
		has_country_flag = nhs_expanding_north_completed
		NOT = { has_country_flag = nhs_gain_spartan_claims }
		NOT = { nhs_check_all_spartan = { CONDITION = exists } }
		any_province = {
			NOT = { is_core = ROOT }
			NOT = { owned_by = ROOT }
			NOT = { is_permanent_claim = ROOT }
			nhs_check_all_spartan = { CONDITION = is_core }
		}
	}
	
	immediate = {
		set_country_flag = nhs_gain_spartan_claims
	}

	option = { #The largest mosaics should show emperors/empressesm, +yearly_absolutism, legitimacy
		name = "nhs_mission_events.13.a"
		every_province = {
			limit = {
				nhs_check_all_spartan = { CONDITION = is_core }
				NOT = { is_core = ROOT }
				NOT = { owned_by = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
	}
}

#Europeans converting
country_event = {
	id = nhs_mission_events.17
	title = nhs_mission_events.17.t
	desc = nhs_mission_events.17.d
	picture = CITY_VIEW_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "nhs_mission_events.14.a"
		ai_chance = {
			factor = 80
			modifier = {
				factor = 0.5
				total_development = 150
			}
			modifier = {
				factor = 0.75
				total_development = 100
				NOT = { total_development = 150 }
			}
			modifier = {
				factor = 0.6
				total_development = 50
				NOT = { total_development = 100 }
			}
			modifier = {
				factor = 0.6
				NOT = { total_development = 50 }
			}
			modifier = {
				factor = 5
				any_country = {
					tag = ROOT
					reverse_has_opinion = { who = ROOT value = 200 }
				}
			}
			modifier = {
				factor = 3
				any_country = {
					tag = ROOT
					reverse_has_opinion = { who = ROOT value = 150 }
				}
			}
			modifier = {
				factor = 2
				any_country = {
					tag = ROOT
					reverse_has_opinion = { who = ROOT value = 100 }
				}
			}
			modifier = {
				factor = 1.5
				any_country = {
					tag = ROOT
					reverse_has_opinion = { who = ROOT value = 50 }
				}
			}
		}
		change_religion = elysian_orthodoxy
		capital_scope = {
			change_religion = ROOT
		}
		every_country = {
			limit = {
				is_subject_of = ROOT
			}
			change_religion = elysian_orthodoxy
			hidden_effect = {
				capital_scope = {
					change_religion = ROOT
				}
				every_owned_province = {
					limit = {
						religion_group = christian
						NOT = { development = 10 }
					}
					random = {
						chance = 80
						change_religion = elysian_orthodoxy
					}
				}
				every_owned_province = {
					limit = {
						religion_group = christian
						development = 10
						NOT = { development = 20 }
					}
					random = {
						chance = 60
						change_religion = elysian_orthodoxy
					}
				}
				every_owned_province = {
					limit = {
						religion_group = christian
						development = 20
						NOT = { development = 30 }
					}
					random = {
						chance = 40
						change_religion = elysian_orthodoxy
					}
				}
				every_owned_province = {
					limit = {
						religion_group = christian
						development = 30
						NOT = { development = 40 }
					}
					random = {
						chance = 20
						change_religion = elysian_orthodoxy
					}
				}
			}
		}
		hidden_effect = {
			every_owned_province = {
				limit = {
					religion_group = christian
					NOT = { development = 10 }
				}
				random = {
					chance = 80
					change_religion = elysian_orthodoxy
				}
			}
			every_owned_province = {
				limit = {
					religion_group = christian
					development = 10
					NOT = { development = 20 }
				}
				random = {
					chance = 60
					change_religion = elysian_orthodoxy
				}
			}
			every_owned_province = {
				limit = {
					religion_group = christian
					development = 20
					NOT = { development = 30 }
				}
				random = {
					chance = 40
					change_religion = elysian_orthodoxy
				}
			}
			every_owned_province = {
				limit = {
					religion_group = christian
					development = 30
					NOT = { development = 40 }
				}
				random = {
					chance = 20
					change_religion = elysian_orthodoxy
				}
			}
		}
	}
	option = {
		name = "nhs_mission_events.14.a"
		ai_chance = {
			factor = 20
			modifier = {
				factor = 2
				total_development = 150
			}
			modifier = {
				factor = 1.2
				total_development = 100
				NOT = { total_development = 150 }
			}
			modifier = {
				factor = 2
				any_country = {
					tag = ROOT
					NOT = { reverse_has_opinion = { who = ROOT value = 0 } }
				}
			}
			modifier = {
				factor = 3
				any_country = {
					tag = ROOT
					NOT = { reverse_has_opinion = { who = ROOT value = 50 } }
				}
			}
			modifier = {
				factor = 4
				any_country = {
					tag = ROOT
					NOT = { reverse_has_opinion = { who = ROOT value = 100 } }
				}
			}
			modifier = {
				factor = 5
				any_country = {
					tag = ROOT
					NOT = { reverse_has_opinion = { who = ROOT value = 150 } }
				}
			}
			modifier = {
				factor = 10
				any_country = {
					tag = ROOT
					NOT = { reverse_has_opinion = { who = ROOT value = 190 } }
				}
			}
		}
	}
}

# Lose the modifier nhs_handicap_settlers, which is always given to Elysia
# country_event = {
# 	id = nhs_mission_events.18
# 	title = nhs_mission_events.18.t
# 	desc = nhs_mission_events.18.d
# 	picture = ATHENS_eventPicture

# 	fire_only_once = yes
	
# 	trigger = {
# 		nhs_condition_all_ely = { KOMANDA = tag }
# 		ai = no
# 		mission_completed = nhs_reestablish_merchant_class_mission
# 		mission_completed = nhs_build_army_mission
# 		mission_completed = nhs_farming_mission
# 		NOT = { has_country_flag = nhs_settled_mission }
# 		if = {
# 			limit = {
# 				check_variable = {
# 					which = nhs_early_missions_completed
# 					value = 8
# 				}
# 			}
# 			to_ely_true_nation_mission_trigger_year = { YEAR = 1480 }
# 		}
# 		else_if = {
# 			limit = {
# 				check_variable = {
# 					which = nhs_early_missions_completed
# 					value = 7
# 				}
# 			}
# 			to_ely_true_nation_mission_trigger_year = { YEAR = 1485 }
# 		}
# 		else_if = {
# 			limit = {
# 				check_variable = {
# 					which = nhs_early_missions_completed
# 					value = 6
# 				}
# 			}
# 			to_ely_true_nation_mission_trigger_year = { YEAR = 1490 }
# 		}
# 		else_if = {
# 			limit = {
# 				check_variable = {
# 					which = nhs_early_missions_completed
# 					value = 5
# 				}
# 			}
# 			to_ely_true_nation_mission_trigger_year = { YEAR = 1495 }
# 		}
# 		else_if = {
# 			limit = {
# 				check_variable = {
# 					which = nhs_early_missions_completed
# 					value = 4
# 				}
# 			}
# 			to_ely_true_nation_mission_trigger_year = { YEAR = 1500 }
# 		}
# 		else_if = {
# 			limit = {
# 				check_variable = {
# 					which = nhs_early_missions_completed
# 					value = 3
# 				}
# 			}
# 			to_ely_true_nation_mission_trigger_year = { YEAR = 1505 }
# 		}
# 		else_if = {
# 			limit = {
# 				check_variable = {
# 					which = nhs_early_missions_completed
# 					value = 2
# 				}
# 			}
# 			to_ely_true_nation_mission_trigger_year = { YEAR = 1510 }
# 		}
# 		else_if = {
# 			limit = {
# 				check_variable = {
# 					which = nhs_early_missions_completed
# 					value = 1
# 				}
# 			}
# 			to_ely_true_nation_mission_trigger_year = { YEAR = 1515 }
# 		}
# 		else = {
# 			to_ely_true_nation_mission_trigger_year = { YEAR = 1520 }
# 		}
# 	}
	
# 	immediate = {
# 		set_country_flag = nhs_settled_mission
# 	}

# 	option = {
# 		name = "nhs_mission_events.18.a"
# 		complete_mission = nhs_settling_mission
# 		custom_tooltip = nhs_new_line_tt
# 		if = {
# 			limit = {
# 				has_country_modifier = nhs_handicap_settlers
# 			}
# 			nhs_settled_mission_effect = yes
# 		}
# 	}
# }

###################################################
### ARCHIVED
###################################################

# Securing Chesapeake Bay, can demand toll - only when 953 is original capital
## NOW DIRECTLY PART OF THE MISSION control_the_elysian_homelands
# country_event = {
# 	id = nhs_countryevents.2
# 	title = nhs_countryevents.2.t
# 	desc = nhs_countryevents.2.d
# 	picture = HARBOUR_eventPicture
	
# 	fire_only_once = yes

#     trigger = {
# 		nhs_condition_all_ely = { KOMANDA = tag }
# 		owns = 950 # Chesapeake
# 		chesapeake_area = {
# 			type = all
# 			is_city = yes
# 			country_or_non_sovereign_subject_holds = ROOT
# 		}
# 		950 = { NOT = { has_province_modifier = nhs_toll_modifier_tm } }
# 		NOT = { has_country_modifier = nhs_no_merchant_class }
# 	}

# 	mean_time_to_happen = {
# 		months = 1
# 	}

# 	option = {
# 		name = "NHSCOUNTRYEVENTSNAME2"
# 		add_years_of_income = 0.2
# 		add_dip_power = 25
# 		950 = {
# 			add_base_tax = 1
# 			add_base_production = 2
# 			tooltip = {
# 				add_permanent_province_modifier = {
# 					name = "nhs_toll_modifier"
# 					duration = -1
# 				}
# 			}
# 			hidden_effect = {
# 				add_province_triggered_modifier = nhs_toll_modifier_tm
# 			}
# 			set_province_flag = nhs_original_heartland
# 		}
# 		# Rename sea area
# 		if = {
# 			limit = {
# 				NOT = { religion = pantheon_worship }
# 				NOT = { religion = aztlan_worship }
# 			}
# 			1501 = { change_province_name = "Elysian Coast" }
# 		}
# 		else = {
# 			1501 = { change_province_name = "Neptuno Adventus" }
# 		}
# 		5377 = { change_province_name = "Elysian Bay" }
# 		1500 = { change_province_name = "Bay of Methenai" }
# 	}
# }

#Sets nobility land
country_event = {
	id = nhs_mission_events.15
	title = nhs2_hidden.t
	desc = nhs2_hidden.d
	picture = Tenochtitlan_Expanded_eventPicture
	
	is_triggered_only = yes
	hidden = yes
	
	immediate = {
		FROM = {
			if = {
				limit = {
					has_country_flag = nhs_setting_nhs_noble_land
					has_estate = estate_nhs_nobles
				}
				clr_country_flag = nhs_setting_nhs_noble_land
				change_estate_land_share = {
					estate = estate_nhs_nobles
					share = -100
				}
				change_estate_land_share = {
					estate = estate_nhs_nobles
					share = 20
				}
			}
		}
	}

	option = {
		name = nhs2_hidden.a
		FROM = {
			if = {
				limit = {
					has_country_flag = nhs_setting_nhs_noble_land
					has_estate = estate_nhs_nobles
				}
				clr_country_flag = nhs_setting_nhs_noble_land
				change_estate_land_share = {
					estate = estate_nhs_nobles
					share = -100
				}
				change_estate_land_share = {
					estate = estate_nhs_nobles
					share = 20
				}
			}
		}
	}
}