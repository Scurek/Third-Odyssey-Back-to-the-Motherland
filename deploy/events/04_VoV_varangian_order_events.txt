namespace = nhs_vov_varangian_order_events

#Varangian Order Formed (elysia)
country_event = {
	id = nhs_vov_varangian_order_events.1
	title = nhs_vov_varangian_order_events.1.t
	desc = nhs_vov_varangian_order_events.1.d
	picture = varangian_offers_service_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		nhs_condition_all_ely = { KOMANDA = tag }
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.1.a"
	}
}
#Varangian Order Formed (norse colonies)
country_event = {
	id = nhs_vov_varangian_order_events.2
	title = nhs_vov_varangian_order_events.1.t
	desc = nhs_vov_varangian_order_events.2.d
	picture = varangian_offers_service_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			tag = HLL
			tag = MK1
			tag = JOM
			tag = VIN
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.2.a"
	}
}
#Varangian Order Formed (everyone else)
country_event = {
	id = nhs_vov_varangian_order_events.3
	title = nhs_vov_varangian_order_events.1.t
	desc = nhs_vov_varangian_order_events.3.d
	picture = varangian_offers_service_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			tag = HLL
			tag = MK1
			tag = JOM
			tag = VIN
		}
		capital_scope = {
			continent = north_america	
		}
		knows_country = VGD
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.3.a"
	}
}
#Varangian Order Formed (Varangian Order)
country_event = {
	id = nhs_vov_varangian_order_events.4
	title = nhs_vov_varangian_order_events.1.t
	desc = nhs_vov_varangian_order_events.4.d
	picture = varangian_offers_service_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			tag = VGD
		}
		always = no
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.3.a"
		
	}
}

#Transfer provinces to Elysia
country_event = {
	id = nhs_vov_varangian_order_events.5
	title = nhs_vov_varangian_order_events.5.t
	desc = nhs_vov_varangian_order_events.5.d
	picture = norse_party_eventPicture
	
	trigger = {
		OR = {
			nhs_is_elysia_late = yes
			tag = NHS
		}
		VGD = {
			is_subject_of = ROOT
			OR = {
				AND = {
					any_owned_province = {
						is_capital = no
					}
					ROOT = {
						OR = {
							NOT = { has_country_flag = nhs_var_area }
							has_country_flag = nhs_v_settled_on_malta
						}
					}
				}
				AND = {
					any_owned_province = {
						NOT = {
							any_province = {
								is_capital = yes
								area = PREV
								owned_by = VGD
							}
						}
					}
					ROOT = {
						has_country_flag = nhs_var_area
						NOT = { has_country_flag = nhs_v_settled_on_malta }
					}
				}
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.5.a"
		every_province = {
			limit = {
				owner = {
					tag = VGD
				}
				OR = {
					AND = {
						is_capital = no
						ROOT = {
							OR = {
								NOT = { has_country_flag = nhs_var_area }
								has_country_flag = nhs_v_settled_on_malta
							}
						}
					}
					AND = {
						NOT = {
							any_province = {
								owned_by = VGD
								is_capital = yes
								area = PREV
							}
						}
						ROOT = {
							has_country_flag = nhs_var_area
							NOT = { has_country_flag = nhs_v_settled_on_malta }
						}
					}
				}
				is_capital = no
			}
			cede_province = ROOT
		}
	}
}

#Choose Varangian order place
country_event = {
	id = nhs_vov_varangian_order_events.6
	title = nhs_vov_varangian_order_events.6.t
	desc = nhs_vov_varangian_order_events.6.d
	picture = norse_colony_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "nhs_vov_varangian_order_events.14.e"
		trigger = {
			owns = 968
			NOT = { exists = VGD }
			968 = {
				NOT = { has_province_modifier = nhs2_albanian_majority }
				NOT = { has_province_modifier = nhs2_albanian_majority2 }
			}
		}
		tooltip = {
			968 = {
				cede_province = VGD
			}
			create_subject = {
				subject_type = elysian_subject_varangian
				subject = VGD
			}
		}
		if = {
			limit = {
				any_province = {
					has_province_modifier = nhs2_varangian_m
				}
			}
			every_province = {
				limit = {
					has_province_modifier = nhs2_varangian_m
				}
				remove_province_modifier = nhs2_varangian_m
			}
		}
		clr_country_flag = nhs_v_d_p
		set_country_flag = nhs_varangian_guard_substate
		if = {
			limit = {
				968 = {
					OR = {
						has_province_modifier = nhs2_european_enclave
						has_province_modifier = nhs2_small_por_enclave
						has_province_modifier = nhs2_por_enclave
						has_province_modifier = nhs2_large_por_enclave
					}
				}
			}
			968 = {
				nhs_move_t_post = yes
			}
		}
		
		hidden_effect = {
			968 = {
				add_core = VGD
				ROOT = {
					release = VGD
				}
				change_culture = varangian_n
				change_religion = ROOT
				#if = {
				#	limit = {
				#		is_core = ROOT
				#	}
				#	remove_core = ROOT
				#}
				VGD = {
					set_capital = 968
					change_religion = ROOT
					change_primary_culture = varangian_n
					hidden_effect = {
						nhs_change_government = { GOV = varangian_order_gov }
					}
					nhs_add_gov_reform = { REF = varangian_guard }
				}
			}
			every_province = {
				limit = {
					has_discovered = ROOT
				}
				discover_country = VGD
			}
			VGD = {
				if = {
					limit = {
						technology_group = exiled_greek
					}
					change_technology_group = viking
				}
				else_if = {
					limit = {
						technology_group = modern_greek
					}
					change_technology_group = modern_vinlandic
				}
			}
			create_subject = {
				subject_type = elysian_subject_varangian
				subject = VGD
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.c"
		trigger = {
			owns = 2010
			NOT = { exists = VGD }
			2010 = {
				NOT = { has_province_modifier = nhs2_albanian_majority }
				NOT = { has_province_modifier = nhs2_albanian_majority2 }
			}
		}
		tooltip = {
			2010 = {
				cede_province = VGD
			}
			create_subject = {
				subject_type = elysian_subject_varangian
				subject = VGD
			}
		}
		if = {
			limit = {
				any_province = {
					has_province_modifier = nhs2_varangian_m
				}
			}
			every_province = {
				limit = {
					has_province_modifier = nhs2_varangian_m
				}
				remove_province_modifier = nhs2_varangian_m
			}
		}
		set_country_flag = nhs_varangian_guard_substate
		clr_country_flag = nhs_v_d_p
		if = {
			limit = {
				2010 = {
					OR = {
						has_province_modifier = nhs2_european_enclave
						has_province_modifier = nhs2_small_por_enclave
						has_province_modifier = nhs2_por_enclave
						has_province_modifier = nhs2_large_por_enclave
					}
				}
			}
			2010 = {
				nhs_move_t_post = yes
			}
		}
		hidden_effect = {
			2010 = {
				add_core = VGD
				ROOT = {
					release = VGD
				}
				change_culture = varangian_n
				change_religion = ROOT
				#if = {
				#	limit = {
				#		is_core = ROOT
				#	}
				#	remove_core = ROOT
				#}
				VGD = {
					set_capital = 2010
					change_religion = ROOT
					change_primary_culture = varangian_n
					hidden_effect = {
						nhs_change_government = { GOV = varangian_order_gov }
					}
					nhs_add_gov_reform = { REF = varangian_guard }
				}
			}
			every_province = {
				limit = {
					has_discovered = ROOT
				}
				discover_country = VGD
			}
			VGD = {
				if = {
					limit = {
						technology_group = exiled_greek
					}
					change_technology_group = viking
					
				}
				else_if = {
					limit = {
						technology_group = modern_greek
					}
					change_technology_group = modern_vinlandic
				}
			}
			create_subject = {
				subject_type = elysian_subject_varangian
				subject = VGD
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.b"
		trigger = {
			owns = 965
			NOT = { exists = VGD }
			965 = {
				NOT = { has_province_modifier = nhs2_albanian_majority }
				NOT = { has_province_modifier = nhs2_albanian_majority2 }
			}
		}
		set_country_flag = nhs_varangian_guard_substate
		tooltip = {
			965 = {
				cede_province = VGD
			}
			create_subject = {
				subject_type = elysian_subject_varangian
				subject = VGD
			}
		}
		if = {
			limit = {
				any_province = {
					has_province_modifier = nhs2_varangian_m
				}
			}
			every_province = {
				limit = {
					has_province_modifier = nhs2_varangian_m
				}
				remove_province_modifier = nhs2_varangian_m
			}
		}
		clr_country_flag = nhs_v_d_p
		if = {
			limit = {
				965 = {
					OR = {
						has_province_modifier = nhs2_european_enclave
						has_province_modifier = nhs2_small_por_enclave
						has_province_modifier = nhs2_por_enclave
						has_province_modifier = nhs2_large_por_enclave
					}
				}
			}
			965 = {
				nhs_move_t_post = yes
			}
		}
		hidden_effect = {
			965 = {
				add_core = VGD
				ROOT = {
					release = VGD
				}
				change_culture = varangian_n
				change_religion = ROOT
				#if = {
				#	limit = {
				#		is_core = ROOT
				#	}
				#	remove_core = ROOT
				#}
				VGD = {
					set_capital = 965
					change_religion = ROOT
					change_primary_culture = varangian_n
					hidden_effect = {
						nhs_change_government = { GOV = varangian_order_gov }
					}
					nhs_add_gov_reform = { REF = varangian_guard }
				}
			}
			every_province = {
				limit = {
					has_discovered = ROOT
				}
				discover_country = VGD
			}
			VGD = {
				if = {
					limit = {
						technology_group = exiled_greek
					}
					change_technology_group = viking
				}
				else_if = {
					limit = {
						technology_group = modern_greek
					}
					change_technology_group = modern_vinlandic
				}
			}
			create_subject = {
				subject_type = elysian_subject_varangian
				subject = VGD
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.a"
		trigger = {
			owns = 962
			NOT = { exists = VGD }
			962 = {
				NOT = { has_province_modifier = nhs2_albanian_majority }
				NOT = { has_province_modifier = nhs2_albanian_majority2 }
			}
		}
		tooltip = {
			962 = {
				cede_province = VGD
			}
			create_subject = {
				subject_type = elysian_subject_varangian
				subject = VGD
			}
		}
		if = {
			limit = {
				any_province = {
					has_province_modifier = nhs2_varangian_m
				}
			}
			every_province = {
				limit = {
					has_province_modifier = nhs2_varangian_m
				}
				remove_province_modifier = nhs2_varangian_m
			}
		}
		set_country_flag = nhs_varangian_guard_substate
		clr_country_flag = nhs_v_d_p
		if = {
			limit = {
				962 = {
					OR = {
						has_province_modifier = nhs2_european_enclave
						has_province_modifier = nhs2_small_por_enclave
						has_province_modifier = nhs2_por_enclave
						has_province_modifier = nhs2_large_por_enclave
					}
				}
			}
			962 = {
				nhs_move_t_post = yes
			}
		}
		
		hidden_effect = {
			962 = {
				add_core = VGD
				ROOT = {
					release = VGD
				}
				change_culture = varangian_n
				change_religion = ROOT
				#if = {
				#	limit = {
				#		is_core = ROOT
				#	}
				#	remove_core = ROOT
				#}
				VGD = {
					set_capital = 962
					change_religion = ROOT
					change_primary_culture = varangian_n
					hidden_effect = {
						nhs_change_government = { GOV = varangian_order_gov }
					}
					nhs_add_gov_reform = { REF = varangian_guard }
				}
			}
			every_province = {
				limit = {
					has_discovered = ROOT
				}
				discover_country = VGD
			}
			VGD = {
				if = {
					limit = {
						technology_group = exiled_greek
					}
					change_technology_group = viking
					
				}
				else_if = {
					limit = {
						technology_group = modern_greek
					}
					change_technology_group = modern_vinlandic
				}
			}
			create_subject = {
				subject_type = elysian_subject_varangian
				subject = VGD
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.6.f"
		trigger = {
			NOT = { exists = VGD }
			OR = {
				NOT = { owns = 962 }
				962 = {
					OR = {
						has_province_modifier = nhs2_albanian_majority
						has_province_modifier = nhs2_albanian_majority2
					}
				}
			}
			OR = {
				NOT = { owns = 965 }
				965 = {
					OR = {
						has_province_modifier = nhs2_albanian_majority
						has_province_modifier = nhs2_albanian_majority2
					}
				}
			}
			OR = {
				NOT = { owns = 2010 }
				2010 = {
					OR = {
						has_province_modifier = nhs2_albanian_majority
						has_province_modifier = nhs2_albanian_majority2
					}
				}
			}
			OR = {
				NOT = { owns = 968 }
				968 = {
					OR = {
						has_province_modifier = nhs2_albanian_majority
						has_province_modifier = nhs2_albanian_majority2
					}
				}
			}
		}
		set_country_flag = nhs_varangian_guard_substate
		if = {
			limit = {
				any_owned_province = {
					region = northeast_america_region
					NOT = { nhs_homelands = yes }
					NOT = { has_province_modifier = nhs2_albanian_majority }
					NOT = { has_province_modifier = nhs2_albanian_majority2 }
					has_port = yes
					NOT = {
						OR = {
							has_province_modifier = nhs2_european_enclave
							has_province_modifier = nhs2_small_por_enclave
							has_province_modifier = nhs2_por_enclave
							has_province_modifier = nhs2_large_por_enclave
						}
					}
				}
			}
			random_owned_province = {
				limit = {
					region = northeast_america_region
					NOT = { nhs_homelands = yes }
					NOT = { has_province_modifier = nhs2_albanian_majority }
					NOT = { has_province_modifier = nhs2_albanian_majority2 }
					has_port = yes
					NOT = {
						OR = {
							has_province_modifier = nhs2_european_enclave
							has_province_modifier = nhs2_small_por_enclave
							has_province_modifier = nhs2_por_enclave
							has_province_modifier = nhs2_large_por_enclave
						}
					}
				}
				tooltip = {
					cede_province = VGD
				}
				set_province_flag = nhs_varangian_target
			}
		}
		else_if = {
			limit = {
				any_owned_province = {
					region = northeast_america_region
					NOT = { nhs_homelands = yes }
					NOT = { has_province_modifier = nhs2_albanian_majority }
					NOT = { has_province_modifier = nhs2_albanian_majority2 }
					NOT = {
						OR = {
							has_province_modifier = nhs2_european_enclave
							has_province_modifier = nhs2_small_por_enclave
							has_province_modifier = nhs2_por_enclave
							has_province_modifier = nhs2_large_por_enclave
						}
					}
				}
			}
			random_owned_province = {
				limit = {
					region = northeast_america_region
					NOT = { nhs_homelands = yes }
					NOT = { has_province_modifier = nhs2_albanian_majority }
					NOT = { has_province_modifier = nhs2_albanian_majority2 }
					NOT = {
						OR = {
							has_province_modifier = nhs2_european_enclave
							has_province_modifier = nhs2_small_por_enclave
							has_province_modifier = nhs2_por_enclave
							has_province_modifier = nhs2_large_por_enclave
						}
					}
				}
				tooltip = {
					cede_province = VGD
				}
				set_province_flag = nhs_varangian_target
			}
		}
		else = {
			random_owned_province = {
				limit = {
					region = northeast_america_region
					NOT = { nhs_homelands = yes }
					NOT = { has_province_modifier = nhs2_albanian_majority }
					NOT = { has_province_modifier = nhs2_albanian_majority2 }
				}
				tooltip = {
					cede_province = VGD
				}
				set_province_flag = nhs_varangian_target
			}
		}
		tooltip = {
			#random_owned_province = {
			#	limit = {
			#		has_province_flag = nhs_varangian_target
			#	}
			#	cede_province = VGD
			#}
			create_subject = {
				subject_type = elysian_subject_varangian
				subject = VGD
			}
		}
		if = {
			limit = {
				any_province = {
					has_province_modifier = nhs2_varangian_m
				}
			}
			every_province = {
				limit = {
					has_province_modifier = nhs2_varangian_m
				}
				remove_province_modifier = nhs2_varangian_m
			}
		}
		clr_country_flag = nhs_v_d_p
		if = {
			limit = {
				any_owned_province = {
					OR = {
						has_province_modifier = nhs2_european_enclave
						has_province_modifier = nhs2_small_por_enclave
						has_province_modifier = nhs2_por_enclave
						has_province_modifier = nhs2_large_por_enclave
					}
					has_province_flag = nhs_varangian_target
				}
			}
			random_owned_province = {
				limit = {
					OR = {
						has_province_modifier = nhs2_european_enclave
						has_province_modifier = nhs2_small_por_enclave
						has_province_modifier = nhs2_por_enclave
						has_province_modifier = nhs2_large_por_enclave
					}
					has_province_flag = nhs_varangian_target
				}
				nhs_move_t_post = yes
			}
		}
		hidden_effect = {
			random_owned_province = {
				limit = {
					has_province_flag = nhs_varangian_target
				}
				add_core = VGD
				ROOT = {
					release = VGD
				}
				change_culture = varangian_n
				change_religion = ROOT
				#if = {
				#	limit = {
				#		is_core = ROOT
				#	}
				#	remove_core = ROOT
				#}
				VGD = {
					change_religion = ROOT
					change_primary_culture = varangian_n
					hidden_effect = {
						nhs_change_government = { GOV = varangian_order_gov }
					}
					nhs_add_gov_reform = { REF = varangian_guard }
				}
			}
			every_province = {
				limit = {
					has_discovered = ROOT
				}
				discover_country = VGD
			}
			VGD = {
				if = {
					limit = {
						technology_group = exiled_greek
					}
					change_technology_group = viking
					
				}
				else_if = {
					limit = {
						technology_group = modern_greek
					}
					change_technology_group = modern_vinlandic
				}
			}
			create_subject = {
				subject_type = elysian_subject_varangian
				subject = VGD
			}
		}
		every_province = {
			limit = {
				has_province_flag = nhs_varangian_target
			}
			clr_province_flag = nhs_varangian_target
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.6.g"
		trigger = {
			NOT = { has_country_flag = nhs_varangian_crysis }
		}
		add_treasury = 100
		clr_country_flag = nhs_v_d_p
	}
}

#Fix
country_event = {
	id = nhs_vov_varangian_order_events.7
	title = nhs_vov_varangian_order_events.7.t
	desc = nhs_vov_varangian_order_events.7.d
	picture = varangian_offers_service_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	trigger = {
		OR = {
			nhs_is_elysia_late = yes
			tag = NHS
		}
		exists = VGD
		any_province = {
			has_province_modifier = nhs2_varangian_m
		}
	}
	
	immediate = {
		every_province = {
			limit = {
				has_province_modifier = nhs2_varangian_m
			}
			remove_province_modifier = nhs2_varangian_m
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.3.a"
		
	}
}

#Creation of Varangian Order
country_event = {
	id = nhs_vov_varangian_order_events.8
	title = nhs_vov_varangian_order_events.8.t
	desc = nhs_vov_varangian_order_events.8.d
	picture = varangian_offers_service_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		OR = {
			nhs_is_elysia_late = yes
			tag = NHS
		}
		is_year = 1451
		OR = {
			NOT = { has_global_flag = nhs_started_at_bookmark }
			is_year = 1481
		}
		any_known_country = {
			has_country_flag = nhs_met_greeks
			OR = {
				tag = VIN
				tag = MK1
				tag = HLL
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.8.a"
		ai_chance = {
			factor = 80
		}
		set_country_flag = established_varangians
		if = {
			limit = {
				ai = no
			}
			add_treasury = -50
		}
		capital_scope = {
			add_province_modifier = {
				name = nhs2_varangian_m
				duration = -1
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.8.b"
		ai_chance = {
			factor = 20
		}
		add_army_tradition = 10
		add_prestige = 5
	}
}

#Varangians gain influence
country_event = {
	id = nhs_vov_varangian_order_events.9
	title = nhs_vov_varangian_order_events.9.t
	desc = nhs_vov_varangian_order_events.9.d
	picture = basileus_and_varangians_eventPciture
	
	fire_only_once = yes
	
	trigger = {
		OR = {
			nhs_is_elysia_late = yes
			tag = NHS
		}
		is_year = 1476
		had_country_flag = { flag = established_varangians days = 7300 }
		has_country_flag = established_varangians
		any_owned_province = {
			has_province_modifier = nhs2_varangian_m
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.9.a"
		ai_chance = {
			factor = 80
		}
		add_country_modifier = {
			name = nhs2_varangian_influnce_m
			duration = -1
		}
		tooltip = {
			add_estate_influence_modifier = {
				estate = estate_nhs_nobles
				desc = EST_VAL_V_INFLUENCE
				influence = -10
				duration = -1
			}
		}
	}
}

#Varangians demand estates
country_event = {
	id = nhs_vov_varangian_order_events.10
	title = nhs_vov_varangian_order_events.10.t
	desc = nhs_vov_varangian_order_events.10.d
	picture = varangian_offers_service_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		NOT = { has_country_flag = nhs_v_settled_on_malta }
		OR = {
			nhs_is_elysia_late = yes
			tag = NHS
		}
		NOT = { exists = VGD }
		is_year = 1501
		has_country_flag = established_varangians
		has_country_modifier = nhs2_varangian_influnce_m
		NOT = { has_country_flag = nhs_varangian_guard_substate }
		NOT = { has_country_flag = nhs_disbanded_varangians }
		NOT = { has_country_flag = nhs_varangians_end }
		any_owned_province = {
			has_province_modifier = nhs2_varangian_m
		}
		is_at_war = no
		any_owned_province = {
			region = northeast_america_region
			NOT = { has_province_modifier = nhs2_albanian_majority }
			NOT = { has_province_modifier = nhs2_albanian_majority2 }
			NOT = { nhs_homelands = yes }
		}
		NOT = { has_country_flag = nhs_v_d_p }
		NOT = { exists = VGD }
	}
	
	immediate = {
		set_country_flag = nhs_varangian_estates
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.10.a"
		ai_chance = {
			factor = 100
		}
		if = {
			limit = {
				any_province = {
					has_province_modifier = nhs2_varangian_m
				}
			}
			every_province = {
				limit = {
					has_province_modifier = nhs2_varangian_m
				}
				remove_province_modifier = nhs2_varangian_m
			}
		}
		set_country_flag = nhs_varangian_crysis
		country_event = { id = nhs_vov_varangian_order_events.6 }
	}
	option = {
		name = "nhs_vov_varangian_order_events.10.b"
		set_country_flag = nhs_varangian_crysis
		set_country_flag = nhs_disbanded_varangians
		#set_country_flag = nhs_varangians_end
		remove_country_modifier = nhs2_varangian_influnce_m
		if = {
			limit = {
				any_province = {
					has_province_modifier = nhs2_varangian_m
				}
			}
			every_province = {
				limit = {
					has_province_modifier = nhs2_varangian_m
				}
				remove_province_modifier = nhs2_varangian_m
			}
		}
		ai_chance = {
			factor = 1
		}
		capital_scope = {
			particularist_rebels = 1
		}
		random = {
			chance = 50
			kill_ruler = yes
		}
		if = {
			limit = {
				any_province = {
					is_empty = yes
					region = northeast_america_region
					has_port = yes
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
			}
			custom_tooltip = nhs_varangians_independant_tt
			random_province = {
				limit = {
					is_empty = yes
					region = northeast_america_region
					has_port = yes
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
				hidden_effect = {
					cede_province = ROOT
					change_religion = norse_pagan_reformed
					change_culture = varangian_n
					add_core = VGD
					ROOT = { release = VGD }
					VGD = {
						change_religion = norse_pagan_reformed
						change_primary_culture = varangian_n
						hidden_effect = {
							nhs_change_government = { GOV = varangian_order_gov }
						}
						nhs_add_gov_reform = { REF = varangian_guard }
					}
				}
				tooltip = {
					cede_province = VGD
				}
			}
		}
		else_if = {
			limit = {
				any_province = {
					is_empty = yes
					region = northeast_america_region
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
			}
			custom_tooltip = nhs_varangians_independant_tt
			random_province = {
				limit = {
					is_empty = yes
					region = northeast_america_region
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
				hidden_effect = {
					cede_province = ROOT
					change_religion = norse_pagan_reformed
					change_culture = varangian_n
					add_core = VGD
					ROOT = { release = VGD }
					VGD = {
						change_religion = norse_pagan_reformed
						change_primary_culture = varangian_n
						hidden_effect = {
							nhs_change_government = { GOV = varangian_order_gov }
						}
						nhs_add_gov_reform = { REF = varangian_guard }
					}
				}
				tooltip = {
					cede_province = VGD
				}
			}
		}
		else_if = {
			limit = {
				any_province = {
					is_empty = yes
					has_port = yes
					region = great_lakes_region
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
			}
			custom_tooltip = nhs_varangians_independant_tt
			random_province = {
				limit = {
					is_empty = yes
					has_port = yes
					region = great_lakes_region
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
				hidden_effect = {
					cede_province = ROOT
					change_religion = norse_pagan_reformed
					change_culture = varangian_n
					add_core = VGD
					ROOT = { release = VGD }
					VGD = {
						change_religion = norse_pagan_reformed
						change_primary_culture = varangian_n
						hidden_effect = {
							nhs_change_government = { GOV = varangian_order_gov }
						}
						nhs_add_gov_reform = { REF = varangian_guard }
					}
				}
				tooltip = {
					cede_province = VGD
				}
			}
		}
		else_if = {
			limit = {
				any_province = {
					is_empty = yes
					region = great_lakes_region
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
			}
			custom_tooltip = nhs_varangians_independant_tt
			random_province = {
				limit = {
					is_empty = yes
					region = great_lakes_region
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
				hidden_effect = {
					cede_province = ROOT
					change_religion = norse_pagan_reformed
					change_culture = varangian_n
					add_core = VGD
					ROOT = { release = VGD }
					VGD = {
						change_religion = norse_pagan_reformed
						change_primary_culture = varangian_n
						hidden_effect = {
							nhs_change_government = { GOV = varangian_order_gov }
						}
						nhs_add_gov_reform = { REF = varangian_guard }
					}
				}
				tooltip = {
					cede_province = VGD
				}
			}
		}
	}
	option = {
		name = "nhs_vov_varangian_order_events.10.c"
		ai_chance = {
			factor = 0
		}
		if = {
			limit = {
				NOT = { monthly_income = 21 }
			}
			add_treasury = -100
		}
		else_if = {
			limit = {
				NOT = { monthly_income = 104 }
			}
			add_years_of_income = -0.4
		}
		else = {
			add_treasury = -500
		}
		set_country_flag = nhs_delayed_varangians
	}
}

#Varangians demand estates delayed
country_event = {
	id = nhs_vov_varangian_order_events.11
	title = nhs_vov_varangian_order_events.11.t
	desc = nhs_vov_varangian_order_events.11.d
	picture = varangian_offers_service_eventPicture
	
	trigger = {
		NOT = { has_country_flag = nhs_v_settled_on_malta }
		OR = {
			nhs_is_elysia_late = yes
			tag = NHS
		}
		had_country_flag = { flag = nhs_delayed_varangians days = 3650 }
		has_country_flag = established_varangians
		has_country_modifier = nhs2_varangian_influnce_m
		NOT = { has_country_flag = nhs_varangian_crysis }
		NOT = { has_country_flag = nhs_disbanded_varangians }
		NOT = { has_country_flag = nhs_varangians_end }
		NOT = { has_country_flag = nhs_varangian_guard_substate }
		any_owned_province = {
			has_province_modifier = nhs2_varangian_m
		}
		is_at_war = no
		NOT = { exists = VGD }
		any_owned_province = {
			region = northeast_america_region
			NOT = { has_province_modifier = nhs2_albanian_majority }
			NOT = { has_province_modifier = nhs2_albanian_majority2 }
			NOT = { nhs_homelands = yes }
		}
	}
	
	immediate = {
		clr_country_flag = nhs_delayed_varangians
		set_country_flag = nhs_delayed_varangians
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.11.a"
		ai_chance = {
			factor = 100
		}
		set_country_flag = nhs_varangian_crysis
		country_event = { id = nhs_vov_varangian_order_events.6 }
		if = {
			limit = {
				any_province = {
					has_province_modifier = nhs2_varangian_m
				}
			}
			every_province = {
				limit = {
					has_province_modifier = nhs2_varangian_m
				}
				remove_province_modifier = nhs2_varangian_m
			}
		}
	}
	option = {
		name = "nhs_vov_varangian_order_events.11.b"
		set_country_flag = nhs_varangian_crysis
		set_country_flag = nhs_disbanded_varangians
		#set_country_flag = nhs_varangians_end
		remove_country_modifier = nhs2_varangian_influnce_m
		if = {
			limit = {
				any_province = {
					has_province_modifier = nhs2_varangian_m
				}
			}
			every_province = {
				limit = {
					has_province_modifier = nhs2_varangian_m
				}
				remove_province_modifier = nhs2_varangian_m
			}
		}
		ai_chance = {
			factor = 1
		}
		capital_scope = {
			particularist_rebels = 1
		}
		if = {
			limit = {
				any_owned_province = {
					nhs_homelands = yes
					NOT = { is_capital = yes }
				}
			}
			random_owned_province = {
				limit = {
					nhs_homelands = yes
					NOT = { is_capital = yes }
				}
				particularist_rebels = 1
			}
			
		}
		else = {
			capital_scope = {
				particularist_rebels = 1
			}
		}
		random = {
			chance = 50
			kill_ruler = yes
		}
		if = {
			limit = {
				any_province = {
					is_empty = yes
					region = northeast_america_region
					has_port = yes
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
			}
			custom_tooltip = nhs_varangians_independant_tt
			random_province = {
				limit = {
					is_empty = yes
					region = northeast_america_region
					has_port = yes
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
				hidden_effect = {
					cede_province = ROOT
					change_religion = norse_pagan_reformed
					change_culture = varangian_n
					add_core = VGD
					ROOT = { release = VGD }
					VGD = {
						change_religion = norse_pagan_reformed
						change_primary_culture = varangian_n
						hidden_effect = {
							nhs_change_government = { GOV = varangian_order_gov }
						}
						nhs_add_gov_reform = { REF = varangian_guard }
					}
				}
				tooltip = {
					cede_province = VGD
				}
			}
		}
		else_if = {
			limit = {
				any_province = {
					is_empty = yes
					region = northeast_america_region
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
			}
			custom_tooltip = nhs_varangians_independant_tt
			random_province = {
				limit = {
					is_empty = yes
					region = northeast_america_region
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
				hidden_effect = {
					cede_province = ROOT
					change_religion = norse_pagan_reformed
					change_culture = varangian_n
					add_core = VGD
					ROOT = { release = VGD }
					VGD = {
						change_religion = norse_pagan_reformed
						change_primary_culture = varangian_n
						hidden_effect = {
							nhs_change_government = { GOV = varangian_order_gov }
						}
						nhs_add_gov_reform = { REF = varangian_guard }
					}
				}
				tooltip = {
					cede_province = VGD
				}
			}
		}
		else_if = {
			limit = {
				any_province = {
					is_empty = yes
					has_port = yes
					region = great_lakes_region
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
			}
			custom_tooltip = nhs_varangians_independant_tt
			random_province = {
				limit = {
					is_empty = yes
					has_port = yes
					region = great_lakes_region
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
				hidden_effect = {
					cede_province = ROOT
					change_religion = norse_pagan_reformed
					change_culture = varangian_n
					add_core = VGD
					ROOT = { release = VGD }
					VGD = {
						change_religion = norse_pagan_reformed
						change_primary_culture = varangian_n
						hidden_effect = {
							nhs_change_government = { GOV = varangian_order_gov }
						}
						nhs_add_gov_reform = { REF = varangian_guard }
					}
				}
				tooltip = {
					cede_province = VGD
				}
			}
		}
		else_if = {
			limit = {
				any_province = {
					is_empty = yes
					region = great_lakes_region
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
			}
			custom_tooltip = nhs_varangians_independant_tt
			random_province = {
				limit = {
					is_empty = yes
					region = great_lakes_region
					NOT = {
						any_neighbor_province = {
							owner = {
								OR = {
									technology_group = exiled_greek
									technology_group = modern_greek
									technology_group = viking
									technology_group = modern_vinlandic
								}
							}
						}
					}
				}
				hidden_effect = {
					cede_province = ROOT
					change_religion = norse_pagan_reformed
					change_culture = varangian_n
					add_core = VGD
					ROOT = { release = VGD }
					VGD = {
						change_religion = norse_pagan_reformed
						change_primary_culture = varangian_n
						hidden_effect = {
							nhs_change_government = { GOV = varangian_order_gov }
						}
						nhs_add_gov_reform = { REF = varangian_guard }
					}
				}
				tooltip = {
					cede_province = VGD
				}
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.11.c"
		if = {
			limit = {
				NOT = { monthly_income = 21 }
			}
			add_treasury = -100
		}
		else_if = {
			limit = {
				NOT = { monthly_income = 104 }
			}
			add_years_of_income = -0.4
		}
		else = {
			add_treasury = -500
		}
	}
}

#The island of Malta
country_event = {
	id = nhs_vov_varangian_order_events.12
	title = nhs_vov_varangian_order_events.12.t
	desc = nhs_vov_varangian_order_events.12.d
	picture = varangian_offers_service_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		NOT = { has_country_flag = nhs_settle_v_on_malta }
		OR = {
			nhs_is_elysia_late = yes
			tag = NHS
		}
		has_discovered = 126
		has_country_flag = established_varangians
		NOT = { has_country_flag = nhs_disbanded_varangians }
		OR = {
			any_country = {
				tag = VGD
				is_subject_of = ROOT
			}
			NOT = { has_country_flag = nhs_varangian_crysis }
		}
		OR = {
			has_country_flag = nhs_invasion_begins
			has_country_flag = nhs_invasion_over
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.12.a"
		set_country_flag = nhs_settle_v_on_malta
	}
}

#The island of Malta
country_event = {
	id = nhs_vov_varangian_order_events.13
	title = nhs_vov_varangian_order_events.13.t
	desc = nhs_vov_varangian_order_events.13.d
	picture = varangian_offers_service_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		NOT = { has_country_flag = nhs_settle_v_on_malta }
		OR = {
			nhs_is_elysia_late = yes
			tag = NHS
		}
		has_country_flag = nhs_varangian_crysis
		has_country_flag = nhs_disbanded_varangians
		has_country_flag = established_varangians
		NOT = { exists = VGD }
		has_discovered = 126
		OR = {
			has_country_flag = nhs_invasion_begins
			has_country_flag = nhs_invasion_over
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.13.a"
		set_country_flag = nhs_settle_v_on_malta
	}
}

#Varangian province conquered
country_event = {
	id = nhs_vov_varangian_order_events.14
	title = nhs_vov_varangian_order_events.14.t
	desc = {
		trigger = {
			NOT = { has_country_flag = nhs_v_settled_on_malta }
		}
		desc = nhs_vov_varangian_order_events.14.da
	}
	desc = {
		trigger = {
			has_country_flag = nhs_v_settled_on_malta
		}
		desc = nhs_vov_varangian_order_events.14.db
	}
	
	picture = SIEGE_eventPicture
	
	trigger = {
		OR = {
			nhs_is_elysia_late = yes
			tag = NHS
		}
		has_country_flag = nhs_varangian_guard_substate
		NOT = { has_country_flag = nhs_varangian_pending }
		NOT = { has_country_flag = nhs_varangians_end }
		NOT = { has_country_flag = nhs_disbanded_varangians }
		NOT = { exists = VGD }
	}
	
	immediate = {
		hidden_effect = {
			every_province = {
				limit = {
					NOT = { owned_by = ROOT }
					is_core = VGD
					NOT = { owned_by = VGD }
				}
				remove_core = VGD
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.e"
		trigger = {
			NOT = { has_country_flag = nhs_v_settled_on_malta }
			NOT = {
				any_owned_province = {
					region = northeast_america_region
					is_core = VGD
					NOT = { nhs_homelands = yes }
				}
			}
			owns = 968
		}
		968 = {
			add_core = VGD
			cede_province = VGD
			change_culture = varangian_n
			change_religion = ROOT
			hidden_effect = {
				every_province = {
					limit = {
						is_core = VGD
						NOT = { owned_by = VGD }
					}
					remove_core = VGD
				}
			}
		}
		if = {
			limit = {
				968 = {
					OR = {
						has_province_modifier = nhs2_european_enclave
						has_province_modifier = nhs2_small_por_enclave
						has_province_modifier = nhs2_por_enclave
						has_province_modifier = nhs2_large_por_enclave
					}
				}
			}
			968 = {
				nhs_move_t_post = yes
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.c"
		trigger = {
			NOT = { has_country_flag = nhs_v_settled_on_malta }
			NOT = {
				any_owned_province = {
					region = northeast_america_region
					is_core = VGD
					NOT = { nhs_homelands = yes }
				}
			}
			owns = 2010
		}
		2010 = {
			add_core = VGD
			cede_province = VGD
			change_culture = varangian_n
			change_religion = ROOT
			hidden_effect = {
				every_province = {
					limit = {
						is_core = VGD
						NOT = { owned_by = VGD }
					}
					remove_core = VGD
				}
			}
		}
		if = {
			limit = {
				2010 = {
					OR = {
						has_province_modifier = nhs2_european_enclave
						has_province_modifier = nhs2_small_por_enclave
						has_province_modifier = nhs2_por_enclave
						has_province_modifier = nhs2_large_por_enclave
					}
				}
			}
			2010 = {
				nhs_move_t_post = yes
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.b"
		trigger = {
			NOT = { has_country_flag = nhs_v_settled_on_malta }
			NOT = {
				any_owned_province = {
					region = northeast_america_region
					is_core = VGD
				}
			}
			owns = 965
		}
		965 = {
			add_core = VGD
			cede_province = VGD
			change_culture = varangian_n
			change_religion = ROOT
			hidden_effect = {
				every_province = {
					limit = {
						is_core = VGD
						NOT = { owned_by = VGD }
					}
					remove_core = VGD
				}
			}
		}
		if = {
			limit = {
				965 = {
					OR = {
						has_province_modifier = nhs2_european_enclave
						has_province_modifier = nhs2_small_por_enclave
						has_province_modifier = nhs2_por_enclave
						has_province_modifier = nhs2_large_por_enclave
					}
				}
			}
			965 = {
				nhs_move_t_post = yes
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.a"
		trigger = {
			NOT = { has_country_flag = nhs_v_settled_on_malta }
			NOT = {
				any_owned_province = {
					region = northeast_america_region
					is_core = VGD
					NOT = { nhs_homelands = yes }
				}
			}
			owns = 962
		}
		962 = {
			add_core = VGD
			cede_province = VGD
			change_culture = varangian_n
			change_religion = ROOT
			hidden_effect = {
				every_province = {
					limit = {
						is_core = VGD
						NOT = { owned_by = VGD }
					}
					remove_core = VGD
				}
			}
		}
		if = {
			limit = {
				962 = {
					OR = {
						has_province_modifier = nhs2_european_enclave
						has_province_modifier = nhs2_small_por_enclave
						has_province_modifier = nhs2_por_enclave
						has_province_modifier = nhs2_large_por_enclave
					}
				}
			}
			962 = {
				nhs_move_t_post = yes
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.f"
		trigger = {
			NOT = { has_country_flag = nhs_v_settled_on_malta }
			OR = {
				any_owned_province = {
					region = northeast_america_region
					is_core = VGD
					NOT = { nhs_homelands = yes }
				}
				AND = {
					NOT = {
						OR = {
							owns = 962
							owns = 965
							owns = 2010
							owns = 968
						}
					}
					any_owned_province = {
						region = northeast_america_region
						is_core = VGD
						NOT = { nhs_homelands = yes }
					}
				}
			}
		}
		if = {
			limit = {
				any_owned_province = {
					region = northeast_america_region
					NOT = { nhs_homelands = yes }
					is_core = VGD
				}
			}
			random_owned_province = {
				limit = {
					region = northeast_america_region
					NOT = { nhs_homelands = yes }
					is_core = VGD
				}
				tooltip = {
					cede_province = VGD
					add_core = VGD
					change_culture = varangian_n
					change_religion = ROOT
				}
				if = {
					limit = {
						OR = {
							has_province_modifier = nhs2_european_enclave
							has_province_modifier = nhs2_small_por_enclave
							has_province_modifier = nhs2_por_enclave
							has_province_modifier = nhs2_large_por_enclave
						}
					}
					nhs_move_t_post = yes
				}
				hidden_effect = {
					cede_province = VGD
					add_core = VGD
					change_culture = varangian_n
					change_religion = ROOT
				}
			}
		}
		else = {
			random_owned_province = {
				limit = {
					region = northeast_america_region
					NOT = { nhs_homelands = yes }
				}
				tooltip = {
					cede_province = VGD
					add_core = VGD
					change_culture = varangian_n
					change_religion = ROOT
				}
				if = {
					limit = {
						OR = {
							has_province_modifier = nhs2_european_enclave
							has_province_modifier = nhs2_small_por_enclave
							has_province_modifier = nhs2_por_enclave
							has_province_modifier = nhs2_large_por_enclave
						}
					}
					nhs_move_t_post = yes
				}
				hidden_effect = {
					cede_province = VGD
					add_core = VGD
					change_culture = varangian_n
					change_religion = ROOT
				}
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.g"
		trigger = {
			NOT = { has_country_flag = nhs_v_settled_on_malta }
			NOT = {
				any_owned_province = {
					region = northeast_america_region
					NOT = { nhs_homelands = yes }
				}
			}
		}
		set_country_flag = nhs_varangian_pending
		custom_tooltip = nhs_varangians_pending_tt
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.h"
		trigger = {
			has_country_flag = nhs_v_settled_on_malta
		}
		set_country_flag = nhs_varangian_pending
		custom_tooltip = nhs_varangians_pending_malta_tt
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.i"
		if = {
			limit = {
				has_country_flag = nhs_v_settled_on_malta
			}
			set_country_flag = nhs_varangians_end
			every_province = {
				limit = {
					is_core = VGD
				}
				remove_core = VGD
			}
		}
		else = {
			random = {
				chance = 50
				kill_ruler = yes
			}
			capital_scope = {
				particularist_rebels = 1
			}
			if = {
				limit = {
					any_owned_province = {
						nhs_homelands = yes
						NOT = { is_capital = yes }
					}
				}
				random_owned_province = {
					limit = {
						nhs_homelands = yes
						NOT = { is_capital = yes }
					}
					particularist_rebels = 1
				}
			}
			else = {
				capital_scope = {
					particularist_rebels = 1
				}
			}
			every_province = {
				limit = {
					has_province_modifier = nhs2_varangian_m
				}
				remove_province_modifier = nhs2_varangian_m
			}
			remove_country_modifier = nhs2_varangian_influnce_m
			hidden_effect = {
				every_province = {
					limit = {
						is_core = VGD
					}
					remove_core = VGD
				}
			}
			set_country_flag = nhs_disbanded_varangians
		}
	}
}

#The Varangian province acquired
country_event = {
	id = nhs_vov_varangian_order_events.15
	title = nhs_vov_varangian_order_events.15.t
	desc = {
		trigger = {
			NOT = { has_country_flag = nhs_v_settled_on_malta }
		}
		desc = nhs_vov_varangian_order_events.15.da
	}
	desc = {
		trigger = {
			has_country_flag = nhs_v_settled_on_malta
		}
		desc = nhs_vov_varangian_order_events.15.db
	}
	picture = norse_colony_eventPicture
	
	trigger = {
		OR = {
			nhs_is_elysia_late = yes
			tag = NHS
		}
		has_country_flag = nhs_varangian_pending
		has_country_flag = nhs_varangian_guard_substate
		NOT = { has_country_flag = nhs_varangians_end }
		OR = {
			has_country_flag = nhs_v_settled_on_malta
			NOT = { has_country_flag = nhs_disbanded_varangians }
		}
		NOT = { exists = VGD }
		OR = {
			AND = {
				NOT = { has_country_flag = nhs_v_settled_on_malta }
				any_owned_province = {
					region = northeast_america_region
					NOT = { nhs_homelands = yes }
				}
			}
			AND = {
				has_country_flag = nhs_v_settled_on_malta
				owns = 126
			}
		}
	}
	
	immediate = {
		hidden_effect = {
			clr_country_flag = nhs_varangian_pending
			every_province = {
				limit = {
					NOT = { owned_by = ROOT }
					NOT = { owned_by = VGD }
					is_core = VGD
				}
				remove_core = VGD
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.e"
		trigger = {
			NOT = { has_country_flag = nhs_v_settled_on_malta }
			NOT = {
				any_owned_province = {
					region = northeast_america_region
					is_core = VGD
					NOT = { nhs_homelands = yes }
				}
			}
			owns = 968
		}
		968 = {
			add_core = VGD
			cede_province = VGD
			change_culture = varangian_n
			change_religion = ROOT
			hidden_effect = {
				every_province = {
					limit = {
						is_core = VGD
						NOT = { owned_by = VGD }
					}
					remove_core = VGD
				}
			}
		}
		if = {
			limit = {
				968 = {
					OR = {
						has_province_modifier = nhs2_european_enclave
						has_province_modifier = nhs2_small_por_enclave
						has_province_modifier = nhs2_por_enclave
						has_province_modifier = nhs2_large_por_enclave
					}
				}
			}
			968 = {
				nhs_move_t_post = yes
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.c"
		trigger = {
			NOT = { has_country_flag = nhs_v_settled_on_malta }
			NOT = {
				any_owned_province = {
					region = northeast_america_region
					is_core = VGD
					NOT = { nhs_homelands = yes }
				}
			}
			owns = 2010
		}
		2010 = {
			add_core = VGD
			cede_province = VGD
			change_culture = varangian_n
			change_religion = ROOT
			hidden_effect = {
				every_province = {
					limit = {
						is_core = VGD
						NOT = { owned_by = VGD }
					}
					remove_core = VGD
				}
			}
		}
		if = {
			limit = {
				2010 = {
					OR = {
						has_province_modifier = nhs2_european_enclave
						has_province_modifier = nhs2_small_por_enclave
						has_province_modifier = nhs2_por_enclave
						has_province_modifier = nhs2_large_por_enclave
					}
				}
			}
			2010 = {
				nhs_move_t_post = yes
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.b"
		trigger = {
			NOT = { has_country_flag = nhs_v_settled_on_malta }
			NOT = {
				any_owned_province = {
					region = northeast_america_region
					is_core = VGD
				}
			}
			owns = 965
		}
		965 = {
			add_core = VGD
			cede_province = VGD
			change_culture = varangian_n
			change_religion = ROOT
			hidden_effect = {
				every_province = {
					limit = {
						is_core = VGD
						NOT = { owned_by = VGD }
					}
					remove_core = VGD
				}
			}
		}
		if = {
			limit = {
				965 = {
					OR = {
						has_province_modifier = nhs2_european_enclave
						has_province_modifier = nhs2_small_por_enclave
						has_province_modifier = nhs2_por_enclave
						has_province_modifier = nhs2_large_por_enclave
					}
				}
			}
			965 = {
				nhs_move_t_post = yes
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.a"
		trigger = {
			NOT = { has_country_flag = nhs_v_settled_on_malta }
			NOT = {
				any_owned_province = {
					region = northeast_america_region
					is_core = VGD
					NOT = { nhs_homelands = yes }
				}
			}
			owns = 962
		}
		962 = {
			add_core = VGD
			cede_province = VGD
			change_culture = varangian_n
			change_religion = ROOT
			hidden_effect = {
				every_province = {
					limit = {
						is_core = VGD
						NOT = { owned_by = VGD }
					}
					remove_core = VGD
				}
			}
		}
		if = {
			limit = {
				962 = {
					OR = {
						has_province_modifier = nhs2_european_enclave
						has_province_modifier = nhs2_small_por_enclave
						has_province_modifier = nhs2_por_enclave
						has_province_modifier = nhs2_large_por_enclave
					}
				}
			}
			962 = {
				nhs_move_t_post = yes
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.14.f"
		trigger = {
			NOT = { has_country_flag = nhs_v_settled_on_malta }
			OR = {
				any_owned_province = {
					region = northeast_america_region
					is_core = VGD
					NOT = { nhs_homelands = yes }
				}
				AND = {
					NOT = {
						OR = {
							owns = 962
							owns = 965
							owns = 2010
							owns = 968
						}
					}
					any_owned_province = {
						region = northeast_america_region
						is_core = VGD
						NOT = { nhs_homelands = yes }
					}
				}
			}
		}
		if = {
			limit = {
				any_owned_province = {
					region = northeast_america_region
					NOT = { nhs_homelands = yes }
					is_core = VGD
				}
			}
			random_owned_province = {
				limit = {
					region = northeast_america_region
					NOT = { nhs_homelands = yes }
					is_core = VGD
				}
				tooltip = {
					cede_province = VGD
					add_core = VGD
					change_culture = varangian_n
					change_religion = ROOT
				}
				if = {
					limit = {
						OR = {
							has_province_modifier = nhs2_european_enclave
							has_province_modifier = nhs2_small_por_enclave
							has_province_modifier = nhs2_por_enclave
							has_province_modifier = nhs2_large_por_enclave
						}
					}
					nhs_move_t_post = yes
				}
				hidden_effect = {
					cede_province = VGD
					add_core = VGD
					change_culture = varangian_n
					change_religion = ROOT
				}
			}
		}
		else = {
			random_owned_province = {
				limit = {
					region = northeast_america_region
					NOT = { nhs_homelands = yes }
				}
				tooltip = {
					cede_province = VGD
					add_core = VGD
					change_culture = varangian_n
					change_religion = ROOT
				}
				if = {
					limit = {
						OR = {
							has_province_modifier = nhs2_european_enclave
							has_province_modifier = nhs2_small_por_enclave
							has_province_modifier = nhs2_por_enclave
							has_province_modifier = nhs2_large_por_enclave
						}
					}
					nhs_move_t_post = yes
				}
				hidden_effect = {
					cede_province = VGD
					add_core = VGD
					change_culture = varangian_n
					change_religion = ROOT
				}
			}
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.15.g"
		trigger = {
			has_country_flag = nhs_v_settled_on_malta
		}
		hidden_effect = {
			every_province = {
				limit = {
					NOT = { province_id = 126 }
					is_core = VGD
				}
				remove_core = VGD
			}
		}
		126 = {
			add_core = VGD
			cede_province = VGD
		}
	}
}

#Varangians defend Emperor
country_event = {
	id = nhs_vov_varangian_order_events.16
	title = nhs_vov_varangian_order_events.16.t
	desc = nhs_vov_varangian_order_events.16.d
	picture = ASSASSINATION_eventPicture
	
	trigger = {
		OR = {
			nhs_is_elysia_late = yes
			tag = NHS
		}
		OR = {
			NOT = { has_country_flag = nhs_disbanded_varangians }
			any_country = {
				tag = VGD
				is_subject_of = ROOT
			}
		}
		OR = {
			NOT = { has_country_flag = nhs_varangian_guard_substate }
			any_country = {
				tag = VGD
				is_subject_of = ROOT
			}
		}
		has_country_flag = established_varangians
		NOT = { has_country_flag = nhs_varangians_end }
		OR = {
			unrest = 5
			capital_scope = {
				unrest = 0
			}
			calc_true_if = {
				all_owned_province = {
					unrest = 5
				}
				amount = 5
			}
		}
	}
	
	mean_time_to_happen = {
		months = 240
		modifier = {
			factor = 0.8
			capital_scope = {
				unrest = 5
			}
		}
		modifier = {
			factor = 0.1
			capital_scope = {
				unrest = 10
			}
		}
		modifier = {
			factor = 0.5
			unrest = 10
		}
		modifier = {
			factor = 0.8
			war_exhaustion = 5
		}
		modifier = {
			factor = 0.625
			war_exhaustion = 11
		}
		modifier = {
			factor = 5
			has_country_flag = nhs_v_settled_on_malta
		}
		modifier = {
			factor = 2
			has_country_flag = nhs_had_event_varangian_order_events16
		}
		modifier = {
			factor = 1.5
			any_country = {
				tag = VGD
				is_subject_of = ROOT
			}
		}
	}
	
	immediate = {
		set_country_flag = nhs_had_event_varangian_order_events16
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.16.a"
		add_prestige = 5
		capital_scope = {
			add_unrest = -5
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.16.b"
		trigger = {
			has_estate = estate_nhs_nobles
		}
		capital_scope = {
			add_unrest = -10
		}
		custom_tooltip = nhs_minus_five_unrest_every_province_tt_noble
		hidden_effect = {
			every_owned_province = {
				limit = {
					NOT = { has_estate = estate_nhs_nobles }
				}
				add_unrest = -5
			}
		}
		add_estate_influence_modifier = {
			estate = estate_nhs_nobles
			desc = EST_BLAMED_FOR_A
			influence = -10
			duration = 5475
		}
		add_estate_loyalty = {
			estate = estate_nhs_nobles
			loyalty = -5
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.16.c"
		trigger = {
			has_estate = estate_burghers
		}
		capital_scope = {
			add_unrest = -10
		}
		custom_tooltip = nhs_minus_five_unrest_every_province_tt_merc
		hidden_effect = {
			every_owned_province = {
				limit = {
					NOT = { has_estate = estate_burghers }
				}
				add_unrest = -5
			}
		}
		add_estate_influence_modifier = {
			estate = estate_burghers
			desc = EST_BLAMED_FOR_A
			influence = -10
			duration = 5475
		}
		add_estate_loyalty = {
			estate = estate_burghers
			loyalty = -5
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.16.e"
		trigger = {
			has_estate = estate_church
		}
		capital_scope = {
			add_unrest = -10
		}
		if = {
			limit = {
				NOT = { religion = aztlan_worship }
			}
			custom_tooltip = nhs_minus_five_unrest_every_province_tt_church
		}
		else = {
			custom_tooltip = nhs_minus_five_unrest_every_province_tt_church_a
		}
		hidden_effect = {
			every_owned_province = {
				limit = {
					NOT = { has_estate = estate_church }
				}
				add_unrest = -5
			}
		}
		add_estate_influence_modifier = {
			estate = estate_church
			desc = EST_BLAMED_FOR_A
			influence = -10
			duration = 5475
		}
		add_estate_loyalty = {
			estate = estate_church
			loyalty = -5
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.16.f"
		trigger = {
			has_estate = estate_nhs_native_council
		}
		capital_scope = {
			add_unrest = -10
		}
		custom_tooltip = nhs_minus_five_unrest_every_province_tt_nat
		hidden_effect = {
			every_owned_province = {
				limit = {
					NOT = { has_estate = estate_nhs_native_council }
				}
				add_unrest = -5
			}
		}
		add_estate_influence_modifier = {
			estate = estate_nhs_native_council
			desc = EST_BLAMED_FOR_A
			influence = -10
			duration = 5475
		}
		add_estate_loyalty = {
			estate = estate_nhs_native_council
			loyalty = -5
		}
	}
}

# Varangians rampaging through the capital
country_event = {
	id = nhs_vov_varangian_order_events.17
	title = nhs_vov_varangian_order_events.17.t
	desc = nhs_vov_varangian_order_events.17.d
	picture = REVOLUTION_eventPicture
	
	trigger = {
		OR = {
			nhs_is_elysia_late = yes
			tag = NHS
		}
		capital_scope = {
			has_province_modifier = nhs2_varangian_m
		}
		has_country_flag = established_varangians
		NOT = { has_country_flag = nhs_varangians_end }
		NOT = { has_country_flag = nhs_v_settled_on_malta }
	}
	
	mean_time_to_happen = {
		months = 360
		modifier = {
			factor = 10
			has_country_flag = nhs_had_event_varangian_order_events17
		}
		modifier = {
			factor = 0.8
			has_country_modifier = nhs2_varangian_influnce_m
		}
	}
	
	immediate = {
		set_country_flag = nhs_had_event_varangian_order_events17
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.17.a"
		add_prestige = -5
		capital_scope = {
			add_province_modifier = {
				name = nhs_allowed_varangian_rampage
				duration = 730
			}
		}
	}
	option = {
		name = "nhs_vov_varangian_order_events.17.b"
		add_legitimacy = 5
		capital_scope = {
			particularist_rebels = 1
			add_province_modifier = {
				name = nhs_send_in_city_guard
				duration = 730
			}
		}
	}
}

# Varangians want to return home
country_event = {
	id = nhs_vov_varangian_order_events.18
	title = nhs_vov_varangian_order_events.18.t
	desc = {
		trigger = {
			OR = {
				army_tradition = 60
				mil = 1
			}
		}
		desc = nhs_vov_varangian_order_events.18.da
	}
	desc = {
		trigger = {
			NOT = {
				OR = {
					army_tradition = 60
					mil = 1
				}
			}
		}
		desc = nhs_vov_varangian_order_events.18.db
	}
	picture = varangian_returning_eventPicture
	
	trigger = {
		is_at_war = no
		OR = {
			nhs_is_elysia_late = yes
			tag = NHS
		}
		is_year = 1480
		OR = {
			NOT = { has_country_flag = nhs_disbanded_varangians }
			any_country = {
				tag = VGD
				is_subject_of = ROOT
			}
		}
		OR = {
			NOT = { has_country_flag = nhs_varangian_guard_substate }
			any_country = {
				tag = VGD
				is_subject_of = ROOT
			}
		}
		has_country_flag = established_varangians
		NOT = { has_country_flag = nhs_varangians_end }
		OR = {
			AND = {
				exists = VIN
				NOT = { war_with = VIN }
			}
			AND = {
				exists = MK1
				NOT = { war_with = MK1 }
			}
			AND = {
				exists = HLL
				NOT = { war_with = HLL }
			}
			any_owned_province = {
				OR = {
					culture_group = norse_g
					province_group = thorfinn_bay
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 480
		modifier = {
			factor = 0.5
			is_year = 1550
			NOT = { has_country_flag = nhs_had_event_varangian_order_events18 }
		}
		modifier = {
			factor = 5
			has_country_flag = nhs_had_event_varangian_order_events18
		}
		modifier = {
			factor = 0.8
			has_country_flag = nhs_had_event_varangian_order_events18
		}
		modifier = {
			factor = 0.9
			NOT = { had_recent_war = 10 }
			had_recent_war = 5
		}
		modifier = {
			factor = 0.75
			NOT = { had_recent_war = 5 }
			had_recent_war = 2
		}
		modifier = {
			factor = 0.5
			NOT = { had_recent_war = 2 }
		}
	}
	
	immediate = {
		set_country_flag = nhs_had_event_varangian_order_events18
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.18.a"
		add_prestige = 5
		add_manpower = -4
		if = {
			limit = {
				any_owned_province = {
					culture_group = norse_g
				}
			}
			every_owned_province = {
				limit = {
					culture_group = norse_g
				}
				add_unrest = -5
			}
		}
		if = {
			limit = {
				any_country = {
					OR = {
						tag = VIN
						tag = HLL
						tag = MK1
					}
					NOT = { war_with = ROOT }
				}
			}
			random_country = {
				limit = {
					OR = {
						tag = VIN
						tag = HLL
						tag = MK1
					}
					NOT = { war_with = ROOT }
				}
				add_opinion = { who = ROOT modifier = nhs_send_v_home_opinion }
			}
		}
	}
	option = {
		name = "nhs_vov_varangian_order_events.18.b"
		if = {
			limit = {
				is_at_war = no
			}
			add_war_exhaustion = 5
		}
		else = {
			add_war_exhaustion = 2
		}
	}
	option = {
		name = "nhs_vov_varangian_order_events.18.c"
		highlight = yes
		trigger = {
			OR = {
				army_tradition = 60
				mil = 1
			}
		}
		define_advisor = {
			type = army_organiser
			skill = 3
			discount = yes
		}
		add_treasury = -25
		add_legitimacy = -5
	}
}

# Arguments with Epilektoi
country_event = {
	id = nhs_vov_varangian_order_events.19
	title = nhs_vov_varangian_order_events.19.t
	desc = nhs_vov_varangian_order_events.19.d
	picture = varangian_argument_eventPicture
	
	trigger = {
		NOT = { has_country_flag = nhs_had_event_varangian_order_events19 }
		OR = {
			nhs_is_elysia_late = yes
			tag = NHS
		}
		OR = {
			NOT = { has_country_flag = nhs_disbanded_varangians }
			any_country = {
				tag = VGD
				is_subject_of = ROOT
			}
		}
		has_country_modifier = nhs_epilektoi
		OR = {
			NOT = { has_country_flag = nhs_varangian_guard_substate }
			any_country = {
				tag = VGD
				is_subject_of = ROOT
			}
		}
		has_country_flag = established_varangians
		NOT = { has_country_flag = nhs_varangians_end }
		NOT = { has_country_flag = nhs_v_settled_on_malta }
	}
	
	mean_time_to_happen = {
		months = 500
		modifier = {
			factor = 0.8
			has_country_modifier = nhs2_varangian_influnce_m
		}
		modifier = {
			factor = 2
			NOT = { has_country_modifier = nhs_expanded_pantheon }
			NOT = { has_country_modifier = nhs_consolidated_pantheon }
		}
		modifier = {
			factor = 0.8
			religion_group = christian
		}
	}
	
	immediate = {
		set_country_flag = nhs_had_event_varangian_order_events19
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.19.a"
		add_estate_influence_modifier = {
			estate = estate_nhs_nobles
			desc = EST_VAL_FAVORS_E
			influence = 5
			duration = 5475
		}
		add_estate_loyalty = {
			estate = estate_nhs_nobles
			loyalty = 10
		}
		add_prestige = 5
		add_ruler_modifier = {
			name = nhs_favors_epilektoi
			duration = -1
		}
	}
	option = {
		name = "nhs_vov_varangian_order_events.19.b"
		add_estate_influence_modifier = {
			estate = estate_nhs_nobles
			desc = EST_VAL_FAVORS_V
			influence = -5
			duration = 5475
		}
		add_estate_loyalty = {
			estate = estate_nhs_nobles
			loyalty = -10
		}
		add_ruler_modifier = {
			name = nhs_favors_varangians
			duration = -1
		}
	}
	
	option = {
		name = "nhs_vov_varangian_order_events.19.c"
		highlight = yes
		add_estate_loyalty = {
			estate = estate_nhs_nobles
			loyalty = 5
		}
		trigger = {
			has_country_modifier = nhs_expanded_pantheon
			OR = {
				religion = pantheon_worship
				religion = aztlan_worship
			}
		}
		add_legitimacy = 10
		add_ruler_modifier = {
			name = nhs_favors_both
			duration = -1
		}
	}
}

# Choose Heir
country_event = {
	id = nhs_vov_varangian_order_events.20
	title = nhs_vov_varangian_order_events.20.t
	desc = nhs_vov_varangian_order_events.20.d
	picture = ELECTION_REPUBLICAN_eventPicture
	
	trigger = {
		has_reform = varangian_guard
		has_heir = no
		NOT = { has_ruler_modifier = vov_varangian_heir_cd }
	}
	
	immediate = {
		hidden_effect = {
			random_list = {
				95 = {
					clr_country_flag = vov_female_heir_varangians
				}
				5 = {
					set_country_flag = vov_female_heir_varangians
				}
			}
			nhs_heir_age_mm_10_pregen = { HT = 0 }
			nhs_heir_age_mm_20_pregen = { HT = 1 }
		}
	}
	
	after = {
		clr_country_flag = vov_female_heir_varangians
	}

	option = {
		name = "nhs_vov_varangian_order_events.20.a"	# Don't Choose yet
		ai_chance = {
			factor = 15
			modifier = {
				factor = 0
				NOT = { republican_tradition = 75 }
			}
			modifier = {
				factor = 0
				ruler_age = 50
			}
		}
		add_republican_tradition = -5
		hidden_effect = {
			add_ruler_modifier = {
				name = vov_varangian_heir_cd
				duration = 1825
			}
		}
	}
	option = {
		name = "nhs_vov_varangian_order_events.20.b"	# Aspiring Guardsman
		ai_chance = { factor = 40 }
		if = {
			limit = { 
				has_active_policy = mandatory_service 
				has_country_flag = vov_female_heir_varangians
			}
			nhs_heir_age_mm_10 = { 
				AGE1 = 2 
				MIN_R_DIP = 1 
				MIN_R_MIL = 2 
				MAX_R_DIP = 3 
				MAX_R_ADM = 4
				IS_FEMALE = yes 
				HT = 0
			}
			vov_varangian_heir_ruler_general = { HEIR_FEMALE = yes }
		}
		else = {
			nhs_heir_age_mm_10 = { 
				AGE1 = 2 
				MIN_R_DIP = 1 
				MIN_R_MIL = 2 
				MAX_R_DIP = 3 
				MAX_R_ADM = 4 
				IS_MALE = yes 
				HT = 0
			}
			vov_varangian_heir_ruler_general = { HEIR_MALE = yes }
		}
		set_country_flag = vov_varangian_has_heir
	}
	option = {
		name = "nhs_vov_varangian_order_events.20.c"	# A veteran
		ai_chance = { factor = 40 }
		if = {
			limit = { 
				has_active_policy = mandatory_service
				has_country_flag = vov_female_heir_varangians				
			}
			nhs_heir_age_mm_20 = { 
				AGE1 = 4
				AGE2 = 5
				MIN_R_ADM = 1
				MIN_R_MIL = 1
				MAX_R_ADM = 5
				MAX_R_DIP = 5
				MAX_R_MIL = 5
				IS_FEMALE = yes
				HT = 1
			}
			vov_varangian_heir_ruler_general = { HEIR_FEMALE = yes }
		}
		else = {
			nhs_heir_age_mm_20 = { 
				AGE1 = 4
				AGE2 = 5
				MIN_R_ADM = 1 
				MIN_R_MIL = 1 
				MAX_R_ADM = 5 
				MAX_R_DIP = 5 
				MAX_R_MIL = 5 
				IS_MALE = yes
				HT = 1
			}
			vov_varangian_heir_ruler_general = { HEIR_MALE = yes }
		}
		set_country_flag = vov_varangian_has_heir
	}


#	option = { # Nepotism choice, re-electing within dynasty
#		name = "nhs_vov_varangian_order_events.20.e"
#		trigger = {
#			has_government_attribute = enables_nepotism
#		}
#		ai_chance = { factor = 10 }
#		add_republican_tradition = -10
#		if = {
#			limit = { 
#				has_active_policy = mandatory_service 
#			}
#			if = {
#				limit = {
#					has_country_flag = vov_female_heir_varangians
#				}
#				nhs_heir_age_mm_20 = { 
#					NAME = "lastname"
#					AGE1 = 2
#					AGE2 = 3
#					MIN_R_ADM = 1
#					MIN_R_MIL = 1
#					MAX_R_ADM = 2
#					MAX_R_DIP = 3
#					IS_FEMALE = yes
#				}
#				#define_heir = {
#				#	dip = 1
#				#	mil = 1
#				#	max_random_adm = 2
#				#	max_random_dip = 3
#				#	#min_age = 30
#				#	#max_age = 50
#				#	name = "lastname"
#				#	female = yes 
#				#}
#				vov_varangian_heir_ruler_general = { HEIR_FEMALE = yes }
#			}
#			else = {
#				nhs_heir_age_mm_20 = { 
#					NAME = "lastname"
#					AGE1 = 2
#					AGE2 = 3
#					MIN_R_ADM = 1 
#					MIN_R_MIL = 1 
#					MAX_R_ADM = 2
#					MAX_R_DIP = 3
#					IS_MALE = yes
#				}
#				#define_heir = {
#				#	dip = 1
#				#	mil = 1
#				#	max_random_adm = 2
#				#	max_random_dip = 3
#				#	#min_age = 30
#				#	#max_age = 50
#				#	name = "lastname"
#				#	male = yes 
#				#}
#				vov_varangian_heir_ruler_general = { HEIR_MALE = yes }
#			}
#		}
#		else = {
#			nhs_heir_age_mm_20 = { 
#				NAME = "lastname"
#				AGE1 = 2
#				AGE2 = 3
#				MIN_R_ADM = 1 
#				MIN_R_MIL = 1 
#				MAX_R_ADM = 2
#				MAX_R_DIP = 3
#				IS_MALE = yes
#			}
#			#define_heir = {
#			#	dip = 1
#			#	mil = 1
#			#	max_random_adm = 2
#			#	max_random_dip = 3
#			#	#min_age = 30
#			#	#max_age = 50
#			#	male = yes
#			#	name = "lastname"
#			#}
#			vov_varangian_heir_ruler_general = { HEIR_MALE = yes }
#		}
#		set_country_flag = vov_varangian_has_heir
#	}
}

# Election!
country_event = {
	id = nhs_vov_varangian_order_events.21
	title = nhs_vov_varangian_order_events.21.t
	desc = nhs_vov_varangian_order_events.21.d
	picture = ELECTION_REPUBLICAN_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_reform = varangian_guard
		NOT = { has_country_flag = vov_vrg_has_election }
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = vov_vrg_has_election
			random_list = {
				95 = {
					clr_country_flag = vov_female_heir_varangians
				}
				5 = {
					set_country_flag = vov_female_heir_varangians
				}
			}
			set_saved_name = {
				key = vov_vrg_name_one
				type = advisor
				scope = ROOT
			}
			set_saved_name = {
				key = vov_vrg_name_two
				type = advisor
				name = ROOT
			}
		}
	}
	
	after = {
		clr_country_flag = vov_female_heir_varangians
		clear_saved_name = vov_vrg_name_one
		clear_saved_name = vov_vrg_name_two
		clr_country_flag = vov_vrg_has_election
	}

	option = {
		name = "nhs_vov_varangian_order_events.21.a"	# Current ruler stays
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { republican_tradition = 75 }
			}	
		}
		custom_tooltip = remains_ruler
		if = {
			limit = {
				OR = {
					NOT = { has_reform = frequent_elections_reform_vrg }
					NOT = { has_dlc = "Dharma" }
				}
			}
			change_adm = 2
			change_dip = 2
			change_mil = 2
		}
		else = {
			change_adm = 1
			change_dip = 1
			change_mil = 1
		}
		add_republican_tradition = -25
		random_list = {
			10 = {
				add_adm_power = 50
			}
			10 = {
				add_dip_power = 50
			}
			10 = {
				add_mil_power = 50
			}
		}
	}
	option = {
		name = "nhs_vov_varangian_order_events.21.b"
		trigger = {
			has_heir = yes
		}
		ai_chance = {
			factor = 50	
		}
		if = {
			limit = {
				NOT = { heir_adm = 6 }
				NOT = { heir_dip = 6 }
				NOT = { heir_mil = 6 }
			}
			random_list = {
				10 = {
					change_heir_adm = 1
				}
				10 = {
					change_heir_dip = 1
				}
				10 = {
					change_heir_mil = 1
				}
			}
		}
		else_if = {
			limit = {
				heir_adm = 6
				NOT = { heir_dip = 6 }
				NOT = { heir_mil = 6 }
			}
			random_list = {
				10 = {
					change_heir_dip = 1
				}
				10 = {
					change_heir_mil = 1
				}
			}
		}
		else_if = {
			limit = {
				heir_dip = 6
				NOT = { heir_adm = 6 }
				NOT = { heir_mil = 6 }
			}
			random_list = {
				10 = {
					change_heir_adm = 1
				}
				10 = {
					change_heir_mil = 1
				}
			}
		}
		else_if = {
			limit = {
				heir_mil = 6
				NOT = { heir_adm = 6 }
				NOT = { heir_dip = 6 }
			}
			random_list = {
				10 = {
					change_heir_adm = 1
				}
				10 = {
					change_heir_dip = 1
				}
			}
		}
		else_if = {
			limit = {
				heir_mil = 6
				heir_adm = 6
				NOT = { heir_dip = 6 }
			}
			change_heir_dip = 1
		}
		else_if = {
			limit = {
				heir_mil = 6
				heir_dip = 6
				NOT = { heir_adm = 6 }
			}
			change_heir_adm = 1
		}
		else_if = {
			limit = {
				heir_dip = 6
				heir_adm = 6
				NOT = { heir_mil = 6 }
			}
			change_heir_mil = 1
		}
		else_if = {
			limit = {
				heir_dip = 6
				heir_adm = 6
				heir_mil = 6
			}
			add_adm_power = 100
			add_dip_power = 100
			add_mil_power = 100
		}
		
		#hidden_effect = {
			exile_ruler_as = vov_ruler_varangian
			#set_ruler = vov_heir_varangian
		#}
		clr_country_flag = vov_varangian_has_heir
	}
	option = {
		name = "nhs_vov_varangian_order_events.21.c"	# Aspiring Guardsman
		ai_chance = { factor = 40 }
		trigger = {
			has_heir = no
		}
		define_ruler = {
			name = vov_vrg_name_one
			dip = 1
			mil = 2
			max_random_adm = 3
			max_random_dip = 4
			##max_age = 30
			male = yes
		}
		vov_varangian_heir_ruler_general = { RULER_MALE = yes }
	}
	option = {
		name = "nhs_vov_varangian_order_events.21.e"	# A veteran
		trigger = {
			has_heir = no
		}
		ai_chance = { factor = 40 }
		define_ruler = {
			name = vov_vrg_name_two
			adm = 1
			mil = 1
			max_random_adm = 5
			max_random_dip = 5
			max_random_mil = 5
			#min_age = 40
			male = yes 
		}
		vov_varangian_heir_ruler_general = { RULER_MALE = yes }
	}


#	option = { # Nepotism choice, re-electing within dynasty
#		name = "nhs_vov_varangian_order_events.21.f"
#		trigger = {
#			has_government_attribute = enables_nepotism
#			has_heir = no
#		}
#		ai_chance = { factor = 10 }
#		add_republican_tradition = -10
#		if = {
#			limit = { 
#				has_active_policy = mandatory_service 
#			}
#			if = {
#				limit = {
#					has_country_flag = vov_female_heir_varangians
#				}
#				define_ruler = {
#					dip = 1
#					mil = 1
#					max_random_adm = 2
#					max_random_dip = 3
#					#min_age = 30
#					##max_age = 50
#					name = "lastname"
#					female = yes 
#				}
#				convert_female_ruler_to_general = yes
#			}
#			else = {
#				define_ruler = {
#					dip = 1
#					mil = 1
#					max_random_adm = 2
#					max_random_dip = 3
#					#min_age = 30
#					##max_age = 50
#					name = "lastname"
#					male = yes 
#				}
#				vov_varangian_heir_ruler_general = { RULER_MALE = yes }
#			}
#		}
#		else = {
#			define_ruler = {
#				dip = 1
#				mil = 1
#				max_random_adm = 2
#				max_random_dip = 3
#				#min_age = 30
#				##max_age = 50
#				male = yes
#				name = "lastname"
#			}
#			vov_varangian_heir_ruler_general = { RULER_MALE = yes }
#		}
#	}
}

# Election on death
country_event = {
	id = nhs_vov_varangian_order_events.22
	title = nhs_vov_varangian_order_events.22.t
	desc = nhs_vov_varangian_order_events.22.d
	picture = ELECTION_REPUBLICAN_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_reform = varangian_guard
		NOT = { has_country_flag = vov_varangian_has_heir }
	}
	
	immediate = {
		hidden_effect = {
			add_stability = -1
			clr_country_flag = vov_varangian_has_heir
			random_list = {
				95 = {
					clr_country_flag = vov_female_heir_varangians
				}
				5 = {
					set_country_flag = vov_female_heir_varangians
				}
			}
		}
	}
	
	after = {
		clr_country_flag = vov_female_heir_varangians
	}

	option = {
		name = "nhs_vov_varangian_order_events.22.a"	# Aspiring Guardsman
		ai_chance = { factor = 40 }
		#trigger = {
		#	has_heir = no
		#}
		if = {
			limit = {
				has_active_policy = mandatory_service 
			}
			if = {
				limit = {
					has_country_flag = vov_female_heir_varangians
				}
				define_ruler = {
					dip = 1
					mil = 2
					max_random_adm = 3
					max_random_dip = 4
					##max_age = 30
					male = yes 
				}
				vov_varangian_heir_ruler_general = { RULER_FEMALE = yes }
			}
			else = {
				define_ruler = {
					dip = 1
					mil = 2
					max_random_adm = 3
					max_random_dip = 4
					##max_age = 30
					male = yes 
				}
				vov_varangian_heir_ruler_general = { RULER_MALE = yes }
			}
		}
		else = {
			define_ruler = {
				dip = 1
				mil = 2
				max_random_adm = 3
				max_random_dip = 4
				##max_age = 30
				male = yes
			}
			vov_varangian_heir_ruler_general = { RULER_MALE = yes }
		}
		
	}
	option = {
		name = "nhs_vov_varangian_order_events.22.b"	# A veteran
		#trigger = {
			#has_heir = no
		#}
		ai_chance = { factor = 40 }
		if = {
			limit = { 
				has_active_policy = mandatory_service 
			}
			if = {
				limit = {
					has_country_flag = vov_female_heir_varangians
				}
				define_ruler = {
					adm = 1
					mil = 1
					max_random_adm = 5
					max_random_dip = 5
					max_random_mil = 5
					#min_age = 40
					female = yes 
				}
				vov_varangian_heir_ruler_general = { RULER_FEMALE = yes }
			}
			else = {
				define_ruler = {
					adm = 1
					mil = 1
					max_random_adm = 5
					max_random_dip = 5
					max_random_mil = 5
					#min_age = 40
					male = yes 
				}
				vov_varangian_heir_ruler_general = { RULER_MALE = yes }
			}
		}
		else = {
			define_ruler = {
				adm = 1
				mil = 1
				max_random_adm = 5
				max_random_dip = 5
				max_random_mil = 5
				#min_age = 40
				male = yes 
			}
			vov_varangian_heir_ruler_general = { RULER_MALE = yes }
		}
	}


#	option = { # Nepotism choice, re-electing within dynasty
#		name = "nhs_vov_varangian_order_events.22.c"
#		#trigger = {
#		#	has_government_attribute = enables_nepotism
#			#has_heir = no
#		#}
#		ai_chance = { factor = 10 }
#		add_republican_tradition = -10
#		if = {
#			limit = { 
#				has_active_policy = mandatory_service 
#			}
#			if = {
#				limit = {
#					has_country_flag = vov_female_heir_varangians
#				}
#				define_ruler = {
#					dip = 1
#					mil = 1
#					max_random_adm = 2
#					max_random_dip = 3
#					#min_age = 30
#					##max_age = 50
#					name = "lastname"
#					female = yes 
#				}
#				vov_varangian_heir_ruler_general = { RULER_FEMALE = yes }
#			}
#			else = {
#				define_ruler = {
#					dip = 1
#					mil = 1
#					max_random_adm = 2
#					max_random_dip = 3
#					#min_age = 30
#					##max_age = 50
#					name = "lastname"
#					male = yes 
#				}
#				vov_varangian_heir_ruler_general = { RULER_MALE = yes }
#			}
#		}
#		else = {
#			define_ruler = {
#				dip = 1
#				mil = 1
#				max_random_adm = 2
#				max_random_dip = 3
#				#min_age = 30
#				##max_age = 50
#				male = yes
#				name = "lastname"
#			}
#			vov_varangian_heir_ruler_general = { RULER_MALE = yes }
#		}
#		add_stability = -1
#	}
}

# Election on 65 years!
country_event = {
	id = nhs_vov_varangian_order_events.23
	title = nhs_vov_varangian_order_events.21.t
	desc = nhs_vov_varangian_order_events.21.d
	picture = ELECTION_REPUBLICAN_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_reform = varangian_guard
		NOT = { has_country_flag = vov_vrg_has_election }
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = vov_vrg_has_election
			random_list = {
				95 = {
					clr_country_flag = vov_female_heir_varangians
				}
				5 = {
					set_country_flag = vov_female_heir_varangians
				}
			}
			set_saved_name = {
				key = vov_vrg_name_one
				type = advisor
				scope = ROOT
			}
			set_saved_name = {
				key = vov_vrg_name_two
				type = advisor
				name = ROOT
			}
		}
	}
	
	after = {
		clr_country_flag = vov_female_heir_varangians
		clear_saved_name = vov_vrg_name_one
		clear_saved_name = vov_vrg_name_two
		clr_country_flag = vov_vrg_has_election
	}

	option = {
		name = "nhs_vov_varangian_order_events.21.a"	# Current ruler stays
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { republican_tradition = 75 }
			}	
		}
		custom_tooltip = remains_ruler
		if = {
			limit = {
				NOT = { adm = 5 }
			}
			change_adm = 2
		}
		else_if = {
			limit = {
				NOT = { adm = 6 }
			}
			change_adm = 1
		}
		if = {
			limit = {
				NOT = { dip = 5 }
			}
			change_dip = 2
		}
		else_if = {
			limit = {
				NOT = { dip = 6 }
			}
			change_dip = 1
		}
		if = {
			limit = {
				NOT = { mil = 2 }
			}
			change_mil = 2
		}
		else_if = {
			limit = {
				NOT = { mil = 6 }
			}
			change_mil = 1
		}
		add_republican_tradition = -25
		random_list = {
			10 = {
				add_adm_power = 50
			}
			10 = {
				add_dip_power = 50
			}
			10 = {
				add_mil_power = 50
			}
		}
	}
	option = {
		name = "nhs_vov_varangian_order_events.21.b"
		trigger = {
			has_heir = yes
		}
		ai_chance = {
			factor = 50	
		}
		if = {
			limit = {
				NOT = { heir_adm = 6 }
				NOT = { heir_dip = 6 }
				NOT = { heir_mil = 6 }
			}
			random_list = {
				10 = {
					change_heir_adm = 1
				}
				10 = {
					change_heir_dip = 1
				}
				10 = {
					change_heir_mil = 1
				}
			}
		}
		else_if = {
			limit = {
				heir_adm = 6
				NOT = { heir_dip = 6 }
				NOT = { heir_mil = 6 }
			}
			random_list = {
				10 = {
					change_heir_dip = 1
				}
				10 = {
					change_heir_mil = 1
				}
			}
		}
		else_if = {
			limit = {
				heir_dip = 6
				NOT = { heir_adm = 6 }
				NOT = { heir_mil = 6 }
			}
			random_list = {
				10 = {
					change_heir_adm = 1
				}
				10 = {
					change_heir_mil = 1
				}
			}
		}
		else_if = {
			limit = {
				heir_mil = 6
				NOT = { heir_adm = 6 }
				NOT = { heir_dip = 6 }
			}
			random_list = {
				10 = {
					change_heir_adm = 1
				}
				10 = {
					change_heir_dip = 1
				}
			}
		}
		else_if = {
			limit = {
				heir_mil = 6
				heir_adm = 6
				NOT = { heir_dip = 6 }
			}
			change_heir_dip = 1
		}
		else_if = {
			limit = {
				heir_mil = 6
				heir_dip = 6
				NOT = { heir_adm = 6 }
			}
			change_heir_adm = 1
		}
		else_if = {
			limit = {
				heir_dip = 6
				heir_adm = 6
				NOT = { heir_mil = 6 }
			}
			change_heir_mil = 1
		}
		else_if = {
			limit = {
				heir_dip = 6
				heir_adm = 6
				heir_mil = 6
			}
			add_adm_power = 100
			add_dip_power = 100
			add_mil_power = 100
		}
		
		#hidden_effect = {
			exile_ruler_as = vov_ruler_varangian
			#set_ruler = vov_heir_varangian
		#}
		clr_country_flag = vov_varangian_has_heir
	}
	option = {
		name = "nhs_vov_varangian_order_events.21.c"	# Aspiring Guardsman
		ai_chance = { factor = 40 }
		trigger = {
			has_heir = no
		}
		define_ruler = {
			name = vov_vrg_name_one
			dip = 1
			mil = 2
			max_random_adm = 3
			max_random_dip = 4
			##max_age = 30
			male = yes
		}
		vov_varangian_heir_ruler_general = { RULER_MALE = yes }
	}
	option = {
		name = "nhs_vov_varangian_order_events.21.e"	# A veteran
		trigger = {
			has_heir = no
		}
		ai_chance = { factor = 40 }
		define_ruler = {
			name = vov_vrg_name_two
			adm = 1
			mil = 1
			max_random_adm = 5
			max_random_dip = 5
			max_random_mil = 5
			#min_age = 40
			male = yes 
		}
		vov_varangian_heir_ruler_general = { RULER_MALE = yes }
	}
}