# Tier I

elysian_empire = {
	icon = "elysian_empire"
	allow_normal_conversion = no
	potential = {
		#has_reform = elysian_empire
		nhs_check_all_elysian_tags = { CONDITION = tag }
	}
	fixed_rank = 2
	#lock_level_when_selected = yes
	valid_for_new_country = no
	can_change_primary_culture = no
	trigger = {
		NOT = { has_reform = senatorial_empire }
		NOT = { have_had_reform = senatorial_empire }
	}
	modifiers = {
		num_accepted_cultures = -1
		stability_cost_modifier = 0.20
	}
	conditional = {
		allow = {	
			has_global_flag = nhs_enable_venetian_merchant_estate_g
			has_dlc = "Res Publica"
		}
		can_use_trade_post = yes
	}
	custom_attributes = {
		locked_government_type = yes
		to_can_summon_roman_militia = yes
	}
}

senatorial_empire = {
	icon = "senatorial_empire"
	allow_normal_conversion = no
	can_change_primary_culture = no
	potential = {
		#has_reform = senatorial_empire
		nhs_check_all_elysian_tags = { CONDITION = tag }
	}
	trigger = {
		has_reform = senatorial_empire
		NOT = { has_reform = nhs_reduce_senate_reform }
	}
	fixed_rank = 3
	#lock_level_when_selected = yes
	valid_for_new_country = no
	modifiers = {
		legitimacy = 0.5
		max_absolutism = -15
		min_autonomy_in_territories = -0.05
		governing_capacity = 100
	}
	conditional = {
		allow = { 
			OR = {
				has_dlc = "Common Sense"
				has_dlc = "Domination"
			}
			NOT = {
				AND = {
					has_dlc = "Res Publica"
					has_global_flag = nhs_enable_venetian_merchant_estate_g
				}
			}
		}
		has_parliament = yes
	}
	conditional = {
		allow = {
			has_dlc = "Res Publica"
			has_global_flag = nhs_enable_venetian_merchant_estate_g
			NOT = { 
				OR = {
					has_dlc = "Common Sense"
					has_dlc = "Domination"
				}
			}
		}
		can_use_trade_post = yes
	}
	conditional = {
		allow = {	
			has_global_flag = nhs_enable_venetian_merchant_estate_g
			has_dlc = "Res Publica"
			OR = {
				has_dlc = "Common Sense"
				has_dlc = "Domination"
			}
		}
		has_parliament = yes
		can_use_trade_post = yes
	}
	custom_attributes = {
		locked_government_type = yes
	}
}

elysian_patriarchy = {
	icon = "elysian_patriarchy"
	allow_normal_conversion = no
	potential = {
		has_reform = elysian_patriarchy
	}
	fixed_rank = 3
	lock_level_when_selected = yes
	valid_for_new_country = no
	can_change_primary_culture = no
	modifiers = {
		tolerance_own = 2
		tolerance_heretic = -1
		tolerance_heathen = -1
		global_autonomy = -0.025
		#max_states = 2
		governing_capacity = 100
		max_absolutism = 5
	}
	conditional = {
		allow = {
			OR = {
				has_dlc = "Common Sense"
				has_dlc = "Domination"
			}
			NOT = {
				AND = {
					has_dlc = "Res Publica"
					has_global_flag = nhs_enable_venetian_merchant_estate_g
				}
			}
		}
		has_parliament = yes
	}
	conditional = {
		allow = {
			has_dlc = "Res Publica"
			has_global_flag = nhs_enable_venetian_merchant_estate_g
			NOT = { 
				OR = {
					has_dlc = "Common Sense"
					has_dlc = "Domination"
				}
			}
		}
		can_use_trade_post = yes
	}
	conditional = {
		allow = {
			has_global_flag = nhs_enable_venetian_merchant_estate_g
			has_dlc = "Res Publica"
			OR = {
				has_dlc = "Common Sense"
				has_dlc = "Domination"
			}
		}
		has_parliament = yes
		can_use_trade_post = yes
	}
	custom_attributes = {
		locked_government_type = yes
		enables_divine_idea_group = yes
		enables_aristocratic_idea_group = no
	}
}
elysian_patriarchy_2 = {
	icon = "elysian_patriarchy_2"
	allow_normal_conversion = no
	potential = {
		has_reform = elysian_patriarchy_2
	}
	lock_level_when_selected = yes
	valid_for_new_country = no
	modifiers = {
		tolerance_own = 2
		tolerance_heretic = -1
		tolerance_heathen = -1
		#max_states = 1
		governing_capacity = 50
		max_absolutism = 5
	}
	
	custom_attributes = {
		locked_government_type = yes
		enables_divine_idea_group = yes
		enables_aristocratic_idea_group = no
	}
}

elysian_absolute_empire = {
	icon = "elysian_absolute_empire"
	allow_normal_conversion = no
	potential = {
		#has_reform = elysian_absolute_empire
		nhs_check_all_elysian_tags = { CONDITION = tag }
	}
	trigger = {
		has_reform = nhs_reduce_senate_reform
	}
	#lock_level_when_selected = yes
	valid_for_new_country = no
	can_change_primary_culture = no
	fixed_rank = 3
	modifiers = {
		governing_capacity = 100
		unjustified_demands = -0.15
		global_autonomy = -0.05
		national_focus_years = -10

		allow_free_estate_privilege_revocation = yes
		all_estate_loyalty_equilibrium = -0.1
		all_estate_influence_modifier = -0.15
	}
	# conditional = {
		# allow = { has_dlc = "Common Sense" }
		# has_parliament = no
	# }
	conditional = {
		allow = {	
			has_global_flag = nhs_enable_venetian_merchant_estate_g
			has_dlc = "Res Publica"
		}
		can_use_trade_post = yes
	}
	custom_attributes = {
		locked_government_type = yes
	}
}

# Tier XI

royal_decree_reform_ely = {
	icon = "king"
	potential = {
		has_reform = senatorial_empire
	}
	allow_normal_conversion = yes
	modifiers = {
		max_absolutism = 5
		yearly_absolutism = 0.5
	}
	ai = {
		factor = 1
	}
}

aristocratic_court_reform_ely = {
	icon = "soldiers_2"
	potential = {
		has_reform = senatorial_empire
	}
	allow_normal_conversion = yes
	modifiers = {
		diplomatic_reputation = 1
		monthly_favor_modifier = 0.25
		improve_relation_modifier = 0.15
	}
	ai = {
		factor = 1
	}
}

general_estates_reform_ely = {
	icon = "paper_with_seal"
	potential = {
		has_reform = senatorial_empire
	}
	allow_normal_conversion = yes
	modifiers = {
		monthly_reform_progress_modifier = 0.1
		all_estate_influence_modifier = 0.05
		all_estate_loyalty_equilibrium = 0.1
	}
	ai = {
		factor = 1
	}
}


# TIER IX

letat_cest_moi_reform_ely = {
	icon = "queen"
	potential = {
		OR = {
			has_reform = elysian_empire
			# has_reform = elysian_revolutionary_empire
			has_reform = elysian_absolute_empire
		}
	}
	trigger = {
		NOT = { has_reform = senatorial_empire }
	}
	allow_normal_conversion = yes
	modifiers = {
		governing_capacity = 250
	}
	ai = {
		factor = 1.5
	}
}

regional_representation_reform_ely = {
	icon = "assembly_hall"
	potential = {
		OR = {
			# has_reform = elysian_revolutionary_empire
			has_reform = elysian_absolute_empire
		}
	}
	trigger = {
		NOT = { has_reform = senatorial_empire }
	}
	allow_normal_conversion = yes
	modifiers = {
		min_autonomy_in_territories = -0.05
		core_creation = -0.05
	}
}

nhs_expand_senate_of_cities = {
	icon = "parliament"
	potential = {
		OR = {
			has_reform = senatorial_empire
			has_reform = elysian_patriarchy
		}
	}
	modifiers = {
		core_creation = -0.10
		diplomatic_upkeep = -1
		max_absolutism = -10
	}
	effect = {
		clr_country_flag = nhs_remember_expanding_senate
	}
}

nhs_consolidate_senate_of_cities = {
	icon = "assembly_hall"
	potential = {
		OR = {
			has_reform = senatorial_empire
			has_reform = elysian_patriarchy
		}
	}
	modifiers = {
		free_adm_policy = 1
		state_governing_cost = -0.1
		national_focus_years = -10
	}
	# conditional = {
	# 	allow = { has_dlc = "Common Sense" }
	# 	custom_attributes = {
	# 		halved_parliament_bribes = yes
	# 	}
	# }
	effect = {
		set_country_flag = nhs_remember_consolidating_senate
	}
}

# TIER X

nhs_reduce_senate_reform = {
	icon = "nhs_reduce_senate_reform"
	allow_normal_conversion = yes
	modifiers = {
		max_absolutism = 10
		yearly_absolutism = 1.5
	}
	potential = {
		OR = {
			has_reform = senatorial_empire
			has_reform = elysian_absolute_empire
			# has_reform = elysian_revolutionary_empire
		}
	}
	trigger = {
		if = {
			limit = {
				NOT = { has_reform = nhs_reduce_senate_reform }
			}
			OR = {
				current_age = age_of_absolutism
				current_age = age_of_revolutions
			}
			absolutism = 50
			stability = 1
			crown_land_share = 50
			# has_reform = centralize_reform
			# has_reform = royal_decree_reform_ely
			custom_trigger_tooltip = {
				tooltip = nhs_nhs_reduce_senate2_tt
				NOT = { has_ruler_flag = nhs_changed_to_abs }
			}
		}
		else = {
			has_reform = nhs_reduce_senate_reform
		}
	}
	effect = {
		if = {
			limit = {
				NOT = { has_country_flag = nhs_no_reduce_senate_effect }
				has_reform = senatorial_empire
			}
			custom_tooltip = to_reform_effects_tt
			to_add_government_reform_short_tooltip = { REFORM = elysian_absolute_empire }
			to_add_government_reform_short_tooltip = { REFORM = royal_decree_reform }
			to_add_government_reform_short_tooltip = { REFORM = letat_cest_moi_reform_ely }
			add_absolutism = 5
			add_stability = -2
			add_legitimacy = -30
			remove_country_modifier = nhs2_patriarch_influences_major
			remove_country_modifier = nhs2_patriarch_influences_minor
			change_estate_land_share = {
				estate = all
				share = -10
			}
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = nhs_no_reduce_senate_effect }
				has_reform = elysian_absolute_empire
			}
			custom_tooltip = to_reform_effects_tt
			tooltip = {
				to_add_government_reform_short_tooltip = { REFORM = elysian_absolute_empire }
				to_add_government_reform_short_tooltip = { REFORM = royal_decree_reform }
				to_add_government_reform_short_tooltip = { REFORM = letat_cest_moi_reform_ely }
				add_absolutism = 5
				add_stability = -2
				add_legitimacy = -30
				remove_country_modifier = nhs2_patriarch_influences_major
				remove_country_modifier = nhs2_patriarch_influences_minor
				change_estate_land_share = {
					estate = all
					share = -10
				}
			}
		}
		# custom_tooltip = nhs_path_to_revolution_tt
		# custom_tooltip = nhs_new_line_tt
		hidden_effect = {
			set_ruler_flag = nhs_changed_to_abs
		}
	}
}

legislative_houses_reform_ely = {
	icon = "parliament_hall"
	allow_normal_conversion = yes
	potential = {
		has_reform = senatorial_empire
	}
	modifiers = {
		free_policy = 1
	}
}

nhs_empower_senate_reform = {
	icon = "parliament_hall"
	allow_normal_conversion = yes
	potential = {
		has_reform = elysian_absolute_empire
	}
	trigger = {
		custom_trigger_tooltip = {
			tooltip = nhs_nhs_reduce_senate2_tt
			NOT = { has_ruler_flag = nhs_changed_to_abs }
		}
	}
	effect = {
		if = {
			limit = {
				has_reform = elysian_absolute_empire
			}
			custom_tooltip = to_reform_effects_tt
			if = {
				limit = {
					has_reform = royal_decree_reform_ely
				}
				remove_government_reform = royal_decree_reform_ely
			}
			to_add_government_reform_short_tooltip = { REFORM = senatorial_empire }
			if = {
				limit = {
					has_country_flag = nhs_remember_consolidating_senate
				}
				to_add_government_reform_short_tooltip = { REFORM = nhs_consolidate_senate_of_cities }
			}
			else = {
				to_add_government_reform_short_tooltip = { REFORM = nhs_expand_senate_of_cities }
			}
			to_add_government_reform_short_tooltip = { REFORM = legislative_houses_reform_ely }
			
			add_stability_or_adm_power = yes
			add_legitimacy = 20
			add_adm_power = -50
			add_absolutism = -20
			#if = {
			#	limit = {
			#		has_country_modifier = rev_absolute_authority
			#	}
			#	remove_country_modifier = rev_absolute_authority
			#}
			if = {
				limit = {
					has_country_modifier = rev_absolute_authority
				}
				remove_country_modifier = rev_absolute_authority
			}
			if = {
				limit = {
					OR = {
						has_dlc = "Common Sense"
						has_dlc = "Domination"
					}
				}
				custom_tooltip = nhs_nhs_seats_tt
				hidden_effect = {
					every_owned_province = {
						limit = {
							OR = {
								province_id = 2550
								province_id = 952
								province_id = 950
								province_id = 2554
								province_id = 953
								province_id = 957
							}
						}
						set_seat_in_parliament = yes
					}
				}
			}
		}
		hidden_effect = {
			set_ruler_flag = nhs_changed_to_abs
		}
	}
	conditional = {
		allow = { 
			OR = {
				has_dlc = "Common Sense"
				has_dlc = "Domination"
			}
		}
		has_parliament = yes
	}
	modifiers = {
		possible_adm_policy = 1
		global_unrest = -1
	}
}