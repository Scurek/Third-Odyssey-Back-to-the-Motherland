
to_remove_all_idea_groups = {
	remove_idea_group = development_ideas
	remove_idea_group = discovery_ideas
	remove_idea_group = domination_ideas
	remove_idea_group = aristocracy_ideas
	remove_idea_group = plutocracy_ideas
	remove_idea_group = horde_gov_ideas
	remove_idea_group = theocracy_gov_ideas
	remove_idea_group = indigenous_ideas
	remove_idea_group = innovativeness_ideas
	remove_idea_group = religious_ideas
	remove_idea_group = spy_ideas
	remove_idea_group = diplomatic_ideas
	remove_idea_group = offensive_ideas
	remove_idea_group = defensive_ideas
	remove_idea_group = trade_ideas
	remove_idea_group = economic_ideas
	remove_idea_group = exploration_ideas
	remove_idea_group = maritime_ideas
	remove_idea_group = quality_ideas
	remove_idea_group = quantity_ideas
	remove_idea_group = expansion_ideas
	remove_idea_group = administrative_ideas
	remove_idea_group = humanist_ideas
	remove_idea_group = influence_ideas
	remove_idea_group = naval_ideas
}

to_replace_idea_group_with_exploration = {
	remove_idea_group = $IDEA_GROUP$
	add_idea_group = exploration_ideas
}

to_replace_idea_group_with_exploration_keep_progress = {
	if = {
		limit = {
			has_idea_group = $IDEA_GROUP$
			NOT = { has_idea_group = exploration_ideas }
		}
		if = {
			limit = {
				$IDEA_GROUP$ = 7
			}
			to_replace_idea_group_with_exploration = { IDEA_GROUP = $IDEA_GROUP$ }
			add_idea = global_empire
		}
		else_if = {
			limit = {
				$IDEA_GROUP$ = 6
			}
			to_replace_idea_group_with_exploration = { IDEA_GROUP = $IDEA_GROUP$ }
			add_idea = free_colonies
		}
		else_if = {
			limit = {
				$IDEA_GROUP$ = 5
			}
			to_replace_idea_group_with_exploration = { IDEA_GROUP = $IDEA_GROUP$ }
			add_idea = vice_roys
		}
		else_if = {
			limit = {
				$IDEA_GROUP$ = 4
			}
			to_replace_idea_group_with_exploration = { IDEA_GROUP = $IDEA_GROUP$ }
			add_idea = land_of_opportunity
		}
		else_if = {
			limit = {
				$IDEA_GROUP$ = 3
			}
			to_replace_idea_group_with_exploration = { IDEA_GROUP = $IDEA_GROUP$ }
			add_idea = overseas_exploration
		}
		else_if = {
			limit = {
				$IDEA_GROUP$ = 2
			}
			to_replace_idea_group_with_exploration = { IDEA_GROUP = $IDEA_GROUP$ }
			add_idea = colonial_ventures
		}
		else_if = {
			limit = {
				$IDEA_GROUP$ = 1
			}
			to_replace_idea_group_with_exploration = { IDEA_GROUP = $IDEA_GROUP$ }
			add_idea = quest_for_the_new_world
		}
		else = {
			to_replace_idea_group_with_exploration = { IDEA_GROUP = $IDEA_GROUP$ }
		}
	}
}

to_replace_idea_group_with_exploration_for_ai = {
	if = {
		limit = {
			has_idea_group = spy_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = spy_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = maritime_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = maritime_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = indigenous_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = indigenous_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = administrative_ideas
			NOt = { full_idea_group = administrative_ideas }
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = administrative_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = influence_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = influence_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = diplomatic_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = diplomatic_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = innovativeness_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = innovativeness_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = trade_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = trade_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = economic_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = economic_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = humanist_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = humanist_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = religious_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = religious_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = plutocracy_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = plutocracy_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = horde_gov_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = horde_gov_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = theocracy_gov_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = theocracy_gov_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = aristocracy_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = aristocracy_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = naval_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = naval_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = offensive_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = offensive_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = defensive_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = defensive_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = quality_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = quality_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = quantity_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = quantity_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = expansion_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = expansion_ideas }
	}
	else_if = {
		limit = {
			has_idea_group = administrative_ideas
		}
		to_replace_idea_group_with_exploration_keep_progress = { IDEA_GROUP = administrative_ideas }
	}
}

to_replace_idea_group_with_exploration_master_effect = {
	if = {
		limit = {
			NOT = { has_idea_group = exploration_ideas }
			to_there_is_a_switchable_idea_group = yes
		}
		if = {
			limit = {
				ai = no
			}
			if = {
				limit = {
					adm_tech = 5
					NOT = { adm_tech = 7 }
					OR = {
						has_idea_group = spy_ideas
						has_idea_group = maritime_ideas
						has_idea_group = indigenous_ideas
						has_idea_group = administrative_ideas
						has_idea_group = influence_ideas
						has_idea_group = diplomatic_ideas
						has_idea_group = innovativeness_ideas
						has_idea_group = trade_ideas
						has_idea_group = economic_ideas
						has_idea_group = humanist_ideas
						has_idea_group = religious_ideas
						has_idea_group = plutocracy_ideas
						has_idea_group = horde_gov_ideas
						has_idea_group = theocracy_gov_ideas
						has_idea_group = aristocracy_ideas
						has_idea_group = naval_ideas
						has_idea_group = offensive_ideas
						has_idea_group = defensive_ideas
						has_idea_group = quality_ideas
						has_idea_group = quantity_ideas
						has_idea_group = expansion_ideas
					}
				}
				# Also works for the player if they only have a single idea group
				to_replace_idea_group_with_exploration_for_ai = yes
			}
			if = {
				limit = {
					NOT = {
						AND = {
							adm_tech = 5
							NOT = { adm_tech = 7 }
							OR = {
								has_idea_group = spy_ideas
								has_idea_group = maritime_ideas
								has_idea_group = indigenous_ideas
								has_idea_group = administrative_ideas
								has_idea_group = influence_ideas
								has_idea_group = diplomatic_ideas
								has_idea_group = innovativeness_ideas
								has_idea_group = trade_ideas
								has_idea_group = economic_ideas
								has_idea_group = humanist_ideas
								has_idea_group = religious_ideas
								has_idea_group = plutocracy_ideas
								has_idea_group = horde_gov_ideas
								has_idea_group = theocracy_gov_ideas
								has_idea_group = aristocracy_ideas
								has_idea_group = naval_ideas
								has_idea_group = offensive_ideas
								has_idea_group = defensive_ideas
								has_idea_group = quality_ideas
								has_idea_group = quantity_ideas
								has_idea_group = expansion_ideas
							}
						}
					}
				}
				custom_tooltip = nhs_new_line_tt
				# custom_tooltip = to_event_to_switch_idea_groups_tt
				country_event = { id = to_colonialism_events.3 tooltip = to_event_to_switch_idea_groups_tt }
			}
		}
		else = {
			to_replace_idea_group_with_exploration_for_ai = yes
		}
	}
	else_if = {
		limit = {
			NOT = { has_idea_group = exploration_ideas }
			adm_tech = 5
		}
		add_idea_group = exploration_ideas
	}
}

to_trigger_colonialism_events_no_portugal = {
	every_country = {
		limit = {
			NOT = { tag = ROOT }
			technology_group = western
			adm_tech = 5
			is_subject = no
			OR = {
				ai = no
				AND = {
					num_of_cities = 8
					num_of_owned_provinces_with = {
						value = 3
						has_port = yes
						continent = europe
						sea_zone = {
							region = north_atlantic_region
						}
					}
				}
			}
			OR = {
				tag = POR
				AND = {
					adm_tech = 7
					OR = {
						tag = GBR
						tag = SPA
						tag = CAS
						tag = NED
					}
				}
				AND = {
					adm_tech = 10
					OR = {
						tag = ENG
						tag = FRA
						capital_scope = {
							OR = {
								region = france_region
								region = iberia_region
								region = british_isles_region
								region = low_countries_region
							}
						}
					}
				}
			}
			any_owned_province = {
				has_port = yes
				continent = europe
				sea_zone = {
					region = north_atlantic_region
				}
			}
		}
		country_event = { id = to_colonialism_events.2 }
	}
	hidden_effect = {
		every_country = {
			limit = {
				nhs_check_all_elysian_tags = { CONDITION = tag }
			}
			country_event = { id = to_colonialism_events.5 }
		}
		every_country = {
			limit = {
				NOT = { tag = ROOT }
				NOT = { nhs_check_all_elysian_tags = { CONDITION = tag } }
				ai = no
				NOT = {
					AND = {
						technology_group = western
						OR = {
							tag = POR
							AND = {
								adm_tech = 7
								OR = {
									tag = GBR
									tag = SPA
									tag = CAS
									tag = NED
								}
							}
							AND = {
								adm_tech = 10
								OR = {
									tag = ENG
									tag = FRA
									capital_scope = {
										OR = {
											region = france_region
											region = iberia_region
											region = british_isles_region
											region = low_countries_region
										}
									}
								}
							}
						}
						any_owned_province = {
							has_port = yes
							continent = europe
							sea_zone = {
								region = north_atlantic_region
							}
						}
					}
				}
			}
			if = {
				limit = {
					knows_country = ROOT
				}
				country_event = { id = institution_events.300 }
			}
			else = {
				country_event = { id = institution_events.301 }
			}
		}
	}
}

to_development_events_add_next_flag = {
	# if = {
	# 	limit = {
	# 		has_province_flag = nhs_had_dev_events_2
	# 	}
	# 	set_province_flag = nhs_had_dev_events_3
	# }
	if = {
		limit = {
			has_province_flag = nhs_had_dev_events_1
		}
		set_province_flag = nhs_had_dev_events_2
	}
	else = {
		set_province_flag = nhs_had_dev_events_2
	}
}

to_add_2_stability_or_adm_power = {
	if = {
		limit = {
			stability = 3
		}
		add_adm_power = 100
	}
	else_if = {
		limit = {
			stability = 2
		}
		add_stability = 1
		add_adm_power = 50
	}
	else = {
		add_stability = 2
	}
}

to_round_up_variable = {
	change_variable = {
		which = $VARIABLE$
		value = 0.5
	}
	multiply_variable = { 
		which = $VARIABLE$
		value = 0.001 
	}
	multiply_variable = { 
		which = $VARIABLE$
		value = 1000 
	}
}

to_save_historal_friends_and_rivals = {
	hidden_effect = {
		every_country = {
			limit = {
				historical_friend_with = ROOT
			}
			set_country_flag = to_historical_friend_with_ROOT
			remove_historical_friend = ROOT
		}
		every_country = {
			limit = {
				ROOT = {
					historical_friend_with = PREV
				}
			}
			set_country_flag = to_ROOT_historical_friend_with_TAG
			ROOT = {
				remove_historical_friend = PREV
			}
		}
		every_country = {
			limit = {
				historical_rival_with = ROOT
			}
			set_country_flag = to_historical_rival_with_ROOT
			remove_historical_rival = ROOT
		}
		every_country = {
			limit = {
				ROOT = {
					historical_rival_with = PREV
				}
			}
			set_country_flag = to_ROOT_historical_rival_with_TAG
			ROOT = {
				remove_historical_rival = PREV
			}
		}
	}
}

to_load_historal_friends_and_rivals = {
	hidden_effect = {
		every_country = {
			limit = {
				has_country_flag = to_historical_friend_with_ROOT
			}
			clr_country_flag = to_historical_friend_with_ROOT
			add_historical_friend = ROOT
		}
		every_country = {
			limit = {
				has_country_flag = to_ROOT_historical_friend_with_TAG
			}
			clr_country_flag = to_ROOT_historical_friend_with_TAG
			ROOT = {
				add_historical_friend = PREV
			}
		}
		every_country = {
			limit = {
				has_country_flag = to_historical_rival_with_ROOT
			}
			clr_country_flag = to_historical_rival_with_ROOT
			add_historical_rival = ROOT
		}
		every_country = {
			limit = {
				has_country_flag = to_ROOT_historical_rival_with_TAG
			}
			clr_country_flag = to_ROOT_historical_rival_with_TAG
			ROOT = {
				add_historical_rival = PREV
			}
		}
	}
}

to_restore_historal_friends_and_rivals = {
	hidden_effect = {
		every_country = {
			limit = {
				$PREVIOUS_TAG$ = {
					historical_friend_with = PREV
				}
			}
			$PREVIOUS_TAG$ = {
				remove_historical_friend = PREV
			}
			ROOT = {
				add_historical_friend = PREV
			}
		}
		every_country = {
			limit = {
				$PREVIOUS_TAG$ = {
					PREV = {
						historical_friend_with = PREV
					}
				}
			}
			$PREVIOUS_TAG$ = {
				PREV = {
					remove_historical_friend = PREV
				}
			}
			add_historical_friend = ROOT
		}
		every_country = {
			limit = {
				$PREVIOUS_TAG$ = {
					historical_rival_with = PREV
				}
			}
			$PREVIOUS_TAG$ = {
				remove_historical_rival = PREV
			}
			ROOT = {
				add_historical_rival = PREV
			}
		}
		every_country = {
			limit = {
				$PREVIOUS_TAG$ = {
					PREV = {
						historical_rival_with = PREV
					}
				}
			}
			$PREVIOUS_TAG$ = {
				PREV = {
					remove_historical_rival = PREV
				}
			}
			add_historical_rival = ROOT
		}
	}
}

to_monuments_later = {
	if = {
		limit = {
			$PROVINCE_ID$ = {
				construction_progress = 0
			}
		}
		if = {
			limit = {
				$PROVINCE_ID$ = {
					has_construction = colonist
				}
			}
			custom_tooltip = to_monuments_later_colonist_tt
		}
		else_if = {
			limit = {
				$PROVINCE_ID$ = {
					has_construction = missionary
				}
			}
			custom_tooltip = to_monuments_later_missionary_tt
		}
		else = {
			custom_tooltip = to_monuments_later_tt
		}
		custom_tooltip = nhs_new_line_tt
	}
}

to_correct_colony_culture = {
	if = {
		limit = {
			is_colonial_nation = yes
			NOT = { has_country_flag = to_colony_culture_corrected }
		}
		set_country_flag = to_colony_culture_corrected
		overlord = {
			if = {
				limit = {
					NOT = { culture_group = byzantine }
				}
				change_primary_culture = PREV
			}
			else = {
				PREV = {
					to_ely_country_culture_check = { 
						FLAG_SCOPE = PREV
						FLAG_SCOPE_BACKUP = yes
					}
				}
			}
			PREV = {
				change_religion = PREV
			}
		}
	}
}

to_subject_monument_mod_transfer = {
	if = {
		limit = {
			owner = {
				is_subject = yes
			}
		}
		custom_tooltip = to_subject_monument_mod_transfer_subject_tt
	}
	else = {
		custom_tooltip = to_subject_monument_mod_transfer_tt
	}
}

to_handle_subject_annexation_date = {
	if = {
		limit = {
			NOT = { has_country_flag = to_do_not_change_annexation_date }
		}
		clr_country_flag = to_became_a_subject
		set_country_flag = to_became_a_subject
		export_to_variable = {
			which = to_protectorate_annexation_year_20
			value = trigger_value:is_year
		}
		set_variable = {
			which = to_protectorate_annexation_year_50
			which = to_protectorate_annexation_year_20
		}
		change_variable = {
			which = to_protectorate_annexation_year_20
			value = 20
		}
		change_variable = {
			which = to_protectorate_annexation_year_50
			value = 50
		}
		export_to_variable = {
			which = to_protectorate_annexation_month
			value = trigger_value:is_month
		}
		change_variable = {
			which = to_protectorate_annexation_month
			value = 2
		}
		if = {
			limit = {
				check_variable = {
					which = to_protectorate_annexation_month
					value = 13
				}
			}
			change_variable = {
				which = to_protectorate_annexation_year_20
				value = 1
			}
			change_variable = {
				which = to_protectorate_annexation_year_50
				value = 1
			}
			set_variable = {
				which = to_protectorate_annexation_month
				value = 1
			}
		}
	}
}

to_set_isolation_to_VALUE = {
	custom_tooltip = to_set_isolation_to_$VALUE$_tt
	hidden_effect = {
		set_isolationism = 0
	}
}


nhs_save_previous_goods = {
    clr_province_flag = nhs_had_grain_tg
    clr_province_flag = nhs_had_wine_tg
    clr_province_flag = nhs_had_wool_tg
    clr_province_flag = nhs_had_cloth_tg
    clr_province_flag = nhs_had_fish_tg
    clr_province_flag = nhs_had_fur_tg
    clr_province_flag = nhs_had_salt_tg
    clr_province_flag = nhs_had_naval_supplies_tg
    clr_province_flag = nhs_had_copper_tg
    clr_province_flag = nhs_had_gold_tg
    clr_province_flag = nhs_had_iron_tg
    clr_province_flag = nhs_had_slaves_tg
    clr_province_flag = nhs_had_ivory_tg
    clr_province_flag = nhs_had_tea_tg
    clr_province_flag = nhs_had_chinaware_tg
    clr_province_flag = nhs_had_spices_tg
    clr_province_flag = nhs_had_coffee_tg
    clr_province_flag = nhs_had_cotton_tg
    clr_province_flag = nhs_had_sugar_tg
    clr_province_flag = nhs_had_tobacco_tg
    clr_province_flag = nhs_had_cocoa_tg
    clr_province_flag = nhs_had_silk_tg
    clr_province_flag = nhs_had_elysian_silk_tg
    clr_province_flag = nhs_had_skoros_silk_tg
    clr_province_flag = nhs_had_tropical_wood_tg
    clr_province_flag = nhs_had_dyes_tg
    clr_province_flag = nhs_had_norse_mead_tg
    clr_province_flag = nhs_had_livestock_tg
    clr_province_flag = nhs_had_incense_tg
    clr_province_flag = nhs_had_glass_tg
    clr_province_flag = nhs_had_gems_tg
    clr_province_flag = nhs_had_paper_tg
    clr_province_flag = nhs_had_coal_tg
    clr_province_flag = nhs_had_cloves_tg
    clr_province_flag = nhs_had_unknown_tg
    clr_province_flag = nhs_had_coal_2_tg
    clr_province_flag = nhs_had_nothing_tg
	if = { limit = { trade_goods = grain } set_province_flag = nhs_had_grain_tg }
    else_if = { limit = { trade_goods = wine } set_province_flag = nhs_had_wine_tg }
    else_if = { limit = { trade_goods = wool } set_province_flag = nhs_had_wool_tg }
    else_if = { limit = { trade_goods = cloth } set_province_flag = nhs_had_cloth_tg }
    else_if = { limit = { trade_goods = fish } set_province_flag = nhs_had_fish_tg }
    else_if = { limit = { trade_goods = fur } set_province_flag = nhs_had_fur_tg }
    else_if = { limit = { trade_goods = salt } set_province_flag = nhs_had_salt_tg }
    else_if = { limit = { trade_goods = naval_supplies } set_province_flag = nhs_had_naval_supplies_tg }
    else_if = { limit = { trade_goods = copper } set_province_flag = nhs_had_copper_tg }
    else_if = { limit = { trade_goods = gold } set_province_flag = nhs_had_gold_tg }
    else_if = { limit = { trade_goods = iron } set_province_flag = nhs_had_iron_tg }
    else_if = { limit = { trade_goods = slaves } set_province_flag = nhs_had_slaves_tg }
    else_if = { limit = { trade_goods = ivory } set_province_flag = nhs_had_ivory_tg }
    else_if = { limit = { trade_goods = tea } set_province_flag = nhs_had_tea_tg }
    else_if = { limit = { trade_goods = chinaware } set_province_flag = nhs_had_chinaware_tg }
    else_if = { limit = { trade_goods = spices } set_province_flag = nhs_had_spices_tg }
    else_if = { limit = { trade_goods = coffee } set_province_flag = nhs_had_coffee_tg }
    else_if = { limit = { trade_goods = cotton } set_province_flag = nhs_had_cotton_tg }
    else_if = { limit = { trade_goods = sugar } set_province_flag = nhs_had_sugar_tg }
    else_if = { limit = { trade_goods = tobacco } set_province_flag = nhs_had_tobacco_tg }
    else_if = { limit = { trade_goods = cocoa } set_province_flag = nhs_had_cocoa_tg }
    else_if = { limit = { trade_goods = silk } set_province_flag = nhs_had_silk_tg }
    else_if = { limit = { trade_goods = elysian_silk } set_province_flag = nhs_had_elysian_silk_tg }
    else_if = { limit = { trade_goods = skoros_silk } set_province_flag = nhs_had_skoros_silk_tg }
    else_if = { limit = { trade_goods = tropical_wood } set_province_flag = nhs_had_tropical_wood_tg }
    else_if = { limit = { trade_goods = dyes } set_province_flag = nhs_had_dyes_tg }
    else_if = { limit = { trade_goods = norse_mead } set_province_flag = nhs_had_norse_mead_tg }
    else_if = { limit = { trade_goods = livestock } set_province_flag = nhs_had_livestock_tg }
    else_if = { limit = { trade_goods = incense } set_province_flag = nhs_had_incense_tg }
    else_if = { limit = { trade_goods = glass } set_province_flag = nhs_had_glass_tg }
    else_if = { limit = { trade_goods = gems } set_province_flag = nhs_had_gems_tg }
    else_if = { limit = { trade_goods = paper } set_province_flag = nhs_had_paper_tg }
    else_if = { limit = { trade_goods = coal } set_province_flag = nhs_had_coal_tg }
    else_if = { limit = { trade_goods = cloves } set_province_flag = nhs_had_cloves_tg }
    else_if = { limit = { trade_goods = unknown } set_province_flag = nhs_had_unknown_tg }
    else_if = { limit = { trade_goods = coal_2 } set_province_flag = nhs_had_coal_2_tg }
    else_if = { limit = { trade_goods = nothing } set_province_flag = nhs_had_nothing_tg }
}

nhs_load_previous_goods = {
	if = { limit = { has_province_flag = nhs_had_grain_tg } change_trade_goods = grain }
	else_if = { limit = { has_province_flag = nhs_had_wine_tg } change_trade_goods = wine }
	else_if = { limit = { has_province_flag = nhs_had_wool_tg } change_trade_goods = wool }
	else_if = { limit = { has_province_flag = nhs_had_cloth_tg } change_trade_goods = cloth }
	else_if = { limit = { has_province_flag = nhs_had_fish_tg } change_trade_goods = fish }
	else_if = { limit = { has_province_flag = nhs_had_fur_tg } change_trade_goods = fur }
	else_if = { limit = { has_province_flag = nhs_had_salt_tg } change_trade_goods = salt }
	else_if = { limit = { has_province_flag = nhs_had_naval_supplies_tg } change_trade_goods = naval_supplies }
	else_if = { limit = { has_province_flag = nhs_had_copper_tg } change_trade_goods = copper }
	else_if = { limit = { has_province_flag = nhs_had_gold_tg } change_trade_goods = gold }
	else_if = { limit = { has_province_flag = nhs_had_iron_tg } change_trade_goods = iron }
	else_if = { limit = { has_province_flag = nhs_had_slaves_tg } change_trade_goods = slaves }
	else_if = { limit = { has_province_flag = nhs_had_ivory_tg } change_trade_goods = ivory }
	else_if = { limit = { has_province_flag = nhs_had_tea_tg } change_trade_goods = tea }
	else_if = { limit = { has_province_flag = nhs_had_chinaware_tg } change_trade_goods = chinaware }
	else_if = { limit = { has_province_flag = nhs_had_spices_tg } change_trade_goods = spices }
	else_if = { limit = { has_province_flag = nhs_had_coffee_tg } change_trade_goods = coffee }
	else_if = { limit = { has_province_flag = nhs_had_cotton_tg } change_trade_goods = cotton }
	else_if = { limit = { has_province_flag = nhs_had_sugar_tg } change_trade_goods = sugar }
	else_if = { limit = { has_province_flag = nhs_had_tobacco_tg } change_trade_goods = tobacco }
	else_if = { limit = { has_province_flag = nhs_had_cocoa_tg } change_trade_goods = cocoa }
	else_if = { limit = { has_province_flag = nhs_had_silk_tg } change_trade_goods = silk }
	else_if = { limit = { has_province_flag = nhs_had_elysian_silk_tg } change_trade_goods = elysian_silk }
	else_if = { limit = { has_province_flag = nhs_had_skoros_silk_tg } change_trade_goods = skoros_silk }
	else_if = { limit = { has_province_flag = nhs_had_tropical_wood_tg } change_trade_goods = tropical_wood }
	else_if = { limit = { has_province_flag = nhs_had_dyes_tg } change_trade_goods = dyes }
	else_if = { limit = { has_province_flag = nhs_had_norse_mead_tg } change_trade_goods = norse_mead }
	else_if = { limit = { has_province_flag = nhs_had_livestock_tg } change_trade_goods = livestock }
	else_if = { limit = { has_province_flag = nhs_had_incense_tg } change_trade_goods = incense }
	else_if = { limit = { has_province_flag = nhs_had_glass_tg } change_trade_goods = glass }
	else_if = { limit = { has_province_flag = nhs_had_gems_tg } change_trade_goods = gems }
	else_if = { limit = { has_province_flag = nhs_had_paper_tg } change_trade_goods = paper }
	else_if = { limit = { has_province_flag = nhs_had_coal_tg } change_trade_goods = coal }
	else_if = { limit = { has_province_flag = nhs_had_cloves_tg } change_trade_goods = cloves }
	else_if = { limit = { has_province_flag = nhs_had_unknown_tg } change_trade_goods = unknown }
	else_if = { limit = { has_province_flag = nhs_had_coal_2_tg } change_trade_goods = coal_2 }
	else_if = { limit = { has_province_flag = nhs_had_nothing_tg } change_trade_goods = nothing }
	clr_province_flag = nhs_had_grain_tg
	clr_province_flag = nhs_had_wine_tg
	clr_province_flag = nhs_had_wool_tg
	clr_province_flag = nhs_had_cloth_tg
	clr_province_flag = nhs_had_fish_tg
	clr_province_flag = nhs_had_fur_tg
	clr_province_flag = nhs_had_salt_tg
	clr_province_flag = nhs_had_naval_supplies_tg
	clr_province_flag = nhs_had_copper_tg
	clr_province_flag = nhs_had_gold_tg
	clr_province_flag = nhs_had_iron_tg
	clr_province_flag = nhs_had_slaves_tg
	clr_province_flag = nhs_had_ivory_tg
	clr_province_flag = nhs_had_tea_tg
	clr_province_flag = nhs_had_chinaware_tg
	clr_province_flag = nhs_had_spices_tg
	clr_province_flag = nhs_had_coffee_tg
	clr_province_flag = nhs_had_cotton_tg
	clr_province_flag = nhs_had_sugar_tg
	clr_province_flag = nhs_had_tobacco_tg
	clr_province_flag = nhs_had_cocoa_tg
	clr_province_flag = nhs_had_silk_tg
	clr_province_flag = nhs_had_elysian_silk_tg
	clr_province_flag = nhs_had_skoros_silk_tg
	clr_province_flag = nhs_had_tropical_wood_tg
	clr_province_flag = nhs_had_dyes_tg
	clr_province_flag = nhs_had_norse_mead_tg
	clr_province_flag = nhs_had_livestock_tg
	clr_province_flag = nhs_had_incense_tg
	clr_province_flag = nhs_had_glass_tg
	clr_province_flag = nhs_had_gems_tg
	clr_province_flag = nhs_had_paper_tg
	clr_province_flag = nhs_had_coal_tg
	clr_province_flag = nhs_had_cloves_tg
	clr_province_flag = nhs_had_unknown_tg
	clr_province_flag = nhs_had_coal_2_tg
	clr_province_flag = nhs_had_nothing_tg
}

nhs_add_reform = {
	add_government_reform = $REF$
	# if = {
	# 	limit = {
	# 		has_dlc = "Dharma"
	# 	}
	# 	#[[REM]
	# 	#	remove_government_reform = $REM$
	# 	#]
	# 	add_government_reform = $REF$
	# }
}

nhs_add_gov_reform = {
	add_government_reform = $REF$
}

nhs_set_center_of_trade_1 = {
	custom_tooltip = nhs_add_center_of_trade_1_tt
	hidden_effect = {
		if = {
			limit = {
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
			center_of_trade = 1
		}
		else = {
			owner = {
				add_treasury = 50
			}
		}
	}
}

nhs_set_center_of_trade_2 = {
	custom_tooltip = nhs_add_center_of_trade_2_tt
	hidden_effect = {
		if = {
			limit = {
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
			center_of_trade = 2
		}
		else_if = {
			limit = {
				NOT = { province_has_center_of_trade_of_level = 2 }
			}
			add_center_of_trade_level = 1
		}
		else = {
			owner = {
				add_treasury = 100
			}
		}
	}
}

nhs_set_center_of_trade_3 = {
	custom_tooltip = nhs_add_center_of_trade_3_tt
	hidden_effect = {
		if = {
			limit = {
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
			center_of_trade = 3
		}
		else_if = {
			limit = {
				NOT = { province_has_center_of_trade_of_level = 3 }
			}
			add_center_of_trade_level = 2
		}
		else = {
			owner = {
				add_treasury = 500
			}
		}
	}
}

nhs_set_center_in_a_region_to_level_3 = {
	if = {
		limit = {
			any_owned_province = {
				$TYPE$ = $CNRG$
			}
			NOT = {
				any_province = {
					$TYPE$ = $CNRG$
					owner = {
						OR = {
							tag = ROOT
							is_subject_of = ROOT
						}
					}
					province_has_center_of_trade_of_level = 3
				}
			}
		}
		if = {
			limit = {
				any_owned_province = {
					$TYPE$ = $CNRG$
					province_has_center_of_trade_of_level = 2
				}
				
			}
			random_owned_province = {
				limit = {
					$TYPE$ = $CNRG$
					province_has_center_of_trade_of_level = 2
				}
				nhs_set_center_of_trade_3 = yes
			}
		}
		else_if = {
			limit = {
				any_owned_province = {
					$TYPE$ = $CNRG$
					province_has_center_of_trade_of_level = 1
				}
			}
			random_owned_province = {
				limit = {
					$TYPE$ = $CNRG$
					province_has_center_of_trade_of_level = 1
				}
				nhs_set_center_of_trade_3 = yes
			}
		}
		else = {
			random_owned_province = {
				limit = {
					$TYPE$ = $CNRG$
				}
				nhs_set_center_of_trade_3 = yes
			}
		}
	}
	else = {
		add_treasury = 1000
	}
}

nhs_set_center_in_a_region = {
	if = {
		limit = {
			any_owned_province = {
				$TYPE$ = $CNRG$
				province_has_center_of_trade_of_level = 1
				NOT = { province_has_center_of_trade_of_level = 2 }
			}
		}
		random_owned_province = {
			limit = {
				$TYPE$ = $CNRG$
				province_has_center_of_trade_of_level = 1
				NOT = { province_has_center_of_trade_of_level = 2 }
			}
			nhs_set_center_of_trade_2 = yes
		}
	}
	else_if = {
		limit = {
			any_owned_province = {
				nhs_eicticofminh = yes
				$TYPE$ = $CNRG$
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
		}
		random_owned_province = {
			limit = {
				nhs_eicticofminh = yes
				$TYPE$ = $CNRG$
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
			nhs_set_center_of_trade_1 = yes
		}
	}
	else_if = {
		limit = {
			any_province = {
				owner = {
					is_subject_of = ROOT
				}
				nhs_eicticofminh = yes
				$TYPE$ = $CNRG$
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
		}
		random_province = {
			limit = {
				owner = {
					is_subject_of = ROOT
				}
				nhs_eicticofminh = yes
				$TYPE$ = $CNRG$
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
			nhs_set_center_of_trade_1 = yes
		}
	}
	else_if = {
		limit = {
			any_province = {
				owner = {
					is_subject_of = ROOT
				}
				nhs_eicticofminh = yes
				$TYPE$ = $CNRG$
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
		}
		random__province = {
			limit = {
				owner = {
					is_subject_of = ROOT
				}
				nhs_eicticofminh = yes
				$TYPE$ = $CNRG$
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
			nhs_set_center_of_trade_1 = yes
		}
	}
	else = {
		add_treasury = 75
	}
}

nhs_change_government = {
	change_government = $GOV$
	# if = {
	# 	limit = {
	# 		has_dlc = "Dharma"
	# 		NOT = { government = $GOV$ }
	# 	}
	# 	change_government = $GOV$
	# }
	# [[LEGACY]
	# 	set_legacy_government = $LEGACY$
	# ]
}

to_add_government_reform_short_tooltip = {
	custom_tooltip = to_add_$REFORM$_gov_reform_tt
	hidden_effect = {
		add_government_reform = $REFORM$
	}
}