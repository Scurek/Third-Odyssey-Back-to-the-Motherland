# country
nhs_on_startup = {
	if = {
		limit = {
			NOT = { has_global_flag = to_setup_done }
		}
		nhs_set_up_empty_province_flags = yes
		vov_setup_coastal_bonus = yes
		to_remove_tribal_land = yes
		to_nat_set_development = yes
		# to_nat_native_cultures_setup = yes
		to_nat_tribal_development_setup = yes
		to_nat_migratory_development_setup = yes
		to_set_up_nodlc_coal = yes
		every_province = {
			limit = {
				OR = {
					is_empty = yes
					is_colony = yes
				}
			}
			to_check_native_size = yes
		}
		1501 = {
			add_province_triggered_modifier = to_yearly_event_pulse
		}
		set_global_flag = to_setup_done
	}
	# Ensuring compatibility, remove later
	every_owned_province = {
		limit = {
			has_province_modifier = vov_coastal_bonus_tm
		}
		remove_province_triggered_modifier = vov_coastal_bonus_tm
		vov_handle_coastal_bonus = yes
	}
	if = {
		limit = {
			has_estate = estate_all_natives
			NOT = { has_estate_privilege = nhs_native_privilege_foreign_invaders }
		}
		set_estate_privilege = nhs_native_privilege_foreign_invaders
	}
}

to_set_up_nodlc_coal = {
	if = {
		limit = {
			NOT = { has_dlc = "Rule Britannia" }
		}
		every_province = {
			limit = {
				nhs_has_coal = yes
				NOT = { has_province_modifier = nhs2_lantent_coal_tm }
			}
			add_permanent_province_modifier = {
				name = nhs2_lantent_coal
				duration = -1
			}
			add_province_triggered_modifier = nhs2_lantent_coal_tm
		}
	}
}

nhs_set_up_empty_province_flags = {
	every_province = {
		if = {
			limit = {
				is_empty = yes
			}
			set_province_flag = nhs_is_empty_province
		}
		else_if = {
			limit = {
				has_province_flag = nhs_is_empty_province
			}
			clr_province_flag = nhs_is_empty_province
		}
	}
}

to_yearly_event_pulse_effect = {
	
}

to_two_year_event_pulse_1_effect = {
	if = {
		limit = {
			NOT = { is_year = 1468 }
			nhs_condition_all_ely_scoped_with_and = {
				KOMANDA = has_country_flag
				KOMANDA2 = hellenic_conversion_preacher
			}
		}
		nhs_trigger_event = { EVENT_ID = nhs_hellenicconversion.100 DAYS = 120 RANDOM = 120 }
	}
}

to_two_year_event_pulse_2_effect = {
}

to_three_year_event_pulse_1_effect = {
	if = {
		limit = {
			NOT = { is_year = 1468 }
			nhs_condition_all_ely_scoped_with_and = {
				KOMANDA = has_country_flag
				KOMANDA2 = nhs_pagan_assemblies
			}
		}
		random_list = {
			50 = {
				nhs_trigger_event = { EVENT_ID = nhs_hellenicconversion.1000 DAYS = 1 RANDOM = 120 }
			}
			50 = {
				nhs_trigger_event = { EVENT_ID = nhs_hellenicconversion.1000 DAYS = 240 RANDOM = 120 }
			}
		}
	}
}

to_three_year_event_pulse_2_effect = {
	if = {
		limit = {
			NOT = { is_year = 1468 }
			has_country_flag = hellenic_conversion_preacher
			nhs_condition_all_ely = { KOMANDA = tag }
			religion_group = christian
			has_estate_privilege = estate_church_nhs_inquisition_privilege
		}
		random_list = {
			50 = {
				nhs_trigger_event = { EVENT_ID = nhs_hellenicconversion.1001 DAYS = 1 RANDOM = 120 }
			}
			50 = {
				nhs_trigger_event = { EVENT_ID = nhs_hellenicconversion.1001 DAYS = 240 RANDOM = 120 }
			}
		}
	}
}

to_three_year_event_pulse_3_effect = {
}

nhs_handle_colonies = {
	if = {
		limit = {
			has_province_flag = nhs_is_empty_province
			is_empty = no
			owner = {
				is_native_government = yes
				NOT = { has_reform = native_settle_down_reform }
				NOT = { num_of_cities = 2 }
			}
			# OR = {
			# 	is_capital = yes
			# 	owner = {
			# 		can_migrate = yes
			# 		NOT = { num_of_cities = 2 }
			# 	}
			# }
		}
		# HANDLE NATIVE MIGRATION
		clr_province_flag = nhs_is_empty_province
		clr_province_flag = nhs_is_colony
		to_nat_on_migrate_province = yes
	}
	else_if = {
		limit = {
			has_province_flag = nhs_is_empty_province
			is_empty = no
			# is_colony = yes
		}
		on_colony_created = yes
		clr_province_flag = nhs_is_empty_province
		set_province_flag = nhs_is_colony
	}
	else_if = {
		limit = {
			NOT = { has_province_flag = nhs_is_empty_province }
			is_empty = yes
		}
		on_colony_destroyed = yes
		set_province_flag = nhs_is_empty_province
		clr_province_flag = nhs_is_colony
		change_tribal_land = ---
		to_check_native_size = yes
		to_nat_remove_local_migratory_development = yes
		to_nat_restore_local_tribal_development = yes
	}
}

on_colony_created = {
	nhs_settler_boost_on_colony_created = yes
	handle_nhs_native_priv_inclusive_citizenship_modifier = yes
	handle_to_vov_native_priv_benevolent_conquerors_modifier = yes
	to_nat_handle_colonise_own_culture_modifier = yes
	to_nat_handle_native_expansion_modifier = yes
	to_nat_handle_expand_overseas_modifier = yes
}

on_colony_destroyed = {
	remove_province_modifier = nhs_native_priv_inclusive_citizenship_mod
}

on_colony_finished = {
	to_nat_add_temporary_depopulation = yes
	# to_ely_province_culture_check = yes
	handle_nhs_native_priv_ancestral_land_colony_finished = yes
	to_nat_remove_tribal_development = yes
	to_nat_handle_colonise_own_culture_modifier = yes
	to_nat_handle_native_expansion_modifier = yes
	to_nat_handle_expand_overseas_modifier = yes
	handle_nhs_native_priv_inclusive_citizenship_colony_finished = yes
	handle_to_vov_native_priv_benevolent_conquerors_colony_finished = yes
	handle_to_nhs_estate_nhs_nobles_land_sale_privilege_colony_finished = yes
	# to_ely_province_culture_add_autonomy = yes
	province_event = { id = to_nat_tribal_development.1 }
}

# province
# FROM = old owner
nhs_on_province_owner_change = {
	to_nat_on_conquered_migratory_development = yes
	nhs_handle_colonies = yes
	vov_handle_grand_forestries = yes
	msg_handle_slaves = yes
	nhs_handle_fort_manpower = yes
	# nhs_assign_names_effect = yes
	vov_handle_coastal_bonus = yes
	vov_handle_brave_the_elements = yes
	province_recalculate_estate_privileges_effect_natives = yes
	handle_to_vov_native_priv_freedom_of_worship_modifier = yes
	to_nat_handle_colonise_own_culture_modifier = yes
	to_nat_handle_native_expansion_modifier = yes
	to_nat_handle_expand_overseas_modifier = yes
	to_nat_handle_grand_confederation_modifier = yes
	to_nat_remove_tribal_development = yes
	nhs_handle_culture_integration_new_province_general = yes
	nhs_handle_naphtha = yes
	if = {
		limit = {
			nhs_homelands_building_counter_trigger = yes
			owner = {
				nhs_condition_all_ely = { KOMANDA = tag }
			}
		}
		nhs_homelands_building_counter_eval_local_province = yes
	}
	else_if = {
		limit = {
			nhs_homelands_building_counter_trigger = yes
			FROM = {
				nhs_condition_all_ely = { KOMANDA = tag }
			}
		}
		nhs_homelands_building_counter_eval_former_province = yes
	}

	if = {
		limit = {
			continent = north_america
			owner = {
				nhs_condition_all_ely = { KOMANDA = tag }
			}
		}
		nhs_hightier_building_counter_eval_local_province = yes
	}
	else_if = {
		limit = {
			continent = north_america
			FROM = {
				nhs_condition_all_ely = { KOMANDA = tag }
			}
		}
		nhs_hightier_building_counter_eval_former_province = yes
	}
	
	if = {
		limit = {
			continent = north_america
			owned_by = POR
			is_colony = yes
			POR = {
				has_country_modifier = nhs2_treaty_of_lantanopolis_por
			}
		}
		add_colonysize = -1000
	}
}

# ROOT = Overlord, FROM = Minor
nhs_on_dependency_gained = {
	FROM = {
		if = {
			limit = {
				has_country_modifier = msg_rise_of_sparta
			}
			remove_country_modifier = msg_rise_of_sparta
		}
		else_if = {
			limit = {
				has_country_modifier = msg_rise_of_sparta_2
			}
			remove_country_modifier = msg_rise_of_sparta_2
		}
		else_if = {
			limit = {
				has_country_modifier = msg_rise_of_sparta_3
			}
			remove_country_modifier = msg_rise_of_sparta_3
		}
		if = {
			limit = {
				OR = {
					is_subject_of_type = nhs_imperial_associate
					is_subject_of_type = personal_union
				}
			}
			set_country_flag = nhs_been_subject_for_50_years
		}
		to_nat_determine_new_confederation_leader = yes
	}
}

# province
nhs_on_province_culture_converted = {
	# nhs_assign_names_effect = yes
	# to_ely_province_culture_check = yes
	province_recalculate_estate_privileges_effect_natives = yes
	to_nat_handle_grand_confederation_modifier = yes
	# to_nat_tribal_development_on_province_culture_converted = yes
	nhs_remove_cultural_integration = yes
	nhs_handle_culture_integration_new_province_general = yes
	handle_to_vov_native_priv_freedom_of_worship_modifier = yes
	vov_handle_coastal_bonus = yes
	if = {
		limit = {
			culture = skraeling
		}
		clr_province_flag = nhs_culture_changed_to_skraeling
		set_province_flag = nhs_culture_changed_to_skraeling
	}
	if = {
		limit = {
			culture = elysameric
		}
		clr_province_flag = nhs_culture_changed_to_symmachoi
		set_province_flag = nhs_culture_changed_to_symmachoi
	}

	if = {
		limit = {
			has_province_modifier = msg_slave_province_tm
		}
		remove_province_triggered_modifier = msg_slave_province_tm
	}
	if = {
		limit = {
			has_province_modifier = msg_liberated_slaves
		}
		remove_province_modifier = msg_liberated_slaves
	}
	if = {
		limit = {
			culture = greek
			owner = {
				culture_group = elysian_group
			}
		}
		change_culture = elysian
		to_ely_province_culture_check = yes
	}
}

# country
nhs_on_religion_change = {
	if = {
		limit = {
			has_reform = spartan_kingdom
		}
		if = {
			limit = {
				OR = {
					religion = orthodox
					religion = elysian_orthodoxy
				}
			}
			add_government_reform = msg_christian0_ref
			add_government_reform = msg_spartan_patriarch_no
			add_government_reform = msg_holy_army_no
			add_government_reform = msg_saint_leo_no
		}
		else_if = {
			limit = {
				religion = pantheon_worship
			}
			add_government_reform = msg_hellenic0_ref
			add_government_reform = msg_spartan_heralds_no
			add_government_reform = msg_native_deities_no
			add_government_reform = msg_deify_leonidas_no
		}
		else_if = {
			limit = {
				religion = aztlan_worship
			}
			add_government_reform = msg_aztlan0_ref
			add_government_reform = msg_aztlan_priesthood_no
			add_government_reform = msg_old_faith_no
			add_government_reform = msg_sacrifice_no
		}
	}
}

# country
# root = winning country, from = loser country
to_on_battle_won_country = {
	if = {
		limit = {
			FROM = { 
				tag = NAT
			}
		}
		ROOT = { set_country_flag = to_natives_won_battle }
	}
	if = {
		limit = {
			tag = NAT
		}
		FROM = { set_country_flag = to_natives_won_battle }
	}
}

# province
# root = location, from = loser country
to_on_battle_won_province = {
	to_nat_check_for_tribal_displacement_on_attack_natives = yes
}

# province
# root = location, from = winner country
to_on_battle_lost_province = {
	to_nat_check_for_tribal_displacement_on_attack_natives = yes
}

# country
# root = winning country, from = loser country
to_on_war_won = {
	ROOT = {
		if = {
			limit = {
				is_at_war = no
			}
			clr_country_flag = to_declined_war_chief
		}
		add_faction_influence = {
			faction = vin_vikingr
			influence = 5
		}
		country_event = { id = nhs_vov_coloniesevents.50 }
		country_event = { id = nhs2_mainlandevents.19 }
		country_event = { id = nhs2_mainlandevents.24 }
		# country_event = { id = elysian_revolution.102 }
	}
	FROM = {
		if = {
			limit = {
				is_at_war = no
			}
			clr_country_flag = to_declined_war_chief
		}
		to_nat_handle_envoy_to_the_world = yes
	}
}

to_on_country_creation = {
	to_nat_handle_envoy_to_the_world = yes
}

# Nation annexed.
# FROM is the nation being annexed
to_on_annexed = {
	FROM = {
		to_nat_determine_new_confederation_leader = yes
	}
}

# country
to_on_death_election = {
	if = {
		limit = {
			has_reform = varangian_guard
			has_country_flag = vov_varangian_has_heir
		}
		clr_country_flag = vov_varangian_has_heir
	}
	else = {
		country_event = { id = nhs_vov_varangian_order_events.22 }
		country_event = { id = oth_ctm_events.2 }
	}
	if = {
		limit = {
			has_reform = cretan_admiralty
			has_country_flag = vov_varangian_has_heir
		}
		clr_country_flag = vov_varangian_has_heir
	}
	else = {
		country_event = { id = oth_ctm_events.2 }
	}
}

nhs_on_culture_promoted = {
	handle_nhs_native_priv_cultural_sufferance_modifier = yes
}

nhs_on_culture_demoted = {
	handle_nhs_native_priv_cultural_sufferance_modifier = yes
}

nhs_on_primary_culture_changed = {
	handle_nhs_native_priv_cultural_sufferance_modifier = yes
	vov_handle_coastal_bonus_all_owned_provinces = yes
}

to_on_province_religion_converted = {
	handle_to_vov_native_priv_freedom_of_worship_modifier = yes
}

nhs_save_previous_goods = {
    clr_province_flag = nhs_had_grain_tg
    clr_province_flag = nhs_had_wine_tg
    clr_province_flag = nhs_had_wool_tg
    clr_province_flag = nhs_had_cloth_tg
    clr_province_flag = nhs_had_fish_tg
    clr_province_flag = nhs_had_fur_tg
    clr_province_flag = nhs_had_salt_tg
    clr_province_flag = nhs_had_naval_supplies_tg
    clr_province_flag = nhs_had_copper_tg
    clr_province_flag = nhs_had_gold_tg
    clr_province_flag = nhs_had_iron_tg
    clr_province_flag = nhs_had_slaves_tg
    clr_province_flag = nhs_had_ivory_tg
    clr_province_flag = nhs_had_tea_tg
    clr_province_flag = nhs_had_chinaware_tg
    clr_province_flag = nhs_had_spices_tg
    clr_province_flag = nhs_had_coffee_tg
    clr_province_flag = nhs_had_cotton_tg
    clr_province_flag = nhs_had_sugar_tg
    clr_province_flag = nhs_had_tobacco_tg
    clr_province_flag = nhs_had_cocoa_tg
    clr_province_flag = nhs_had_silk_tg
    clr_province_flag = nhs_had_elysian_silk_tg
    clr_province_flag = nhs_had_skoros_silk_tg
    clr_province_flag = nhs_had_tropical_wood_tg
    clr_province_flag = nhs_had_dyes_tg
    clr_province_flag = nhs_had_norse_mead_tg
    clr_province_flag = nhs_had_livestock_tg
    clr_province_flag = nhs_had_incense_tg
    clr_province_flag = nhs_had_glass_tg
    clr_province_flag = nhs_had_gems_tg
    clr_province_flag = nhs_had_paper_tg
    clr_province_flag = nhs_had_coal_tg
    clr_province_flag = nhs_had_cloves_tg
    clr_province_flag = nhs_had_unknown_tg
    clr_province_flag = nhs_had_coal_2_tg
    clr_province_flag = nhs_had_nothing_tg
	if = { limit = { trade_goods = grain } set_province_flag = nhs_had_grain_tg }
    else_if = { limit = { trade_goods = wine } set_province_flag = nhs_had_wine_tg }
    else_if = { limit = { trade_goods = wool } set_province_flag = nhs_had_wool_tg }
    else_if = { limit = { trade_goods = cloth } set_province_flag = nhs_had_cloth_tg }
    else_if = { limit = { trade_goods = fish } set_province_flag = nhs_had_fish_tg }
    else_if = { limit = { trade_goods = fur } set_province_flag = nhs_had_fur_tg }
    else_if = { limit = { trade_goods = salt } set_province_flag = nhs_had_salt_tg }
    else_if = { limit = { trade_goods = naval_supplies } set_province_flag = nhs_had_naval_supplies_tg }
    else_if = { limit = { trade_goods = copper } set_province_flag = nhs_had_copper_tg }
    else_if = { limit = { trade_goods = gold } set_province_flag = nhs_had_gold_tg }
    else_if = { limit = { trade_goods = iron } set_province_flag = nhs_had_iron_tg }
    else_if = { limit = { trade_goods = slaves } set_province_flag = nhs_had_slaves_tg }
    else_if = { limit = { trade_goods = ivory } set_province_flag = nhs_had_ivory_tg }
    else_if = { limit = { trade_goods = tea } set_province_flag = nhs_had_tea_tg }
    else_if = { limit = { trade_goods = chinaware } set_province_flag = nhs_had_chinaware_tg }
    else_if = { limit = { trade_goods = spices } set_province_flag = nhs_had_spices_tg }
    else_if = { limit = { trade_goods = coffee } set_province_flag = nhs_had_coffee_tg }
    else_if = { limit = { trade_goods = cotton } set_province_flag = nhs_had_cotton_tg }
    else_if = { limit = { trade_goods = sugar } set_province_flag = nhs_had_sugar_tg }
    else_if = { limit = { trade_goods = tobacco } set_province_flag = nhs_had_tobacco_tg }
    else_if = { limit = { trade_goods = cocoa } set_province_flag = nhs_had_cocoa_tg }
    else_if = { limit = { trade_goods = silk } set_province_flag = nhs_had_silk_tg }
    else_if = { limit = { trade_goods = elysian_silk } set_province_flag = nhs_had_elysian_silk_tg }
    else_if = { limit = { trade_goods = skoros_silk } set_province_flag = nhs_had_skoros_silk_tg }
    else_if = { limit = { trade_goods = tropical_wood } set_province_flag = nhs_had_tropical_wood_tg }
    else_if = { limit = { trade_goods = dyes } set_province_flag = nhs_had_dyes_tg }
    else_if = { limit = { trade_goods = norse_mead } set_province_flag = nhs_had_norse_mead_tg }
    else_if = { limit = { trade_goods = livestock } set_province_flag = nhs_had_livestock_tg }
    else_if = { limit = { trade_goods = incense } set_province_flag = nhs_had_incense_tg }
    else_if = { limit = { trade_goods = glass } set_province_flag = nhs_had_glass_tg }
    else_if = { limit = { trade_goods = gems } set_province_flag = nhs_had_gems_tg }
    else_if = { limit = { trade_goods = paper } set_province_flag = nhs_had_paper_tg }
    else_if = { limit = { trade_goods = coal } set_province_flag = nhs_had_coal_tg }
    else_if = { limit = { trade_goods = cloves } set_province_flag = nhs_had_cloves_tg }
    else_if = { limit = { trade_goods = unknown } set_province_flag = nhs_had_unknown_tg }
    else_if = { limit = { trade_goods = coal_2 } set_province_flag = nhs_had_coal_2_tg }
    else_if = { limit = { trade_goods = nothing } set_province_flag = nhs_had_nothing_tg }
}

nhs_load_previous_goods = {
	if = { limit = { has_province_flag = nhs_had_grain_tg } change_trade_goods = grain }
	else_if = { limit = { has_province_flag = nhs_had_wine_tg } change_trade_goods = wine }
	else_if = { limit = { has_province_flag = nhs_had_wool_tg } change_trade_goods = wool }
	else_if = { limit = { has_province_flag = nhs_had_cloth_tg } change_trade_goods = cloth }
	else_if = { limit = { has_province_flag = nhs_had_fish_tg } change_trade_goods = fish }
	else_if = { limit = { has_province_flag = nhs_had_fur_tg } change_trade_goods = fur }
	else_if = { limit = { has_province_flag = nhs_had_salt_tg } change_trade_goods = salt }
	else_if = { limit = { has_province_flag = nhs_had_naval_supplies_tg } change_trade_goods = naval_supplies }
	else_if = { limit = { has_province_flag = nhs_had_copper_tg } change_trade_goods = copper }
	else_if = { limit = { has_province_flag = nhs_had_gold_tg } change_trade_goods = gold }
	else_if = { limit = { has_province_flag = nhs_had_iron_tg } change_trade_goods = iron }
	else_if = { limit = { has_province_flag = nhs_had_slaves_tg } change_trade_goods = slaves }
	else_if = { limit = { has_province_flag = nhs_had_ivory_tg } change_trade_goods = ivory }
	else_if = { limit = { has_province_flag = nhs_had_tea_tg } change_trade_goods = tea }
	else_if = { limit = { has_province_flag = nhs_had_chinaware_tg } change_trade_goods = chinaware }
	else_if = { limit = { has_province_flag = nhs_had_spices_tg } change_trade_goods = spices }
	else_if = { limit = { has_province_flag = nhs_had_coffee_tg } change_trade_goods = coffee }
	else_if = { limit = { has_province_flag = nhs_had_cotton_tg } change_trade_goods = cotton }
	else_if = { limit = { has_province_flag = nhs_had_sugar_tg } change_trade_goods = sugar }
	else_if = { limit = { has_province_flag = nhs_had_tobacco_tg } change_trade_goods = tobacco }
	else_if = { limit = { has_province_flag = nhs_had_cocoa_tg } change_trade_goods = cocoa }
	else_if = { limit = { has_province_flag = nhs_had_silk_tg } change_trade_goods = silk }
	else_if = { limit = { has_province_flag = nhs_had_elysian_silk_tg } change_trade_goods = elysian_silk }
	else_if = { limit = { has_province_flag = nhs_had_skoros_silk_tg } change_trade_goods = skoros_silk }
	else_if = { limit = { has_province_flag = nhs_had_tropical_wood_tg } change_trade_goods = tropical_wood }
	else_if = { limit = { has_province_flag = nhs_had_dyes_tg } change_trade_goods = dyes }
	else_if = { limit = { has_province_flag = nhs_had_norse_mead_tg } change_trade_goods = norse_mead }
	else_if = { limit = { has_province_flag = nhs_had_livestock_tg } change_trade_goods = livestock }
	else_if = { limit = { has_province_flag = nhs_had_incense_tg } change_trade_goods = incense }
	else_if = { limit = { has_province_flag = nhs_had_glass_tg } change_trade_goods = glass }
	else_if = { limit = { has_province_flag = nhs_had_gems_tg } change_trade_goods = gems }
	else_if = { limit = { has_province_flag = nhs_had_paper_tg } change_trade_goods = paper }
	else_if = { limit = { has_province_flag = nhs_had_coal_tg } change_trade_goods = coal }
	else_if = { limit = { has_province_flag = nhs_had_cloves_tg } change_trade_goods = cloves }
	else_if = { limit = { has_province_flag = nhs_had_unknown_tg } change_trade_goods = unknown }
	else_if = { limit = { has_province_flag = nhs_had_coal_2_tg } change_trade_goods = coal_2 }
	else_if = { limit = { has_province_flag = nhs_had_nothing_tg } change_trade_goods = nothing }
	clr_province_flag = nhs_had_grain_tg
	clr_province_flag = nhs_had_wine_tg
	clr_province_flag = nhs_had_wool_tg
	clr_province_flag = nhs_had_cloth_tg
	clr_province_flag = nhs_had_fish_tg
	clr_province_flag = nhs_had_fur_tg
	clr_province_flag = nhs_had_salt_tg
	clr_province_flag = nhs_had_naval_supplies_tg
	clr_province_flag = nhs_had_copper_tg
	clr_province_flag = nhs_had_gold_tg
	clr_province_flag = nhs_had_iron_tg
	clr_province_flag = nhs_had_slaves_tg
	clr_province_flag = nhs_had_ivory_tg
	clr_province_flag = nhs_had_tea_tg
	clr_province_flag = nhs_had_chinaware_tg
	clr_province_flag = nhs_had_spices_tg
	clr_province_flag = nhs_had_coffee_tg
	clr_province_flag = nhs_had_cotton_tg
	clr_province_flag = nhs_had_sugar_tg
	clr_province_flag = nhs_had_tobacco_tg
	clr_province_flag = nhs_had_cocoa_tg
	clr_province_flag = nhs_had_silk_tg
	clr_province_flag = nhs_had_elysian_silk_tg
	clr_province_flag = nhs_had_skoros_silk_tg
	clr_province_flag = nhs_had_tropical_wood_tg
	clr_province_flag = nhs_had_dyes_tg
	clr_province_flag = nhs_had_norse_mead_tg
	clr_province_flag = nhs_had_livestock_tg
	clr_province_flag = nhs_had_incense_tg
	clr_province_flag = nhs_had_glass_tg
	clr_province_flag = nhs_had_gems_tg
	clr_province_flag = nhs_had_paper_tg
	clr_province_flag = nhs_had_coal_tg
	clr_province_flag = nhs_had_cloves_tg
	clr_province_flag = nhs_had_unknown_tg
	clr_province_flag = nhs_had_coal_2_tg
	clr_province_flag = nhs_had_nothing_tg
}

nhs_add_reform = {
	add_government_reform = $REF$
	# if = {
	# 	limit = {
	# 		has_dlc = "Dharma"
	# 	}
	# 	#[[REM]
	# 	#	remove_government_reform = $REM$
	# 	#]
	# 	add_government_reform = $REF$
	# }
}

nhs_add_gov_reform = {
	add_government_reform = $REF$
	# if = {
	# 	limit = {
	# 		has_dlc = "Dharma"
	# 	}
	# 	#[[REM]
	# 	#	remove_government_reform = $REM$
	# 	#]
	# 	add_government_reform = $REF$
	# }
	# else = {
	# 	hidden_effect = {
	# 		add_government_reform = nhs_intermediary_government
	# 	}
	# 	add_government_reform = $REF$
	# }
}

nhs_set_center_of_trade_1 = {
	custom_tooltip = nhs_add_center_of_trade_1_tt
	hidden_effect = {
		if = {
			limit = {
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
			center_of_trade = 1
		}
		else = {
			owner = {
				add_treasury = 50
			}
		}
	}
}

nhs_set_center_of_trade_2 = {
	custom_tooltip = nhs_add_center_of_trade_2_tt
	hidden_effect = {
		if = {
			limit = {
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
			center_of_trade = 2
		}
		else_if = {
			limit = {
				NOT = { province_has_center_of_trade_of_level = 2 }
			}
			add_center_of_trade_level = 1
		}
		else = {
			owner = {
				add_treasury = 100
			}
		}
	}
}

nhs_set_center_of_trade_3 = {
	custom_tooltip = nhs_add_center_of_trade_3_tt
	hidden_effect = {
		if = {
			limit = {
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
			center_of_trade = 3
		}
		else_if = {
			limit = {
				NOT = { province_has_center_of_trade_of_level = 3 }
			}
			add_center_of_trade_level = 2
		}
		else = {
			owner = {
				add_treasury = 500
			}
		}
	}
}

nhs_set_center_in_a_region_to_level_3 = {
	if = {
		limit = {
			any_owned_province = {
				$TYPE$ = $CNRG$
			}
			NOT = {
				any_province = {
					$TYPE$ = $CNRG$
					owner = {
						OR = {
							tag = ROOT
							is_subject_of = ROOT
						}
					}
					province_has_center_of_trade_of_level = 3
				}
			}
		}
		if = {
			limit = {
				any_owned_province = {
					$TYPE$ = $CNRG$
					province_has_center_of_trade_of_level = 2
				}
				
			}
			random_owned_province = {
				limit = {
					$TYPE$ = $CNRG$
					province_has_center_of_trade_of_level = 2
				}
				nhs_set_center_of_trade_3 = yes
			}
		}
		else_if = {
			limit = {
				any_owned_province = {
					$TYPE$ = $CNRG$
					province_has_center_of_trade_of_level = 1
				}
			}
			random_owned_province = {
				limit = {
					$TYPE$ = $CNRG$
					province_has_center_of_trade_of_level = 1
				}
				nhs_set_center_of_trade_3 = yes
			}
		}
		else = {
			random_owned_province = {
				limit = {
					$TYPE$ = $CNRG$
				}
				nhs_set_center_of_trade_3 = yes
			}
		}
	}
	else = {
		add_treasury = 1000
	}
}

nhs_set_center_in_a_region = {
	if = {
		limit = {
			any_owned_province = {
				$TYPE$ = $CNRG$
				province_has_center_of_trade_of_level = 1
				NOT = { province_has_center_of_trade_of_level = 2 }
			}
		}
		random_owned_province = {
			limit = {
				$TYPE$ = $CNRG$
				province_has_center_of_trade_of_level = 1
				NOT = { province_has_center_of_trade_of_level = 2 }
			}
			nhs_set_center_of_trade_2 = yes
		}
	}
	else_if = {
		limit = {
			any_owned_province = {
				nhs_eicticofminh = yes
				$TYPE$ = $CNRG$
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
		}
		random_owned_province = {
			limit = {
				nhs_eicticofminh = yes
				$TYPE$ = $CNRG$
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
			nhs_set_center_of_trade_1 = yes
		}
	}
	else_if = {
		limit = {
			any_province = {
				owner = {
					is_subject_of = ROOT
				}
				nhs_eicticofminh = yes
				$TYPE$ = $CNRG$
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
		}
		random_province = {
			limit = {
				owner = {
					is_subject_of = ROOT
				}
				nhs_eicticofminh = yes
				$TYPE$ = $CNRG$
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
			nhs_set_center_of_trade_1 = yes
		}
	}
	else_if = {
		limit = {
			any_province = {
				owner = {
					is_subject_of = ROOT
				}
				nhs_eicticofminh = yes
				$TYPE$ = $CNRG$
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
		}
		random__province = {
			limit = {
				owner = {
					is_subject_of = ROOT
				}
				nhs_eicticofminh = yes
				$TYPE$ = $CNRG$
				NOT = { province_has_center_of_trade_of_level = 1 }
			}
			nhs_set_center_of_trade_1 = yes
		}
	}
	else = {
		add_treasury = 75
	}
}

nhs_change_government = {
	change_government = $GOV$
	# if = {
	# 	limit = {
	# 		has_dlc = "Dharma"
	# 		NOT = { government = $GOV$ }
	# 	}
	# 	change_government = $GOV$
	# }
	# [[LEGACY]
	# 	set_legacy_government = $LEGACY$
	# ]
}

to_add_government_reform_short_tooltip = {
	custom_tooltip = to_add_$REFORM$_gov_reform_tt
	hidden_effect = {
		add_government_reform = $REFORM$
	}
}