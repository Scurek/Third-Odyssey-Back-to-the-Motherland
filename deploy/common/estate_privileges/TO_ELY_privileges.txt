#All scopes are country scope
#All parameters are optional

# estate_privilege = {
# 	is_valid = { triggers }						#Conditions for whether it is possible for the country to have this privilege (it will not display on the list if they are false, and will be revoked if it has already been granted)
# 	can_select = { triggers } 					#Conditions for whether the country is allowed to select the privilege (with conditions for why not displayed)
# 	on_granted = { effects } 					#Effects executed immediately upon the privilege being taken
# 	can_revoke = { triggers } 					#Conditions for whether the country can revoke the privilege
# 	on_revoked = { effects } 					#Effects executed upon the privilege being revoked by the country
# 	on_invalid = { effects } 					#Effects executed upon the privilege being removed due to invalidity (is_valid becomes false or the estate is removed)
# 	penalties = { modifiers } 					#Negative modifiers granted while the privilege is active (creates different tooltip to benefits)
# 	conditional_modifier = { 					#Modifier that are applied if the specified conditions are true.
# 		trigger = { triggers }
# 		modifier = { modifiers }
# 		is_bad = yes/no							#Specifies whether the modifier should be listed as positive or negative in the tooltips.
# 	}
# 	modifier_by_land_ownership = { modifiers } 	#Multiplies the modifier by the % of land owned by the estate.
# 	mechanics = { mechanics } 					#Special mechanics the privilege enables
# 	cooldown_years = int 						#Time limit before which the privilege cannot be revoked
# 	on_cooldown_expires = { effects }			#Effect executed once the specified cooldown_years timer has run down
#	ai_will_do									#If above ESTATE_PRIVILEGE_GRANT_THRESHOLD define, AI will try to apply. If below ESTATE_PRIVILEGE_REVOKE_THRESHOLD, AI will try to revoke.
# }


#Special privileges for the church for the disaster

estate_church_nhs_inquisition_privilege = {
	icon = privilege_recruit_minister
	max_absolutism = -10
	influence = 0.20
	loyalty = 0.05
	is_valid = {
		has_estate_privilege = estate_church_nhs_inquisition_privilege 
		religion_group = christian
	}
	can_select = {
	}
	
	can_revoke = {
		estate_loyalty = {
			estate = estate_church
			loyalty = 65
		}
		stability = 2
		# DOES NOT HAVE PRE DISASTER OR DISASTER
		NOT = { has_disaster = nhs_hcd_hellenic_crisis }
		if = {
			limit = {
				has_country_flag = hellenic_conversion_preacher
			}
			custom_trigger_tooltip = {
				tooltip = to_nhs_disabled_during_pre_hellenic_revolt_tt
				always = no
			}
		}
	}
	on_granted = {
		custom_tooltip = nhs_add_estate_church_privilege_slot_tt
		if = {
			limit = {
				has_country_flag = hellenic_conversion_preacher
			}
			custom_tooltip = nhs_increase_hellenic_disaster_progress_by_0.5
			custom_tooltip = nhs_enable_intolerant_church_privileges_tt
		}
		if = {
			limit = {
				OR = {
					has_any_disaster = yes
					religious_unity = 0.95
				}
			}
			custom_tooltip = nhs_estate_church_nhs_inquisition_privilege_effect_bad_tt
		}
		else = {
			custom_tooltip = nhs_estate_church_nhs_inquisition_privilege_effect_good_tt
		}
	}
	on_revoked = {
		add_stability = -1
	}
	penalties = {
	}
	# benefits = {
	# 	tolerance_own = 1
	# 	missionary_maintenance_cost = -0.25
	# }

	conditional_modifier = {
		trigger = {
			has_any_disaster = no
			NOT = { religious_unity = 0.95 }
		}
		modifier = {
			church_loyalty_modifier = -0.15
			legitimacy = -2
			missionary_maintenance_cost = -0.25 
		}
	}
	conditional_modifier = {
		trigger = {
			OR = {
				has_any_disaster = yes
				religious_unity = 0.95
			}
		}
		modifier = {
			tolerance_own = 2
			missionary_maintenance_cost = -0.25 
		}
	}

	cooldown_years = 20

	ai_will_do = {
		factor = 0
	}
}

to_nhs_estate_nhs_nobles_land_sale_privilege = {
	icon = privilege_sell_autonomy
	max_absolutism = -10
	influence = 0.10
	loyalty = 0.10
	cooldown_years = 10

	is_valid = {
		NOT = { has_country_flag = nhs_disable_noble_privileges }
	}
	can_select = {
		to_num_of_noble_privileges_check = yes
	}
	
	can_revoke = {
	}
	on_granted = {
		custom_tooltip = nhs_estate_nhs_nobles_land_sale_privilege_effect_tt
	}
	on_revoked = {
	}
	penalties = {
		# global_tax_modifier = -0.1
		free_adm_policy = -1
	}
	benefits = {
		global_tax_income = 24
	}

	ai_will_do = {
		factor = 100
		modifier = {
			factor = 0
			is_absolutism_active = yes
		}
	}
}

to_estate_church_patriarchal_dominance = {
	icon = privilege_patriarch_authority
	max_absolutism = -20
	influence = 0.30
	loyalty = 0.15
	land_share = 20

	is_valid = {
		has_estate_privilege = to_estate_church_patriarchal_dominance
		OR = {
			religion = orthodox
			religion = elysian_orthodoxy
		}
	}
	can_revoke = {
		NOT = { patriarch_authority = 0.75 }
	}
	on_granted = {
		custom_tooltip = nhs_add_estate_church_privilege_slot_tt
		if = {
			limit = {
				has_country_flag = to_patriarchal_autonomy_event_active
			}
			tooltip = {
				change_estate_land_share = {
					estate = estate_church
					share = 20
				}
			}
		}
		custom_tooltip = to_disables_dominance_of_the_clergy_tt
		custom_tooltip = to_removes_penalties_from_church_land_tt
		hidden_effect = {
			every_owned_province = {
				limit = {
					has_province_modifier = nhs2_patriarchate_land
				}
				remove_province_modifier = nhs2_patriarchate_land
				add_province_modifier = {
					name = nhs2_patriarchate_land_reduced
					duration = -1
				}
			}
			every_owned_province = {
				limit = {
					has_province_modifier = nhs2_patriarchate_land_capital
				}
				remove_province_modifier = nhs2_patriarchate_land_capital
				add_province_modifier = {
					name = nhs2_patriarchate_land_capital_reduced
					duration = -1
				}
			}
		}
	}
	on_revoked = {
		add_stability = -2
		custom_tooltip = to_restores_penalties_from_church_land_tt
		hidden_effect = {
			every_owned_province = {
				limit = {
					has_province_modifier = nhs2_patriarchate_land_reduced
				}
				remove_province_modifier = nhs2_patriarchate_land_reduced
				add_province_modifier = {
					name = nhs2_patriarchate_land
					duration = -1
				}
			}
			every_owned_province = {
				limit = {
					has_province_modifier = nhs2_patriarchate_land_capital_reduced
				}
				remove_province_modifier = nhs2_patriarchate_land_capital_reduced
				add_province_modifier = {
					name = nhs2_patriarchate_land_capital
					duration = -1
				}
			}
		}
	}
	on_invalid = {
		custom_tooltip = to_restores_penalties_from_church_land_tt
		hidden_effect = {
			every_owned_province = {
				limit = {
					has_province_modifier = nhs2_patriarchate_land_reduced
				}
				remove_province_modifier = nhs2_patriarchate_land_reduced
				add_province_modifier = {
					name = nhs2_patriarchate_land
					duration = -1
				}
			}
			every_owned_province = {
				limit = {
					has_province_modifier = nhs2_patriarchate_land_capital_reduced
				}
				remove_province_modifier = nhs2_patriarchate_land_capital_reduced
				add_province_modifier = {
					name = nhs2_patriarchate_land_capital
					duration = -1
				}
			}
		}
	}
	penalties = {
		tolerance_heretic = -1
		tolerance_heathen = -1
		technology_cost = 0.05
		idea_cost = 0.05
		min_autonomy = 10
	}
	benefits = {
		tolerance_own = 3
		monarch_admin_power = 1
		no_stability_loss_on_monarch_death = yes
		relation_with_same_religion = 30
		stability_cost_modifier = -0.30
		estate_nhs_nobles_influence_modifier = -0.15
		nobles_influence_modifier = -0.10
		burghers_influence_modifier = -0.15
		estate_all_natives_influence_modifier = -0.10
	}

	ai_will_do = {
		factor = 0
	}
}