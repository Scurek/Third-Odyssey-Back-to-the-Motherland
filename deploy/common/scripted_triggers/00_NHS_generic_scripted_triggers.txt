# Scripted triggers with arguments that are very generic to 3rd Odyssey


# -- GENERIC --

# Check if TAG exists and given CONDITION matches it
nhs_tag_exists_and_matches {
    limit {
        exists = $TAG$
    }
    $CONDITION$ = $TAG$
}


# -- ELYSIAN --

# Check if CONDITION matches any Elysian nation
# Use: nhs_check_all_elysian = { CONDITION = tag }
nhs_check_all_elysian = {
	OR = {
		$CONDITION$ = ELY  # Elysian Empire
		$CONDITION$ = NHS  # Elysia
		$CONDITION$ = ELR  # Elysian Noble Republic
		$CONDITION$ = ERR  # Revolutionary Elysia
		$CONDITION$ = ERF  # First Elysian Republic
	}
}

# Check if CONDITION matches any Elysian nation, including Creta Minor and culture primaries
# Use: nhs_check_all_elysian_expanded = { CONDITION = tag }
nhs_check_all_elysian_expanded = {
	nhs_check_all_elysian = { CONDITION = $CONDITION$ }
	$CONDITION$ = CM1  # Creta Minor
	$CONDITION$ = ELF  # Elysian settlers
	$CONDITION$ = ELA  # Elysian Federation
	$CONDITION$ = SKY  # Scythia
	$CONDITION$ = BOR  # Borealia
	$CONDITION$ = HBR  # Hyperborealia
	$CONDITION$ = HSP  # Hesperidia
	$CONDITION$ = LAK  # Lakonia
	$CONDITION$ = VAE  # Varangia
}

# Check if the culture is 'functionally Elysian'
# Use: nhs_culturally_elysian = yes
nhs_culturally_elysian = {
	OR = {
		AND = {
			culture_group = byzantine
			capital_scope = {
				OR = {
					continent = north_america
					continent = south_america
				}
			}
		}
		culture_group = elysian_group
		NOT = {
			# Exclude 'Norse' Elysian
			primary_culture = varangian_e
		}
		NOT = {
			# Exclude 'Spartan' Elysian
			primary_culture = lakonian
		}
		NOT = {
			# Exclude 'Albanian' Elysian
			primary_culture = shqipproi
		}
	}
}


# -- VINLAND --

# Check if CONDITION matches any Vinlandic nation
# Use: nhs_check_all_vinland = { CONDITION = tag }
nhs_check_all_vinland = {
	OR = {
		$CONDITION$ = MK1
		$CONDITION$ = HLL
		$CONDITION$ = VIN
	}
}

# Check if CONDITION matches any Norse nation
# Use: nhs_check_all_norse = { CONDITION = tag }
nhs_check_all_norse = {
	nhs_check_all_vinland = { CONDITION = $CONDITION$ }
    $CONDITION$ = JOM  # Jomsvikings
	$CONDITION$ = VGD  # Varangian Order
}

# Check if the culture is 'functionally Norse'
# Use: nhs_culturally_norse = yes
nhs_culturally_norse = {
	OR = {
		culture_group = norse_g
		primary_culture = varangian_e
	}
}


# -- SPARTAN --

# Check if CONDITION matches any Spartan nation
# Use: nhs_check_all_spartan = { CONDITION = tag }
nhs_check_all_spartan = {
	OR = {
		$CONDITION$ = MSN
		$CONDITION$ = MSG
	}
}

# Check if the culture is 'functionally Spartan'
# Use: nhs_culturally_spartan = yes
nhs_culturally_spartan = {
	OR = {
		culture_group = spartakian_group
		primary_culture = lakonian
	}
}


# -- Albanian --

# Check if the culture is 'functionally Albanian'
# Use: nhs_culturally_albanian = yes
nhs_culturally_albanian = {
	OR = {
		primary_culture = shqipproi
		primary_culture = shqiperi
		AND = {
			primary_culture = albanian
			capital_scope = {
				OR = {
					continent = north_america
					continent = south_america
				}
			}
		}
	}
}

# -- Exiles --

# Check if CONDITION matches any exiled nation
# Use: nhs_check_all_exiles = { CONDITION = tag }
nhs_check_all_exiles = {
    nhs_check_all_elysian_expanded = { CONDITION = $CONDITION$ }
    nhs_check_all_norse = { CONDITION = $CONDITION$ }
    nhs_check_all_spartan = { CONDITION = $CONDITION$ }
    # Include minor exiles
    $CONDITION$ = SHQ  # Shqiperi
}


# -- Native Estates --

# Check if has any native estate (early, mid, late)
# Use: nhs_has_any_native_estate = yes
nhs_has_any_native_estate = {
	OR = {
		has_estate = estate_all_natives_early
		has_estate = estate_all_natives_mid
		has_estate = estate_all_natives_late
	}
}

# Check if any native estate has QUANTITY influence
# Use: nhs_check_influence_any_native_estate = { QUANTITY = 30 }
nhs_check_influence_any_native_estate = {
	# DEBUG: temporarily simplified
	estate_influence = {
		estate = estate_all_natives_early
		influence = $QUANTITY$
	}
	#if = {
	#	limit = {
	#		has_estate = estate_all_natives_early
	#	}
	#	estate_influence = {
	#		estate = estate_all_natives_early
	#		influence = $QUANTITY$
	#	}
	#}
	#else_if = {
	#	limit = {
	#		has_estate = estate_all_natives_mid
	#	}
	#	estate_influence = {
	#		estate = estate_all_natives_mid
	#		influence = $QUANTITY$
	#	}
	#}
	#else_if = {
	#	limit = {
	#		has_estate = estate_all_natives_late
	#	}
	#	estate_influence = {
	#		estate = estate_all_natives_late
	#		influence = $QUANTITY$
	#	}
	#}
}

# Check if any native estate has QUANTITY loyalty
# Use: nhs_check_loyalty_any_native_estate = { QUANTITY = 30 }
nhs_check_loyalty_any_native_estate = {
	# DEBUG: temporarily simplified
	estate_loyalty = {
		estate = estate_all_natives_early
		loyalty = $QUANTITY$
	}
	#if = {
	#	limit = {
	#		has_estate = estate_all_natives_early
	#	}
	#	estate_loyalty = {
	#		estate = estate_all_natives_early
	#		loyalty = $QUANTITY$
	#	}
	#}
	#else_if = {
	#	limit = {
	#		has_estate = estate_all_natives_mid
	#	}
	#	estate_loyalty = {
	#		estate = estate_all_natives_mid
	#		loyalty = $QUANTITY$
	#	}
	#}
	#else_if = {
	#	limit = {
	#		has_estate = estate_all_natives_late
	#	}
	#	estate_loyalty = {
	#		estate = estate_all_natives_late
	#		loyalty = $QUANTITY$
	#	}
	#}
}

# Check if any native estate has the influence modifier NAME
# Use: nhs_has_influence_modifier_any_native_estate = { NAME = EST_VAL_SERFS_HUNTED }
nhs_has_influence_modifier_any_native_estate = {
	# DEBUG: temporarily simplified
 	has_estate_influence_modifier = {
		estate = estate_all_natives_late
		modifier = $NAME$
	}
	#if = {
	#	limit = {
	#		has_estate = estate_all_natives_early
	#	}
	#	has_estate_influence_modifier = {
	#		estate = estate_all_natives_early
	#		modifier = $NAME$
	#	}
	#}
	#else_if = {
	#	limit = {
	#		has_estate = estate_all_natives_mid
	#	}
	#	has_estate_influence_modifier = {
	#		estate = estate_all_natives_mid
	#		modifier = $NAME$
	#	}
	#}
	#else_if = {
	#	limit = {
	#		has_estate = estate_all_natives_late
	#	}
	#	has_estate_influence_modifier = {
	#		estate = estate_all_natives_late
	#		modifier = $NAME$
	#	}
	#}
}
