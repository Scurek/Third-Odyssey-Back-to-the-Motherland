# Scripted triggers with arguments that are very generic to 3rd Odyssey


# -- GENERIC --

# Check if TAG exists and given CONDITION matches it
nhs_tag_exists_and_matches = {
	if = {
		limit = {
			exists = $TAG$
		}
		$CONDITION$ = $TAG$
	}
}

nhs_exiles_tech = {
	OR = {
		technology_group = exiled_greek
		technology_group = modern_greek
		technology_group = exiled_spartan
		technology_group = modern_spartan
		technology_group = viking
		technology_group = modern_vinlandic
	}
}


# -- ELYSIAN --

# Check if CONDITION matches any Elysian nation
# Use: nhs_check_all_elysian = { CONDITION = tag }
# TODO: This is duplicate of `nhs_is_elysia_not_seen`
nhs_check_all_elysian = {
	OR = {
		$CONDITION$ = ELY  # Elysian Empire
		$CONDITION$ = NHS  # Elysia
		$CONDITION$ = ELR  # Elysian Noble Republic
		$CONDITION$ = ERR  # Revolutionary Elysia
		$CONDITION$ = ERF  # First Elysian Republic
	}
}

# Check if CONDITION matches any Elysian nation, including Creta Minor and culture primaries
# Use: nhs_check_all_elysian_expanded = { CONDITION = tag }
nhs_check_all_elysian_expanded = {
	OR = {
		nhs_check_all_elysian = { CONDITION = $CONDITION$ }
		$CONDITION$ = CM1  # Creta Minor
		# $CONDITION$ = ELF  # Elysian settlers
		$CONDITION$ = ELA  # Elysian Federation
		$CONDITION$ = SKY  # Scythia
		$CONDITION$ = BOR  # Borealia
		$CONDITION$ = HBR  # Hyperborealia
		$CONDITION$ = HSP  # Hesperidia
		$CONDITION$ = LA1  # Lakonia
		$CONDITION$ = VAE  # Varangia
	}
}

# Check if TRIGGER = CONDITION matches any Elysian nation, including Creta Minor and culture primaries
# Use: nhs_check_all_elysian_expanded_existing_with_double_condition = { TRIGGER = culture_group CONDITION = elysian_group }
nhs_check_all_elysian_expanded_existing_with_double_condition = {
	OR = {
		AND = {
			nhs_check_all_elysian = { CONDITION = exists }
			nhs_condition_all_ely_scoped_with_and = { KOMANDA = $TRIGGER$ KOMANDA2 = $CONDITION$ }
		}
		AND = {
			exists = CM1
			CM1 = {
				$TRIGGER$ = $CONDITION$
			}
		}
		AND = {
			exists = ELA
			ELA = {
				$TRIGGER$ = $CONDITION$
			}
		}
		AND = {
			exists = SKY
			SKY = {
				$TRIGGER$ = $CONDITION$
			}
		}
		AND = {
			exists = BOR
			BOR = {
				$TRIGGER$ = $CONDITION$
			}
		}
		AND = {
			exists = HBR
			HBR = {
				$TRIGGER$ = $CONDITION$
			}
		}
		AND = {
			exists = HSP
			HSP = {
				$TRIGGER$ = $CONDITION$
			}
		}
		AND = {
			exists = LA1
			LA1 = {
				$TRIGGER$ = $CONDITION$
			}
		}
		AND = {
			exists = VAE
			VAE = {
				$TRIGGER$ = $CONDITION$
			}
		}
	}
}

# Check if the culture is 'functionally Elysian'
# Use: nhs_culturally_elysian = yes
nhs_culturally_elysian = {
	OR = {
		AND = {
			culture_group = byzantine
			capital_scope = {
				OR = {
					continent = north_america
					continent = south_america
				}
			}
		}
		AND = {
			culture_group = elysian_group
			NOT = {
				# Exclude 'Norse' Elysian
				primary_culture = varangian_e
			}
			NOT = {
				# Exclude 'Spartan' Elysian
				primary_culture = lakonian
			}
			NOT = {
				# Exclude 'Albanian' Elysian
				primary_culture = shqipproi
			}
		}
	}
}


# -- VINLAND --

# Check if CONDITION matches any Vinlandic nation
# Use: nhs_check_all_vinland = { CONDITION = tag }
nhs_check_all_vinland = {
	OR = {
		$CONDITION$ = MK1
		$CONDITION$ = HLL
		$CONDITION$ = VIN
	}
}

# Check if CONDITION matches any Norse nation
# Use: nhs_check_all_norse = { CONDITION = tag }
nhs_check_all_norse = {
	OR = {
		nhs_check_all_vinland = { CONDITION = $CONDITION$ }
		$CONDITION$ = JOM  # Jomsvikings
		$CONDITION$ = VGD  # Varangian Order
	}
}

# Check if the culture is 'functionally Norse'
# Use: nhs_culturally_norse = yes
nhs_culturally_norse = {
	OR = {
		culture_group = norse_g
		primary_culture = varangian_e
	}
}


# -- SPARTAN --

# Check if CONDITION matches any Spartan nation
# Use: nhs_check_all_spartan = { CONDITION = tag }
nhs_check_all_spartan = {
	OR = {
		$CONDITION$ = MS1
		$CONDITION$ = MSN
	}
}

# Check if CONDITION matches any Spartan nation, but check whichever exists first
# Use: nhs_check_all_spartan_with_if = { CONDITION = tag }
nhs_check_all_spartan_with_if = {
	if = {
		limit = {
			exists = MS1
		}
		$CONDITION$ = MS1
	}
	else_if = {
		limit = {
			exists = MSN
		}
		$CONDITION$ = MSN
	}
}

# Check if CONDITION matches any Spartan nation, but check whichever exists first
# Takes both left and right side of the condition argument
# Use: nhs_check_all_spartan_with_if_complex = { CONDITION = tag }
nhs_check_all_spartan_with_if_complex = {
	if = {
		limit = {
			exists = MS1
		}
		$CONDITION$ = $ARGUMENT$
	}
	else_if = {
		limit = {
			exists = MSN
		}
		$CONDITION$ = $ARGUMENT$
	}
}

# Check if the culture is 'functionally Spartan'
# Use: nhs_culturally_spartan = yes
nhs_culturally_spartan = {
	OR = {
		culture_group = spartakian_group
		primary_culture = lakonian
	}
}


# -- Albanian --

# Check if the culture is 'functionally Albanian'
# Use: nhs_culturally_albanian = yes
nhs_culturally_albanian = {
	OR = {
		primary_culture = shqipproi
		primary_culture = shqiperi
		AND = {
			primary_culture = albanian
			capital_scope = {
				OR = {
					continent = north_america
					continent = south_america
				}
			}
		}
	}
}

# -- Exiles --

# Check if CONDITION matches any exiled nation
# Use: nhs_check_all_exiles = { CONDITION = tag }
nhs_check_all_exiles = {
	OR = {
		nhs_check_all_elysian_expanded = { CONDITION = $CONDITION$ }
		nhs_check_all_norse = { CONDITION = $CONDITION$ }
		nhs_check_all_spartan = { CONDITION = $CONDITION$ }
		# Include minor exiles
		$CONDITION$ = SHQ  # Shqiperi
	}
}

# Check if a province has a native culture
nhs_culturally_native = {
	custom_trigger_tooltip = {
		tooltip = nhs_culturally_native_tt
		OR = {
			native_culture = yes
			mesoamerican_native_culture = yes
			southamerican_native_culture = yes
		}
	}
}

# Check if a country has a native primary culture
nhs_culturally_native_primary = {
	custom_trigger_tooltip = {
		tooltip = nhs_culturally_native_tt
		OR = {
			native_culture_primary = yes
			mesoamerican_native_culture_primary = yes
			southamerican_native_culture_primary = yes
		}
	}
}

to_has_great_project_at_least_at_tier_1 = {
	custom_trigger_tooltip = {
		tooltip = to_has_$TYPE$_at_least_at_tier_1
		OR = {
			has_great_project = {
				type = $TYPE$
				tier = 1
			}
			has_great_project = {
				type = $TYPE$
				tier = 2
			}
			has_great_project = {
				type = $TYPE$
				tier = 3
			}
		}
	}
}

to_has_great_project_at_least_at_tier_2 = {
	custom_trigger_tooltip = {
		tooltip = to_has_$TYPE$_at_least_at_tier_2
		OR = {
			has_great_project = {
				type = $TYPE$
				tier = 2
			}
			has_great_project = {
				type = $TYPE$
				tier = 3
			}
		}
	}
}

to_has_canal_construction = {
	OR = {
		has_construction = kiel_canal
		has_construction = panama_canal
		has_construction = suez_canal
	}
}